<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.38">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Modern Investments: Theory, Data, and Practice - 4&nbsp; Risk and Return of Portfolios</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./fixed-income.html" rel="next">
<link href="./returns.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script type="application/json" class="js-hypothesis-config">
{
  "theme": "clean",
  "openSidebar": false
}
</script>
<script async="" src="https://hypothes.is/embed.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
        <script type="text/javascript">
        window.PlotlyConfig = {MathJaxConfig: 'local'};
        if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}
        if (typeof require !== 'undefined') {
        require.undef("plotly");
        requirejs.config({
            paths: {
                'plotly': ['https://cdn.plot.ly/plotly-2.14.0.min']
            }
        });
        require(['plotly'], function(Plotly) {
            window._Plotly = Plotly;
        });
        }
        </script>
        

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Risk and Return of Portfolios</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Modern Investments: Theory, Data, and Practice</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./miracle.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Miracle of Compound Interest</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./funds.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Asset Classes and Funds</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./returns.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Asset Returns</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./portfolios.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Risk and Return of Portfolios</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./fixed-income.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Fixed Income</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#portfolio-statistics" id="toc-portfolio-statistics" class="nav-link active" data-scroll-target="#portfolio-statistics"> <span class="header-section-number">4.1</span> Portfolio Statistics</a>
  <ul class="collapse">
  <li><a href="#expected-return" id="toc-expected-return" class="nav-link" data-scroll-target="#expected-return"> <span class="header-section-number">4.1.1</span> Expected Return</a></li>
  <li><a href="#variance-and-standard-deviation" id="toc-variance-and-standard-deviation" class="nav-link" data-scroll-target="#variance-and-standard-deviation"> <span class="header-section-number">4.1.2</span> Variance and Standard Deviation</a></li>
  <li><a href="#covariance-and-correlation" id="toc-covariance-and-correlation" class="nav-link" data-scroll-target="#covariance-and-correlation"> <span class="header-section-number">4.1.3</span> Covariance and Correlation</a></li>
  </ul></li>
  <li><a href="#preferences" id="toc-preferences" class="nav-link" data-scroll-target="#preferences"> <span class="header-section-number">4.2</span> Preferences</a></li>
  <li><a href="#allocating-capital-between-a-risky-asset-and-a-risk-free-asset" id="toc-allocating-capital-between-a-risky-asset-and-a-risk-free-asset" class="nav-link" data-scroll-target="#allocating-capital-between-a-risky-asset-and-a-risk-free-asset"> <span class="header-section-number">4.3</span> Allocating Capital Between a Risky Asset and a Risk-free Asset</a></li>
  <li><a href="#sec-two-risky" id="toc-sec-two-risky" class="nav-link" data-scroll-target="#sec-two-risky"> <span class="header-section-number">4.4</span> Diversification and Portfolios of Two Risky Assets</a></li>
  <li><a href="#sec-multiple-cals" id="toc-sec-multiple-cals" class="nav-link" data-scroll-target="#sec-multiple-cals"> <span class="header-section-number">4.5</span> Allocating Capital Between Two Risky Assets and a Risk-free Asset</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Risk and Return of Portfolios</span></h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<p>Porfolios are combinations of underlying assets. In this chapter, we will explore the risk and return of portfolios and how we can form optimal portfolios. Our discussion will focus on the expected return and standard deviation of portfolio.</p>
<section id="portfolio-statistics" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="portfolio-statistics"><span class="header-section-number">4.1</span> Portfolio Statistics</h2>
<section id="expected-return" class="level3" data-number="4.1.1">
<h3 data-number="4.1.1" class="anchored" data-anchor-id="expected-return"><span class="header-section-number">4.1.1</span> Expected Return</h3>
<p>The expected return of a portfolio is simply the weighted sum of the expected returns of each asset in the portfolio, where the weights are fraction of capital invested in each asset:</p>
<p><span id="eq-port-expret-N"><span class="math display">\[ E[r_p] = \sum_{i=1}^{N} w_i E[r_i]  \tag{4.1}\]</span></span> Unless otherwise stated, we will assume the portfolio is fully invested; that is, that <span class="math inline">\(\sum_i w_i = 1\)</span>. We will occasionally use the notation <span class="math inline">\(E(r_i)=\mu_i\)</span>.</p>
</section>
<section id="variance-and-standard-deviation" class="level3" data-number="4.1.2">
<h3 data-number="4.1.2" class="anchored" data-anchor-id="variance-and-standard-deviation"><span class="header-section-number">4.1.2</span> Variance and Standard Deviation</h3>
<p>To measure the variability of the portfolio return, we will alternatively work with the portfolio variance or the portfolio standard deviation. The portfolio variance of an <span class="math inline">\(N\)</span>-asset portfolio is: <span id="eq-port-var-N"><span class="math display">\[ \text{var}[r_p] = \sum_{i=1}^{N} \sum_{j=1}^{N} w_i w_j \text{cov}[r_i,r_j]\,, \tag{4.2}\]</span></span></p>
<p>where <span class="math inline">\(\text{cov}[r_i,r_j]\)</span> is the covariance between assets <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span>. Of course, the portfolio standard deviation is simply the square root of the portfolio variance. We will occasionally use the notation <span class="math inline">\(\sigma^2_p\)</span> to represent portfolio variance, <span class="math inline">\(\sigma_{i,j}\)</span> for the covariance between the returns of assets <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span>, and <span class="math inline">\(\sigma_p\)</span> for the standard deviation of portfolio <span class="math inline">\(p\)</span>’s return.</p>
Some insights into the portfolio variance can be obtained by considering each term in matrix view. The nine terms in the three asset case are:

<table border="1">
<!-- Row 1 -->
<tbody><tr>
<td style="text-align:center; background-color:gray">
<span class="math inline">\(w_1 w_1 \text{cov}[r_1,r_1]\)</span>
</td>
<td style="text-align:center">
<span class="math inline">\(w_1 w_2 \text{cov}[r_1,r_2]\)</span>
</td>
<td style="text-align:center">
<span class="math inline">\(w_1 w_3 \text{cov}[r_1,r_3]\)</span>
</td>
</tr>
<!-- Row 2 -->
<tr>
<td style="text-align:center">
<span class="math inline">\(w_2 w_1 \text{cov}[r_2,r_1]\)</span>
</td>
<td style="text-align:center; background-color:gray">
<span class="math inline">\(w_2 w_2 \text{cov}[r_2,r_2]\)</span>
</td>
<td style="text-align:center">
<span class="math inline">\(w_2 w_3 \text{cov}[r_2,r_3]\)</span>
</td>
</tr>
<!-- Row 3 -->
<tr>
<td style="text-align:center">
<span class="math inline">\(w_3 w_1 \text{cov}[r_3,r_1]\)</span>
</td>
<td style="text-align:center">
<span class="math inline">\(w_3 w_2 \text{cov}[r_3,r_2]\)</span>
</td>
<td style="text-align:center; background-color:gray">
<span class="math inline">\(w_3 w_3 \text{cov}[r_3,r_3]\)</span>
</td>
</tr>

</tbody></table>
The shaded cells along the diagonal contain covariances of an asset return with itself. These are variance terms, so the diagonal can be rewritten as:

<table border="1">
<!-- Row 1 -->
<tbody><tr>
<td style="text-align:center; background-color:gray">
<span class="math inline">\(w_1^2 \text{var}[r_1]\)</span>
</td>
<td style="text-align:center">
<span class="math inline">\(w_1 w_2 \text{cov}[r_1,r_2]\)</span>
</td>
<td style="text-align:center">
<span class="math inline">\(w_1 w_3 \text{cov}[r_1,r_3]\)</span>
</td>
</tr>
<!-- Row 2 -->
<tr>
<td style="text-align:center">
<span class="math inline">\(w_2 w_1 \text{cov}[r_2,r_1]\)</span>
</td>
<td style="text-align:center; background-color:gray">
<span class="math inline">\(w_2^2 \text{var}[r_2]\)</span>
</td>
<td style="text-align:center">
<span class="math inline">\(w_2 w_3 \text{cov}[r_2,r_3]\)</span>
</td>
</tr>
<!-- Row 3 -->
<tr>
<td style="text-align:center">
<span class="math inline">\(w_3 w_1 \text{cov}[r_3,r_1]\)</span>
</td>
<td style="text-align:center">
<span class="math inline">\(w_3 w_2 \text{cov}[r_3,r_2]\)</span>
</td>
<td style="text-align:center; background-color:gray">
<span class="math inline">\(w_3^2 \text{var}[r_3]\)</span>
</td>
</tr>

</tbody></table>
Further simplication is possible by looking at same-colored pairs of elements in the matrix below.<br>


<table border="1">
<!-- Row 1 -->
<tbody><tr>
<td style="text-align:center; background-color:gray">
<span class="math inline">\(w_1^2 \text{var}[r_1]\)</span>
</td>
<td style="text-align:center; background-color:lightblue">
<span class="math inline">\(w_1 w_2 \text{cov}[r_1,r_2]\)</span>
</td>
<td style="text-align:center; background-color:lightcoral">
<span class="math inline">\(w_1 w_3 \text{cov}[r_1,r_3]\)</span>
</td>
</tr>
<!-- Row 2 -->
<tr>
<td style="text-align:center; background-color:lightblue">
<span class="math inline">\(w_2 w_1 \text{cov}[r_2,r_1]\)</span>
</td>
<td style="text-align:center; background-color:gray">
<span class="math inline">\(w_2^2 \text{var}[r_2]\)</span>
</td>
<td style="text-align:center; background-color:#d9f2d9">
<span class="math inline">\(w_2 w_3 \text{cov}[r_2,r_3]\)</span>
</td>
</tr>
<!-- Row 3 -->
<tr>
<td style="text-align:center; background-color:lightcoral">
<span class="math inline">\(w_3 w_1 \text{cov}[r_3,r_1]\)</span>
</td>
<td style="text-align:center; background-color:#d9f2d9">
<span class="math inline">\(w_3 w_2 \text{cov}[r_3,r_2]\)</span>
</td>
<td style="text-align:center; background-color:gray">
<span class="math inline">\(w_3^2 \text{var}[r_3]\)</span>
</td>
</tr>

</tbody></table>
<p>The two terms in each pair have the same value because <span class="math inline">\(\text{cov}[r_i,r_j]=\text{cov}[r_j,r_i]\)</span>. Thus, the portfolio variance can be rewritten as:</p>
<p><span class="math display">\[ \text{var}[r_p] = \sum_{i=1}^{N} w_i^2 \text{var}[r_i]+ 2 \sum_{i=1}^{N} \sum_{j&gt;i} w_i w_j \text{cov}[r_i,r_j]\,.\]</span></p>
<section id="calculating-porfolio-variance" class="level4" data-number="4.1.2.1">
<h4 data-number="4.1.2.1" class="anchored" data-anchor-id="calculating-porfolio-variance"><span class="header-section-number">4.1.2.1</span> Calculating Porfolio Variance</h4>
<p>Calculating each term and adding them up can quickly become tedious. Given a covariance matrix <span class="math inline">\(V\)</span>: <span class="math display">\[\begin{equation*}
    V =
    \begin{bmatrix}
        \text{var}[r_1]     &amp; \text{cov}[r_1,r_2] &amp; \dots  &amp; \text{cov}[r_1,r_N] \\
        \text{cov}[r_2,r_1] &amp; \text{var}[r_2]     &amp; \dots  &amp; \text{cov}[r_2,r_N] \\
        \vdots              &amp; \vdots              &amp; \ddots &amp;  \vdots \\
        \text{cov}[r_N,r_1] &amp; \text{cov}[r_N,r_2] &amp; \dots  &amp; \text{var}[r_N] \\
    \end{bmatrix}
\end{equation*}\]</span> and a vector of weights</p>
<p><span class="math display">\[w'=[w_1\, w_2\,...\,w_N]\,,\]</span></p>
<p>we can calculate the portfolio variance as the matrix product</p>
<p><span class="math display">\[ \text{var}[r_p] = w'Vw \,.\]</span></p>
<p>In python, this can be accomplished using the w’ @ V @ w. In Excel, the command is =MMULT(TRANSPOSE(w),MMULT(V,w)).</p>
<p>Alternatively, we can use the bordered covariance method. ADD EXCEL SNIPPET HERE?</p>
</section>
</section>
<section id="covariance-and-correlation" class="level3" data-number="4.1.3">
<h3 data-number="4.1.3" class="anchored" data-anchor-id="covariance-and-correlation"><span class="header-section-number">4.1.3</span> Covariance and Correlation</h3>
<p>When measuring comovement across assets, we will use either the covariance, an absolute measure of comovement, or correlation, which is scaled by the product of each asset’s standard deviations:</p>
<p><span class="math display">\[ \text{corr}[r_i,r_j] = \rho_{ij} = \frac{\text{cov}[r_i,r_j]}{\text{sd}[r_i]\cdot\text{sd}[r_j]}\,.\]</span></p>
<p>Correlations range between -1 (perfectly negatively correlated) and 1 (perfectly correlated). Covariances, on the other hand, can take any values.</p>
</section>
</section>
<section id="preferences" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="preferences"><span class="header-section-number">4.2</span> Preferences</h2>
<p>In order to make statements about “optimal” portfolios, we need to describe the preferences of investors in some way. A standard way to do so is to use mean-variance utility. Simply put, we will assume that investors like higher expected returns and dislike portfolios with riskier returns. The amount of extra expected return needed for an investor to take on additional risk is governed by the investor’s risk aversion, which we will denote <span class="math inline">\(A\)</span>.</p>
<p>Mathematically, mean-variance utility for a given portfolio return <span class="math inline">\(r_p\)</span> is:</p>
<p><span class="math display">\[ U(r_p)=E[r_p] - 0.5\cdot A \cdot \text{var}[r_p]\,.\]</span></p>
<p>The utility of a risky investment is simply its expected return minus a penalty for variance. More risk averse investors have higher values for <span class="math inline">\(A\)</span>, meaning that they put greater penalties on variance. <a href="#fig-indifference0">Figure&nbsp;<span>4.1</span></a> shows indifference curves for three different levels of risk aversion, but the same level of utility. A higher expected return is required to reach the utility for a given level of risk when risk aversion is higher, and the extra expected return increases when risk increases.</p>
<div class="cell" data-execution_count="2">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> norm</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>raver1 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>raver2 <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>raver3 <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>u1 <span class="op">=</span> <span class="fl">0.10</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>u2 <span class="op">=</span> <span class="fl">0.10</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>u3 <span class="op">=</span> <span class="fl">0.10</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>string1<span class="op">=</span><span class="st">'Risk Aversion='</span><span class="op">+</span><span class="bu">str</span>(raver1)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>string2<span class="op">=</span><span class="st">'Risk Aversion='</span><span class="op">+</span><span class="bu">str</span>(raver2)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>string3<span class="op">=</span><span class="st">'Risk Aversion='</span><span class="op">+</span><span class="bu">str</span>(raver3)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate data</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>sd <span class="op">=</span> np.arange(<span class="dv">0</span>,<span class="fl">0.405</span>,<span class="fl">0.005</span>)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>U1 <span class="op">=</span> u1 <span class="op">+</span> <span class="fl">0.5</span><span class="op">*</span>raver1<span class="op">*</span> (sd<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>U2 <span class="op">=</span> u2 <span class="op">+</span> <span class="fl">0.5</span><span class="op">*</span>raver2<span class="op">*</span> (sd<span class="op">**</span><span class="dv">2</span>) </span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>U3 <span class="op">=</span> u3 <span class="op">+</span> <span class="fl">0.5</span><span class="op">*</span>raver3<span class="op">*</span> (sd<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(data<span class="op">=</span>{<span class="st">'Standard Deviation'</span>: sd, string1: U1, string2: U2,string3: U3})</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df<span class="op">*</span><span class="dv">100</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot data</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> px.line(df,x<span class="op">=</span><span class="st">'Standard Deviation'</span>, y<span class="op">=</span>[string1, string2, string3])</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>fig.update_layout(title<span class="op">=</span><span class="st">''</span>,</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>                   xaxis_title<span class="op">=</span><span class="st">'Standard Deviation'</span>,</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>                   yaxis_title<span class="op">=</span><span class="st">'Expected Return'</span>,</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>    legend_title_text<span class="op">=</span><span class="st">''</span>,)</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>fig.update_yaxes(tickformat<span class="op">=</span><span class="st">".0f"</span>, ticksuffix<span class="op">=</span><span class="st">"%"</span>)</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>fig.update_xaxes(tickformat<span class="op">=</span><span class="st">".0f"</span>, ticksuffix<span class="op">=</span><span class="st">"%"</span>)</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-indifference0" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">

<div>                            <div id="fe3c0a91-82d9-476c-9474-267df055100b" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("fe3c0a91-82d9-476c-9474-267df055100b")) {                    Plotly.newPlot(                        "fe3c0a91-82d9-476c-9474-267df055100b",                        [{"hovertemplate":"variable=Risk Aversion=2<br>Standard Deviation=%{x}<br>value=%{y}<extra></extra>","legendgroup":"Risk Aversion=2","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"Risk Aversion=2","orientation":"v","showlegend":true,"x":[0.0,0.5,1.0,1.5,2.0,2.5,3.0,3.5000000000000004,4.0,4.5,5.0,5.5,6.0,6.5,7.000000000000001,7.5,8.0,8.5,9.0,9.5,10.0,10.5,11.0,11.5,12.0,12.5,13.0,13.5,14.000000000000002,14.499999999999998,15.0,15.5,16.0,16.5,17.0,17.5,18.0,18.5,19.0,19.5,20.0,20.5,21.0,21.5,22.0,22.5,23.0,23.5,24.0,24.5,25.0,25.5,26.0,26.5,27.0,27.500000000000004,28.000000000000004,28.500000000000004,28.999999999999996,29.5,30.0,30.5,31.0,31.5,32.0,32.5,33.0,33.5,34.0,34.5,35.0,35.5,36.0,36.5,37.0,37.5,38.0,38.5,39.0,39.5,40.0],"xaxis":"x","y":[10.0,10.0025,10.010000000000002,10.0225,10.040000000000001,10.0625,10.09,10.1225,10.16,10.2025,10.25,10.3025,10.360000000000001,10.422500000000001,10.49,10.562500000000002,10.64,10.7225,10.81,10.902500000000002,11.000000000000002,11.1025,11.21,11.3225,11.44,11.5625,11.690000000000001,11.822500000000002,11.96,12.102500000000001,12.25,12.402500000000002,12.560000000000002,12.7225,12.89,13.062500000000002,13.240000000000002,13.422500000000001,13.61,13.8025,14.000000000000002,14.2025,14.41,14.622499999999999,14.84,15.0625,15.290000000000001,15.5225,15.760000000000002,16.0025,16.25,16.5025,16.76,17.0225,17.29,17.562500000000004,17.84,18.122500000000002,18.41,18.7025,19.0,19.302500000000002,19.61,19.922500000000003,20.240000000000002,20.5625,20.890000000000004,21.222500000000004,21.560000000000002,21.902500000000003,22.250000000000004,22.6025,22.96,23.322499999999998,23.69,24.0625,24.44,24.8225,25.21,25.602500000000006,26.0],"yaxis":"y","type":"scatter"},{"hovertemplate":"variable=Risk Aversion=5<br>Standard Deviation=%{x}<br>value=%{y}<extra></extra>","legendgroup":"Risk Aversion=5","line":{"color":"#EF553B","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"Risk Aversion=5","orientation":"v","showlegend":true,"x":[0.0,0.5,1.0,1.5,2.0,2.5,3.0,3.5000000000000004,4.0,4.5,5.0,5.5,6.0,6.5,7.000000000000001,7.5,8.0,8.5,9.0,9.5,10.0,10.5,11.0,11.5,12.0,12.5,13.0,13.5,14.000000000000002,14.499999999999998,15.0,15.5,16.0,16.5,17.0,17.5,18.0,18.5,19.0,19.5,20.0,20.5,21.0,21.5,22.0,22.5,23.0,23.5,24.0,24.5,25.0,25.5,26.0,26.5,27.0,27.500000000000004,28.000000000000004,28.500000000000004,28.999999999999996,29.5,30.0,30.5,31.0,31.5,32.0,32.5,33.0,33.5,34.0,34.5,35.0,35.5,36.0,36.5,37.0,37.5,38.0,38.5,39.0,39.5,40.0],"xaxis":"x","y":[10.0,10.00625,10.025,10.05625,10.100000000000001,10.15625,10.225000000000001,10.30625,10.4,10.50625,10.625000000000002,10.756250000000001,10.9,11.05625,11.225,11.406250000000002,11.600000000000001,11.806250000000002,12.025,12.25625,12.5,12.75625,13.025,13.30625,13.600000000000001,13.90625,14.225000000000001,14.55625,14.900000000000002,15.25625,15.625,16.00625,16.400000000000002,16.80625,17.225,17.65625,18.099999999999998,18.556250000000002,19.025,19.50625,20.0,20.506250000000005,21.025,21.55625,22.1,22.656250000000004,23.225,23.806250000000002,24.4,25.006249999999998,25.624999999999996,26.25625,26.900000000000002,27.556250000000006,28.225,28.90625,29.600000000000005,30.306250000000002,31.025000000000002,31.756249999999998,32.49999999999999,33.25625,34.025000000000006,34.806250000000006,35.6,36.40625000000001,37.22500000000001,38.056250000000006,38.9,39.75625,40.625000000000014,41.50625,42.39999999999999,43.30624999999999,44.225,45.15625,46.099999999999994,47.05625,48.025000000000006,49.00625000000001,50.000000000000014],"yaxis":"y","type":"scatter"},{"hovertemplate":"variable=Risk Aversion=10<br>Standard Deviation=%{x}<br>value=%{y}<extra></extra>","legendgroup":"Risk Aversion=10","line":{"color":"#00cc96","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"Risk Aversion=10","orientation":"v","showlegend":true,"x":[0.0,0.5,1.0,1.5,2.0,2.5,3.0,3.5000000000000004,4.0,4.5,5.0,5.5,6.0,6.5,7.000000000000001,7.5,8.0,8.5,9.0,9.5,10.0,10.5,11.0,11.5,12.0,12.5,13.0,13.5,14.000000000000002,14.499999999999998,15.0,15.5,16.0,16.5,17.0,17.5,18.0,18.5,19.0,19.5,20.0,20.5,21.0,21.5,22.0,22.5,23.0,23.5,24.0,24.5,25.0,25.5,26.0,26.5,27.0,27.500000000000004,28.000000000000004,28.500000000000004,28.999999999999996,29.5,30.0,30.5,31.0,31.5,32.0,32.5,33.0,33.5,34.0,34.5,35.0,35.5,36.0,36.5,37.0,37.5,38.0,38.5,39.0,39.5,40.0],"xaxis":"x","y":[10.0,10.012500000000001,10.05,10.1125,10.200000000000001,10.3125,10.450000000000001,10.6125,10.8,11.0125,11.25,11.512500000000001,11.8,12.1125,12.450000000000001,12.812499999999998,13.200000000000001,13.612499999999999,14.05,14.512500000000001,15.000000000000002,15.512500000000001,16.05,16.6125,17.2,17.8125,18.45,19.1125,19.8,20.5125,21.25,22.012500000000003,22.8,23.612500000000004,24.450000000000003,25.312500000000004,26.200000000000003,27.1125,28.049999999999997,29.012500000000003,30.000000000000004,31.012500000000003,32.05,33.1125,34.199999999999996,35.3125,36.45,37.612500000000004,38.800000000000004,40.012499999999996,41.25,42.512499999999996,43.800000000000004,45.1125,46.45,47.8125,49.20000000000001,50.612500000000004,52.05,53.512499999999996,54.99999999999999,56.512499999999996,58.050000000000004,59.612500000000004,61.199999999999996,62.81250000000001,64.45,66.11250000000001,67.80000000000001,69.51250000000002,71.25000000000001,73.0125,74.79999999999998,76.61249999999998,78.45,80.3125,82.19999999999999,84.1125,86.05000000000001,88.01250000000002,90.00000000000001],"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Standard Deviation"},"tickformat":".0f","ticksuffix":"%"},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Expected Return"},"tickformat":".0f","ticksuffix":"%"},"legend":{"title":{"text":""},"tracegroupgap":0},"margin":{"t":60},"title":{"text":""}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('fe3c0a91-82d9-476c-9474-267df055100b');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
<p></p><figcaption class="figure-caption">Figure 4.1: Indifference curves with different levels of risk aversion</figcaption><p></p>
</figure>
</div>
</div>
<p>Investors are indifferent between portfolios that generate the same utility. <a href="#fig-indifference1">Figure&nbsp;<span>4.2</span></a> shows three different levels of utility, holding risk aversion fixed. A utility of, for example, 10% means that the investor would be indifferent between the risky investment and a risk-free investment with a return of 10%. That is, any portfolio located on the green indifference curve in <a href="#fig-indifference1">Figure&nbsp;<span>4.2</span></a> provides the same level of utility to this investor. Higher utility is achieved with either a higher expected return or lower risk or both.</p>
<div class="cell" data-execution_count="3">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> norm</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># import plotly.io as pio</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co"># pio.renderers.default='notebook'</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>raver <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>u1 <span class="op">=</span> <span class="fl">0.05</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>u2 <span class="op">=</span> <span class="fl">0.075</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>u3 <span class="op">=</span> <span class="fl">0.10</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>string1<span class="op">=</span><span class="st">'Utility='</span><span class="op">+</span><span class="bu">str</span>(np.<span class="bu">round</span>(u1<span class="op">*</span><span class="dv">100</span>,<span class="dv">1</span>))<span class="op">+</span><span class="st">'%'</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>string2<span class="op">=</span><span class="st">'Utility='</span><span class="op">+</span><span class="bu">str</span>(np.<span class="bu">round</span>(u2<span class="op">*</span><span class="dv">100</span>,<span class="dv">1</span>))<span class="op">+</span><span class="st">'%'</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>string3<span class="op">=</span><span class="st">'Utility='</span><span class="op">+</span><span class="bu">str</span>(np.<span class="bu">round</span>(u3<span class="op">*</span><span class="dv">100</span>,<span class="dv">1</span>))<span class="op">+</span><span class="st">'%'</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate data</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>sd <span class="op">=</span> np.arange(<span class="dv">0</span>,<span class="fl">0.405</span>,<span class="fl">0.005</span>)</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>U1 <span class="op">=</span> u1 <span class="op">+</span> <span class="fl">0.5</span><span class="op">*</span>raver<span class="op">*</span> (sd<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>U2 <span class="op">=</span> u2 <span class="op">+</span> <span class="fl">0.5</span><span class="op">*</span>raver<span class="op">*</span> (sd<span class="op">**</span><span class="dv">2</span>) </span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>U3 <span class="op">=</span> u3 <span class="op">+</span> <span class="fl">0.5</span><span class="op">*</span>raver<span class="op">*</span> (sd<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(data<span class="op">=</span>{<span class="st">'Standard Deviation'</span>: sd, string1: U1, string2: U2,string3: U3})</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df<span class="op">*</span><span class="dv">100</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot data</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> px.line(df,x<span class="op">=</span><span class="st">'Standard Deviation'</span>, y<span class="op">=</span>[string1, string2, string3])</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>fig.update_layout(title<span class="op">=</span><span class="st">''</span>,</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>                   xaxis_title<span class="op">=</span><span class="st">'Standard Deviation'</span>,</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>                   yaxis_title<span class="op">=</span><span class="st">'Expected Return'</span>,</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>    legend_title_text<span class="op">=</span><span class="st">''</span>,)</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>fig.update_yaxes(tickformat<span class="op">=</span><span class="st">".0f"</span>, ticksuffix<span class="op">=</span><span class="st">"%"</span>)</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>fig.update_xaxes(tickformat<span class="op">=</span><span class="st">".0f"</span>, ticksuffix<span class="op">=</span><span class="st">"%"</span>)</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-indifference1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">

<div>                            <div id="fb0fac90-36d4-4624-8c1f-9143747c2a79" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("fb0fac90-36d4-4624-8c1f-9143747c2a79")) {                    Plotly.newPlot(                        "fb0fac90-36d4-4624-8c1f-9143747c2a79",                        [{"hovertemplate":"variable=Utility=5.0%<br>Standard Deviation=%{x}<br>value=%{y}<extra></extra>","legendgroup":"Utility=5.0%","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"Utility=5.0%","orientation":"v","showlegend":true,"x":[0.0,0.5,1.0,1.5,2.0,2.5,3.0,3.5000000000000004,4.0,4.5,5.0,5.5,6.0,6.5,7.000000000000001,7.5,8.0,8.5,9.0,9.5,10.0,10.5,11.0,11.5,12.0,12.5,13.0,13.5,14.000000000000002,14.499999999999998,15.0,15.5,16.0,16.5,17.0,17.5,18.0,18.5,19.0,19.5,20.0,20.5,21.0,21.5,22.0,22.5,23.0,23.5,24.0,24.5,25.0,25.5,26.0,26.5,27.0,27.500000000000004,28.000000000000004,28.500000000000004,28.999999999999996,29.5,30.0,30.5,31.0,31.5,32.0,32.5,33.0,33.5,34.0,34.5,35.0,35.5,36.0,36.5,37.0,37.5,38.0,38.5,39.0,39.5,40.0],"xaxis":"x","y":[5.0,5.0125,5.050000000000001,5.112500000000001,5.2,5.312500000000001,5.45,5.6125,5.800000000000001,6.0125,6.25,6.5125,6.800000000000001,7.112500000000001,7.450000000000001,7.8125,8.200000000000001,8.6125,9.049999999999999,9.5125,10.0,10.5125,11.05,11.6125,12.2,12.812499999999998,13.450000000000001,14.1125,14.800000000000002,15.512500000000001,16.249999999999996,17.012500000000003,17.8,18.612500000000004,19.45,20.312500000000007,21.199999999999996,22.1125,23.049999999999997,24.012500000000003,25.000000000000007,26.012500000000006,27.049999999999997,28.112499999999997,29.2,30.312500000000004,31.45,32.612500000000004,33.8,35.012499999999996,36.25,37.512499999999996,38.800000000000004,40.112500000000004,41.45,42.8125,44.2,45.612500000000004,47.05,48.512499999999996,49.99999999999999,51.5125,53.05000000000001,54.61250000000001,56.2,57.812500000000014,59.45000000000002,61.11250000000001,62.80000000000001,64.51250000000002,66.25000000000001,68.0125,69.8,71.61249999999998,73.45,75.3125,77.2,79.11250000000001,81.05000000000001,83.01250000000002,85.00000000000001],"yaxis":"y","type":"scatter"},{"hovertemplate":"variable=Utility=7.5%<br>Standard Deviation=%{x}<br>value=%{y}<extra></extra>","legendgroup":"Utility=7.5%","line":{"color":"#EF553B","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"Utility=7.5%","orientation":"v","showlegend":true,"x":[0.0,0.5,1.0,1.5,2.0,2.5,3.0,3.5000000000000004,4.0,4.5,5.0,5.5,6.0,6.5,7.000000000000001,7.5,8.0,8.5,9.0,9.5,10.0,10.5,11.0,11.5,12.0,12.5,13.0,13.5,14.000000000000002,14.499999999999998,15.0,15.5,16.0,16.5,17.0,17.5,18.0,18.5,19.0,19.5,20.0,20.5,21.0,21.5,22.0,22.5,23.0,23.5,24.0,24.5,25.0,25.5,26.0,26.5,27.0,27.500000000000004,28.000000000000004,28.500000000000004,28.999999999999996,29.5,30.0,30.5,31.0,31.5,32.0,32.5,33.0,33.5,34.0,34.5,35.0,35.5,36.0,36.5,37.0,37.5,38.0,38.5,39.0,39.5,40.0],"xaxis":"x","y":[7.5,7.512499999999999,7.55,7.6125,7.7,7.8125,7.95,8.1125,8.299999999999999,8.5125,8.75,9.0125,9.3,9.6125,9.950000000000001,10.3125,10.7,11.1125,11.549999999999999,12.0125,12.5,13.0125,13.55,14.1125,14.7,15.312500000000002,15.950000000000001,16.6125,17.3,18.0125,18.75,19.5125,20.3,21.1125,21.950000000000003,22.812500000000004,23.7,24.612499999999997,25.55,26.5125,27.500000000000004,28.512500000000003,29.549999999999997,30.612499999999997,31.7,32.81250000000001,33.95,35.112500000000004,36.3,37.512499999999996,38.75,40.0125,41.300000000000004,42.612500000000004,43.95,45.31250000000001,46.70000000000001,48.11250000000001,49.55,51.012499999999996,52.49999999999999,54.012499999999996,55.55,57.1125,58.699999999999996,60.3125,61.95,63.612500000000004,65.3,67.0125,68.75000000000001,70.5125,72.29999999999998,74.11249999999998,75.94999999999999,77.8125,79.69999999999999,81.6125,83.55,85.51250000000002,87.50000000000001],"yaxis":"y","type":"scatter"},{"hovertemplate":"variable=Utility=10.0%<br>Standard Deviation=%{x}<br>value=%{y}<extra></extra>","legendgroup":"Utility=10.0%","line":{"color":"#00cc96","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"Utility=10.0%","orientation":"v","showlegend":true,"x":[0.0,0.5,1.0,1.5,2.0,2.5,3.0,3.5000000000000004,4.0,4.5,5.0,5.5,6.0,6.5,7.000000000000001,7.5,8.0,8.5,9.0,9.5,10.0,10.5,11.0,11.5,12.0,12.5,13.0,13.5,14.000000000000002,14.499999999999998,15.0,15.5,16.0,16.5,17.0,17.5,18.0,18.5,19.0,19.5,20.0,20.5,21.0,21.5,22.0,22.5,23.0,23.5,24.0,24.5,25.0,25.5,26.0,26.5,27.0,27.500000000000004,28.000000000000004,28.500000000000004,28.999999999999996,29.5,30.0,30.5,31.0,31.5,32.0,32.5,33.0,33.5,34.0,34.5,35.0,35.5,36.0,36.5,37.0,37.5,38.0,38.5,39.0,39.5,40.0],"xaxis":"x","y":[10.0,10.012500000000001,10.05,10.1125,10.200000000000001,10.3125,10.450000000000001,10.6125,10.8,11.0125,11.25,11.512500000000001,11.8,12.1125,12.450000000000001,12.812499999999998,13.200000000000001,13.612499999999999,14.05,14.512500000000001,15.000000000000002,15.512500000000001,16.05,16.6125,17.2,17.8125,18.45,19.1125,19.8,20.5125,21.25,22.012500000000003,22.8,23.612500000000004,24.450000000000003,25.312500000000004,26.200000000000003,27.1125,28.049999999999997,29.012500000000003,30.000000000000004,31.012500000000003,32.05,33.1125,34.199999999999996,35.3125,36.45,37.612500000000004,38.800000000000004,40.012499999999996,41.25,42.512499999999996,43.800000000000004,45.1125,46.45,47.8125,49.20000000000001,50.612500000000004,52.05,53.512499999999996,54.99999999999999,56.512499999999996,58.050000000000004,59.612500000000004,61.199999999999996,62.81250000000001,64.45,66.11250000000001,67.80000000000001,69.51250000000002,71.25000000000001,73.0125,74.79999999999998,76.61249999999998,78.45,80.3125,82.19999999999999,84.1125,86.05000000000001,88.01250000000002,90.00000000000001],"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Standard Deviation"},"tickformat":".0f","ticksuffix":"%"},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Expected Return"},"tickformat":".0f","ticksuffix":"%"},"legend":{"title":{"text":""},"tracegroupgap":0},"margin":{"t":60},"title":{"text":""}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('fb0fac90-36d4-4624-8c1f-9143747c2a79');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
<p></p><figcaption class="figure-caption">Figure 4.2: Indifference curves with same level of risk aversion</figcaption><p></p>
</figure>
</div>
</div>
</section>
<section id="allocating-capital-between-a-risky-asset-and-a-risk-free-asset" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="allocating-capital-between-a-risky-asset-and-a-risk-free-asset"><span class="header-section-number">4.3</span> Allocating Capital Between a Risky Asset and a Risk-free Asset</h2>
<p>The decision to invest any money in a risky asset is perhaps the most fundamental decision an investor makes. We will assume the existence of a risk-free asset. In the real world, this would be an asset like a Treasury bill or a money-market mutual fund. To fix ideas, we will consider a broad stock market index fund as the risky asset.</p>
<p>How much capital should be invested in each of these two assets? For a given portfolio weight in the risky asset <span class="math inline">\(w_{\text{risky}}\)</span>, we first need to determine the portfolio’s expected return and standard deviation. Considering all possible risky portfolio weights traces out the set of possible investments, which is called the capital allocation line in expected return/standard deviation space. Finally, we choose the risky portfolio weight that maximizes the investor’s utility.</p>
<p>From the two-asset case of <a href="#eq-port-var-N">Equation&nbsp;<span>4.2</span></a>, we see that the variance of portfolio <span class="math inline">\(r_p\)</span> with non-negative <span class="math inline">\(w_{\text{risky}}\)</span> invested in the risky asset and <span class="math inline">\(1-w_{\text{risky}}\)</span> invested in the risk-free rate is:</p>
<p><span id="eq-test"><span class="math display">\[
\begin{align}
    \text{var}[r_p] =&amp; w_{\text{risky}}^2 \text{var}[r_{\text{risky}}]+ (1-w_{\text{risky}})^2 \text{var}[r_f]+ 2 w_{\text{risky}}(1-w_{\text{risky}}) \text{cov}[r_{\text{risky}},r_f] \\
                    =&amp; w_{\text{risky}}^2 \text{var}[r_{\text{risky}}]+ (1-w_{\text{risky}})^2 \cdot 0 + 2 w_{\text{risky}}(1-w_{\text{risky}}) \cdot 0 \\
                     =&amp;w_{\text{risky}}^2 \text{var}[r_{\text{risky}}]\,,
\end{align}
\tag{4.3}\]</span></span></p>
<p>where we have used the facts that the risk-free asset’s return is risk-free (<span class="math inline">\(\text{var}[r_f]=0\)</span>) and does not covary with the risky asset return. Thus, the portfolio’s standard deviation is:</p>
<p><span id="eq-sd-rf-risky"><span class="math display">\[ \text{sd}[r_p] = w_{\text{risky}}\cdot \text{sd}[r_{\text{risky}}]\,. \tag{4.4}\]</span></span></p>
<p>The expected return of the portfolio is: <span id="eq-expret-rf-risky"><span class="math display">\[ E[r_p] = w_{\text{risky}} E[r_{\text{risky}}]+ (1-w_{\text{risky}}) r_f \,. \tag{4.5}\]</span></span></p>
<p>Solving <a href="#eq-sd-rf-risky">Equation&nbsp;<span>4.4</span></a> for <span class="math inline">\(w_{\text{risky}}\)</span>, substituting into <a href="#eq-expret-rf-risky">Equation&nbsp;<span>4.5</span></a>, and rearranging yields the relationship between expected return and standard deviation along the capital allocation line:</p>
<p><span id="eq-cal"><span class="math display">\[ E[r_p] = r_f + \bigg[ \frac{E[r_{\text{risky}}]-r_f}{\text{sd}[r_{\text{risky}}] }\bigg] \cdot \text{sd}[r_p] \,. \tag{4.6}\]</span></span> The capital allocation line for a risky asset is a set of portfolios combining the risky asset with the risk-free asset. In expected return/volatility space, the <span class="math inline">\(y\)</span>-intercept is the risk-free rate of return and the slope of the line is the ratio of the expected excess return of the risky asset to its standard deviation. This ratio is called the Sharpe ratio, after William Sharpe. We discuss it in more detail below in <a href="#sec-multiple-cals"><span>Section&nbsp;4.5</span></a>.</p>
<p>When <span class="math inline">\(w_{\text{risky}}&gt;100\%\)</span>, the portfolio is borrowing at the risk-free rate (that is, issuing bonds at the same rate as, say, US Treasuries). This is probably not a reasonable assumption. For most investors, <span class="math inline">\(r^{\text{borrow}}&gt;r^{\text{saving}}\)</span>. In this case, the capital allocation line is kinked at the risky-asset: <span class="math display">\[\begin{equation}
\text{E}[r_p] = \begin{cases}
r_f^{\text{saving}} + \bigg[ \frac{E[r_{\text{risky}}]-r_f^{\text{saving}}}{\text{sd}[r_{\text{risky}}] }\bigg]\cdot \text{sd}[r_p] &amp; \text{if } \text{sd}[r_p] \le \text{sd}[r_{\text{risky}}] \\
  r_f^{\text{borrow}} + \bigg[ \frac{E[r_{\text{risky}}]-r_f^{\text{borrow}}}{\text{sd}[r_{\text{risky}}] }\bigg]\cdot \text{sd}[r_p] &amp; \text{if } \text{sd}[r_p] &gt; \text{sd}[r_{\text{risky}}] \\
\end{cases}
\end{equation}\]</span> <a href="#fig-cal">Figure&nbsp;<span>4.3</span></a> shows the set of possible portfolios along the capital allocation line.</p>
<div class="cell" data-execution_count="4">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.graph_objects <span class="im">as</span> go</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameter values (in percent)</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>mn <span class="op">=</span> <span class="dv">8</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>sd <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>extra <span class="op">=</span> <span class="dv">3</span>    <span class="co">#incremental borrowing rate</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> data(mn, sd, s, b):</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    grid <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">201</span>)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    mns <span class="op">=</span> [(s <span class="op">+</span> w <span class="op">*</span> (mn <span class="op">-</span> s) <span class="cf">if</span> w <span class="op">&lt;=</span> <span class="dv">1</span> <span class="cf">else</span> b <span class="op">+</span> w <span class="op">*</span> (mn <span class="op">-</span> b)) <span class="cf">for</span> w <span class="kw">in</span> grid]</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    sds <span class="op">=</span> [w <span class="op">*</span> sd <span class="cf">for</span> w <span class="kw">in</span> grid]</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> grid, mns, sds</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> figtbl(mn, sd, s, extra):</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    mn <span class="op">/=</span> <span class="dv">100</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    sd <span class="op">/=</span> <span class="dv">100</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    b <span class="op">=</span> s<span class="op">+</span>extra</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>    s <span class="op">/=</span> <span class="dv">100</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>    b <span class="op">/=</span> <span class="dv">100</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>    grid, mns, sds <span class="op">=</span> data(mn, sd, s, b)</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>    string <span class="op">=</span> <span class="st">"wealth in market = %</span><span class="sc">{text:.0f}</span><span class="st">%&lt;extra&gt;&lt;/extra&gt;"</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>    trace1 <span class="op">=</span> go.Scatter(</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span>sds, y<span class="op">=</span>mns, mode<span class="op">=</span><span class="st">"lines"</span>, text<span class="op">=</span><span class="dv">100</span> <span class="op">*</span> grid, hovertemplate<span class="op">=</span>string, name<span class="op">=</span><span class="st">'CAL'</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>    string <span class="op">=</span> <span class="st">"wealth in market = 100%&lt;extra&gt;&lt;/extra&gt;"</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>    trace2 <span class="op">=</span> go.Scatter(</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span>[sd], y<span class="op">=</span>[mn], mode<span class="op">=</span><span class="st">"markers"</span>, hovertemplate<span class="op">=</span>string, marker<span class="op">=</span><span class="bu">dict</span>(size<span class="op">=</span><span class="dv">15</span>), name<span class="op">=</span><span class="st">'Market'</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>    string <span class="op">=</span> <span class="st">"wealth in market = 0%&lt;extra&gt;&lt;/extra&gt;"</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>    trace3 <span class="op">=</span> go.Scatter(</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span>[<span class="dv">0</span>], y<span class="op">=</span>[s], mode<span class="op">=</span><span class="st">"markers"</span>, hovertemplate<span class="op">=</span>string, marker<span class="op">=</span><span class="bu">dict</span>(size<span class="op">=</span><span class="dv">15</span>), name<span class="op">=</span><span class="st">'Risk-free (Saving)'</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>    )  </span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>    string <span class="op">=</span> <span class="st">"Borrowing rate&lt;extra&gt;&lt;/extra&gt;"</span></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>    trace4 <span class="op">=</span> go.Scatter(</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span>[<span class="dv">0</span>], y<span class="op">=</span>[b], mode<span class="op">=</span><span class="st">"markers"</span>, hovertemplate<span class="op">=</span>string, marker<span class="op">=</span><span class="bu">dict</span>(size<span class="op">=</span><span class="dv">15</span>), name<span class="op">=</span><span class="st">'Risk-free (Borrowing)'</span></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>    )       </span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>    fig <span class="op">=</span> go.Figure()</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>    fig.add_trace(trace1)</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>    fig.add_trace(trace2)</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>    fig.add_trace(trace3)</span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>    fig.add_trace(trace4)</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>    fig.layout.xaxis[<span class="st">"title"</span>] <span class="op">=</span> <span class="st">"Standard Deviation"</span></span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>    fig.layout.yaxis[<span class="st">"title"</span>] <span class="op">=</span> <span class="st">"Expected Return"</span></span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>    fig.update_yaxes(tickformat<span class="op">=</span><span class="st">".0%"</span>)</span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>    fig.update_xaxes(tickformat<span class="op">=</span><span class="st">".0%"</span>)</span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>    fig.show()</span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>figtbl(mn, sd, s, extra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-cal" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">

<div>                            <div id="7cae2d45-1694-4653-9a67-5373ebc0f467" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("7cae2d45-1694-4653-9a67-5373ebc0f467")) {                    Plotly.newPlot(                        "7cae2d45-1694-4653-9a67-5373ebc0f467",                        [{"hovertemplate":"wealth in market = %{text:.0f}%<extra></extra>","mode":"lines","name":"CAL","text":[0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.000000000000001,8.0,9.0,10.0,11.0,12.0,13.0,14.000000000000002,15.0,16.0,17.0,18.0,19.0,20.0,21.0,22.0,23.0,24.0,25.0,26.0,27.0,28.000000000000004,28.999999999999996,30.0,31.0,32.0,33.0,34.0,35.0,36.0,37.0,38.0,39.0,40.0,41.0,42.0,43.0,44.0,45.0,46.0,47.0,48.0,49.0,50.0,51.0,52.0,53.0,54.0,55.00000000000001,56.00000000000001,57.00000000000001,57.99999999999999,59.0,60.0,61.0,62.0,63.0,64.0,65.0,66.0,67.0,68.0,69.0,70.0,71.0,72.0,73.0,74.0,75.0,76.0,77.0,78.0,79.0,80.0,81.0,82.0,83.0,84.0,85.0,86.0,87.0,88.0,89.0,90.0,91.0,92.0,93.0,94.0,95.0,96.0,97.0,98.0,99.0,100.0,101.0,102.0,103.0,104.0,105.0,106.0,107.0,108.0,109.00000000000001,110.00000000000001,111.00000000000001,112.00000000000001,113.00000000000001,114.00000000000001,115.00000000000001,115.99999999999999,117.0,118.0,119.0,120.0,121.0,122.0,123.0,124.0,125.0,126.0,127.0,128.0,129.0,130.0,131.0,132.0,133.0,134.0,135.0,136.0,137.0,138.0,139.0,140.0,141.0,142.0,143.0,144.0,145.0,146.0,147.0,148.0,149.0,150.0,151.0,152.0,153.0,154.0,155.0,156.0,157.0,158.0,159.0,160.0,161.0,162.0,163.0,164.0,165.0,166.0,167.0,168.0,169.0,170.0,171.0,172.0,173.0,174.0,175.0,176.0,177.0,178.0,179.0,180.0,181.0,182.0,183.0,184.0,185.0,186.0,187.0,188.0,189.0,190.0,191.0,192.0,193.0,194.0,195.0,196.0,197.0,198.0,199.0,200.0],"x":[0.0,0.002,0.004,0.006,0.008,0.010000000000000002,0.012,0.014000000000000002,0.016,0.018,0.020000000000000004,0.022000000000000002,0.024,0.026000000000000002,0.028000000000000004,0.03,0.032,0.034,0.036,0.038000000000000006,0.04000000000000001,0.042,0.044000000000000004,0.046000000000000006,0.048,0.05,0.052000000000000005,0.054000000000000006,0.05600000000000001,0.057999999999999996,0.06,0.062,0.064,0.066,0.068,0.07,0.072,0.074,0.07600000000000001,0.07800000000000001,0.08000000000000002,0.08200000000000002,0.084,0.08600000000000001,0.08800000000000001,0.09000000000000001,0.09200000000000001,0.09400000000000001,0.096,0.098,0.1,0.10200000000000001,0.10400000000000001,0.10600000000000001,0.10800000000000001,0.11000000000000001,0.11200000000000002,0.11400000000000002,0.11599999999999999,0.118,0.12,0.122,0.124,0.126,0.128,0.13,0.132,0.134,0.136,0.138,0.14,0.142,0.144,0.146,0.148,0.15000000000000002,0.15200000000000002,0.15400000000000003,0.15600000000000003,0.15800000000000003,0.16000000000000003,0.16200000000000003,0.16400000000000003,0.16600000000000004,0.168,0.17,0.17200000000000001,0.17400000000000002,0.17600000000000002,0.17800000000000002,0.18000000000000002,0.18200000000000002,0.18400000000000002,0.18600000000000003,0.18800000000000003,0.19000000000000003,0.192,0.194,0.196,0.198,0.2,0.202,0.20400000000000001,0.20600000000000002,0.20800000000000002,0.21000000000000002,0.21200000000000002,0.21400000000000002,0.21600000000000003,0.21800000000000003,0.22000000000000003,0.22200000000000003,0.22400000000000003,0.22600000000000003,0.22800000000000004,0.23000000000000004,0.23199999999999998,0.23399999999999999,0.236,0.238,0.24,0.242,0.244,0.246,0.248,0.25,0.252,0.254,0.256,0.258,0.26,0.262,0.264,0.266,0.268,0.27,0.272,0.274,0.276,0.278,0.28,0.282,0.284,0.286,0.288,0.29,0.292,0.294,0.296,0.298,0.30000000000000004,0.30200000000000005,0.30400000000000005,0.30600000000000005,0.30800000000000005,0.31000000000000005,0.31200000000000006,0.31400000000000006,0.31600000000000006,0.31800000000000006,0.32000000000000006,0.32200000000000006,0.32400000000000007,0.32600000000000007,0.32800000000000007,0.33000000000000007,0.3320000000000001,0.334,0.336,0.338,0.34,0.342,0.34400000000000003,0.34600000000000003,0.34800000000000003,0.35000000000000003,0.35200000000000004,0.35400000000000004,0.35600000000000004,0.35800000000000004,0.36000000000000004,0.36200000000000004,0.36400000000000005,0.36600000000000005,0.36800000000000005,0.37000000000000005,0.37200000000000005,0.37400000000000005,0.37600000000000006,0.37800000000000006,0.38000000000000006,0.38200000000000006,0.384,0.386,0.388,0.39,0.392,0.394,0.396,0.398,0.4],"y":[0.02,0.0206,0.0212,0.0218,0.0224,0.023,0.0236,0.0242,0.0248,0.0254,0.026000000000000002,0.0266,0.027200000000000002,0.0278,0.0284,0.028999999999999998,0.0296,0.0302,0.0308,0.0314,0.032,0.0326,0.0332,0.0338,0.0344,0.035,0.0356,0.036199999999999996,0.0368,0.0374,0.038,0.038599999999999995,0.0392,0.0398,0.040400000000000005,0.041,0.0416,0.0422,0.042800000000000005,0.0434,0.044,0.0446,0.0452,0.0458,0.0464,0.047,0.0476,0.0482,0.048799999999999996,0.0494,0.05,0.0506,0.051199999999999996,0.0518,0.0524,0.053000000000000005,0.05360000000000001,0.0542,0.0548,0.05539999999999999,0.055999999999999994,0.0566,0.0572,0.057800000000000004,0.058399999999999994,0.059,0.0596,0.060200000000000004,0.06080000000000001,0.061399999999999996,0.062,0.0626,0.06319999999999999,0.0638,0.0644,0.065,0.0656,0.0662,0.0668,0.0674,0.068,0.06860000000000001,0.0692,0.0698,0.07039999999999999,0.071,0.0716,0.0722,0.0728,0.07339999999999999,0.074,0.0746,0.0752,0.0758,0.0764,0.077,0.0776,0.07819999999999999,0.0788,0.0794,0.08,0.08030000000000001,0.0806,0.0809,0.0812,0.0815,0.08180000000000001,0.0821,0.0824,0.0827,0.083,0.08330000000000001,0.08360000000000001,0.0839,0.0842,0.0845,0.0848,0.08510000000000001,0.0854,0.0857,0.086,0.0863,0.08660000000000001,0.0869,0.0872,0.0875,0.0878,0.08810000000000001,0.0884,0.0887,0.089,0.0893,0.08960000000000001,0.08990000000000001,0.0902,0.0905,0.0908,0.09110000000000001,0.09140000000000001,0.0917,0.092,0.0923,0.0926,0.0929,0.0932,0.0935,0.0938,0.0941,0.0944,0.0947,0.095,0.0953,0.0956,0.0959,0.09620000000000001,0.0965,0.0968,0.0971,0.0974,0.09770000000000001,0.098,0.0983,0.09860000000000001,0.0989,0.09920000000000001,0.0995,0.0998,0.1001,0.10039999999999999,0.1007,0.101,0.1013,0.1016,0.10189999999999999,0.1022,0.10250000000000001,0.1028,0.1031,0.10339999999999999,0.1037,0.10400000000000001,0.1043,0.1046,0.1049,0.1052,0.10550000000000001,0.1058,0.1061,0.1064,0.1067,0.10700000000000001,0.1073,0.1076,0.1079,0.10819999999999999,0.1085,0.10880000000000001,0.1091,0.1094,0.10969999999999999,0.11],"type":"scatter"},{"hovertemplate":"wealth in market = 100%<extra></extra>","marker":{"size":15},"mode":"markers","name":"Market","x":[0.2],"y":[0.08],"type":"scatter"},{"hovertemplate":"wealth in market = 0%<extra></extra>","marker":{"size":15},"mode":"markers","name":"Risk-free (Saving)","x":[0],"y":[0.02],"type":"scatter"},{"hovertemplate":"Borrowing rate<extra></extra>","marker":{"size":15},"mode":"markers","name":"Risk-free (Borrowing)","x":[0],"y":[0.05],"type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"title":{"text":"Standard Deviation"},"tickformat":".0%"},"yaxis":{"title":{"text":"Expected Return"},"tickformat":".0%"}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('7cae2d45-1694-4653-9a67-5373ebc0f467');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
<p></p><figcaption class="figure-caption">Figure 4.3: Capital Allocation Line</figcaption><p></p>
</figure>
</div>
</div>
<p>The choice of where to locate along the CAL is the choice of how much to invest in a risky portfolio <span class="math inline">\(w_{\text{risky}}\)</span>. A mean-variance investor chooses <span class="math inline">\(w_{\text{risky}}\)</span> to solve: <span id="eq-cal-optimization"><span class="math display">\[ \underset{w_{\text{risky}}}\max E[r_p] - 0.5\cdot A \cdot \text{var}[r_p]\,.  \tag{4.7}\]</span></span></p>
<p>Plugging in the expected return (<a href="#eq-expret-rf-risky">Equation&nbsp;<span>4.5</span></a>) and standard deviation ( <a href="#eq-sd-rf-risky">Equation&nbsp;<span>4.4</span></a>) into <a href="#eq-cal-optimization">Equation&nbsp;<span>4.7</span></a> and considering the first-order condition with respect to <span class="math inline">\(w_{\text{risky}}\)</span> provides the optimal weight to invest in the risky asset: <!-- $$ w^*_{\text{risky}} = \frac{E[r_{\text{risky}}-r_f]}{A \cdot \text{var}_{\text{risky}}}\,.$$ {#eq-cal-opt-wgt} --> <!-- ```{tex} --> <span class="math display">\[\begin{equation}
w^*_{\text{risky}} = \begin{cases}
    \frac{E[r_{\text{risky}}-r_f^{\text{saving}}]}{A \cdot \text{var}_{\text{risky}}} &amp; \text{if } A &gt; \frac{E[r_{\text{risky}}-r_f^{\text{saving}}]}{\text{var}_{\text{risky}}} \\
    100\% &amp; \text{if } \frac{E[r_{\text{risky}}-r_f^{\text{borrow}}]}{ \text{var}_{\text{risky}}} \le A \le \frac{E[r_{\text{risky}}-r_f^{\text{saving}}]}{\text{var}_{\text{risky}}} \\
    \frac{E[r_{\text{risky}}-r_f^{\text{borrow}}]}{A \cdot \text{var}_{\text{risky}}} &amp; \text{if } A &lt; \frac{E[r_{\text{risky}}-r_f^{\text{borrow}}]}{ \text{var}_{\text{risky}}} \,. \\
\end{cases}
\end{equation}\]</span> <!-- ``` --></p>
<p>Thus, an investor’s location on the CAL depends on risk aversion. Investors with different risk aversion will choose different combinations of the risky asset and the risk-free asset. This is demonstrated in <a href="#fig-cal-preferences">Figure&nbsp;<span>4.4</span></a>.</p>
<div class="cell" data-execution_count="5">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.graph_objects <span class="im">as</span> go</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameter values (in percent)</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>mn <span class="op">=</span> <span class="dv">8</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>sd <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>extra <span class="op">=</span> <span class="dv">3</span>    <span class="co">#incremental borrowing rate</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>raver1 <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>raver2 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> cal(mn, sd, s, b):</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    grid <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">201</span>)</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    mns <span class="op">=</span> [(s <span class="op">+</span> w <span class="op">*</span> (mn <span class="op">-</span> s) <span class="cf">if</span> w <span class="op">&lt;=</span> <span class="dv">1</span> <span class="cf">else</span> b <span class="op">+</span> w <span class="op">*</span> (mn <span class="op">-</span> b)) <span class="cf">for</span> w <span class="kw">in</span> grid]</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>    sds <span class="op">=</span> [w <span class="op">*</span> sd <span class="cf">for</span> w <span class="kw">in</span> grid]</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> grid, mns, sds</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> opt_utility(mn, sd, s, b, A):</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># return/sd inputs must be in decimal</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>    wgt <span class="op">=</span> (mn <span class="op">-</span> s) <span class="op">/</span> (A <span class="op">*</span> (sd<span class="op">**</span><span class="dv">2</span>))</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>    expret<span class="op">=</span> wgt<span class="op">*</span>mn <span class="op">+</span> (<span class="dv">1</span><span class="op">-</span>wgt)<span class="op">*</span>s</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>    sdret <span class="op">=</span> wgt<span class="op">*</span>sd </span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> wgt <span class="op">&gt;</span> <span class="dv">1</span>:</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>        wgt <span class="op">=</span> (mn <span class="op">-</span> b) <span class="op">/</span> (A <span class="op">*</span> (sd<span class="op">**</span><span class="dv">2</span>))</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>        wgt <span class="op">=</span> <span class="bu">max</span>(wgt,<span class="dv">1</span>)</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>        expret<span class="op">=</span> wgt<span class="op">*</span>mn <span class="op">+</span> (<span class="dv">1</span><span class="op">-</span>wgt)<span class="op">*</span>b </span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>        sdret <span class="op">=</span> wgt<span class="op">*</span>sd   </span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>    u <span class="op">=</span> expret <span class="op">-</span> <span class="fl">0.5</span><span class="op">*</span>A<span class="op">*</span>sdret<span class="op">**</span><span class="dv">2</span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> u, wgt</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> figtbl(mn, sd, s, extra, raver1, raver2):</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>    mn <span class="op">/=</span> <span class="dv">100</span></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>    sd <span class="op">/=</span> <span class="dv">100</span></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>    b <span class="op">=</span> s<span class="op">+</span>extra</span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>    s <span class="op">/=</span> <span class="dv">100</span></span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>    b <span class="op">/=</span> <span class="dv">100</span></span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>    <span class="co"># CAL Plot Info</span></span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>    grid, mns, sds <span class="op">=</span> cal(mn, sd, s, b)</span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>    string <span class="op">=</span> <span class="st">"wealth in market = %</span><span class="sc">{text:.0f}</span><span class="st">%&lt;extra&gt;&lt;/extra&gt;"</span></span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>    trace1 <span class="op">=</span> go.Scatter(</span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span>sds, y<span class="op">=</span>mns, mode<span class="op">=</span><span class="st">"lines"</span>, text<span class="op">=</span><span class="dv">100</span> <span class="op">*</span> grid, hovertemplate<span class="op">=</span>string, name<span class="op">=</span><span class="st">'CAL'</span></span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>    string <span class="op">=</span> <span class="st">"wealth in market = 100%&lt;extra&gt;&lt;/extra&gt;"</span></span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>    trace2 <span class="op">=</span> go.Scatter(</span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span>[sd], y<span class="op">=</span>[mn], mode<span class="op">=</span><span class="st">"markers"</span>, hovertemplate<span class="op">=</span>string, marker<span class="op">=</span><span class="bu">dict</span>(size<span class="op">=</span><span class="dv">15</span>), name<span class="op">=</span><span class="st">'Market'</span></span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a>    string <span class="op">=</span> <span class="st">"wealth in market = 0%&lt;extra&gt;&lt;/extra&gt;"</span></span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a>    trace3 <span class="op">=</span> go.Scatter(</span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span>[<span class="dv">0</span>], y<span class="op">=</span>[s], mode<span class="op">=</span><span class="st">"markers"</span>, hovertemplate<span class="op">=</span>string, marker<span class="op">=</span><span class="bu">dict</span>(size<span class="op">=</span><span class="dv">15</span>), name<span class="op">=</span><span class="st">'Risk-free (Saving)'</span></span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a>    )  </span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a>    string <span class="op">=</span> <span class="st">"Borrowing rate&lt;extra&gt;&lt;/extra&gt;"</span></span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>    trace4 <span class="op">=</span> go.Scatter(</span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span>[<span class="dv">0</span>], y<span class="op">=</span>[b], mode<span class="op">=</span><span class="st">"markers"</span>, hovertemplate<span class="op">=</span>string, marker<span class="op">=</span><span class="bu">dict</span>(size<span class="op">=</span><span class="dv">15</span>), name<span class="op">=</span><span class="st">'Risk-free (Borrowing)'</span></span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a>    )       </span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Utility plot info</span></span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a>    u1, wgt1 <span class="op">=</span> opt_utility(mn,sd,s,b, raver1)</span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a>    u2, wgt2 <span class="op">=</span> opt_utility(mn,sd,s,b, raver2)</span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a>    string1<span class="op">=</span><span class="st">'Risk Aversion='</span><span class="op">+</span><span class="bu">str</span>(raver1)</span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true" tabindex="-1"></a>    string2<span class="op">=</span><span class="st">'Risk Aversion='</span><span class="op">+</span><span class="bu">str</span>(raver2)</span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true" tabindex="-1"></a>    eret1 <span class="op">=</span> [u1 <span class="op">+</span> <span class="fl">0.5</span><span class="op">*</span>raver1<span class="op">*</span> (sd<span class="op">**</span><span class="dv">2</span>) <span class="cf">for</span> sd <span class="kw">in</span> sds]</span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true" tabindex="-1"></a>    eret2 <span class="op">=</span> [u2 <span class="op">+</span> <span class="fl">0.5</span><span class="op">*</span>raver2<span class="op">*</span> (sd<span class="op">**</span><span class="dv">2</span>) <span class="cf">for</span> sd <span class="kw">in</span> sds] </span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true" tabindex="-1"></a>    <span class="co"># df = pd.DataFrame(data={'Standard Deviation': sds, string1: U1, string2: U2})</span></span>
<span id="cb4-66"><a href="#cb4-66" aria-hidden="true" tabindex="-1"></a>    string <span class="op">=</span> <span class="st">"indifference curve for &lt;br&gt;utility obtained from &lt;br&gt;optimal wealth in market = "</span><span class="op">+</span><span class="bu">str</span>(np.<span class="bu">round</span>(<span class="dv">100</span><span class="op">*</span>wgt1,<span class="dv">0</span>))<span class="op">+</span><span class="st">"%&lt;extra&gt;&lt;/extra&gt;"</span></span>
<span id="cb4-67"><a href="#cb4-67" aria-hidden="true" tabindex="-1"></a>    trace5 <span class="op">=</span> go.Scatter(</span>
<span id="cb4-68"><a href="#cb4-68" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span>sds, y<span class="op">=</span>eret1, mode<span class="op">=</span><span class="st">"lines"</span>, hovertemplate<span class="op">=</span>string, name<span class="op">=</span>string1</span>
<span id="cb4-69"><a href="#cb4-69" aria-hidden="true" tabindex="-1"></a>    )  </span>
<span id="cb4-70"><a href="#cb4-70" aria-hidden="true" tabindex="-1"></a>    string <span class="op">=</span> <span class="st">"indifference curve for &lt;br&gt;utility obtained from &lt;br&gt;optimal wealth in market = "</span><span class="op">+</span><span class="bu">str</span>(np.<span class="bu">round</span>(<span class="dv">100</span><span class="op">*</span>wgt2,<span class="dv">0</span>))<span class="op">+</span><span class="st">"%&lt;extra&gt;&lt;/extra&gt;"</span></span>
<span id="cb4-71"><a href="#cb4-71" aria-hidden="true" tabindex="-1"></a>    trace6 <span class="op">=</span> go.Scatter(</span>
<span id="cb4-72"><a href="#cb4-72" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span>sds, y<span class="op">=</span>eret2, mode<span class="op">=</span><span class="st">"lines"</span>, hovertemplate<span class="op">=</span>string, name<span class="op">=</span>string2</span>
<span id="cb4-73"><a href="#cb4-73" aria-hidden="true" tabindex="-1"></a>    )  </span>
<span id="cb4-74"><a href="#cb4-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-75"><a href="#cb4-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-76"><a href="#cb4-76" aria-hidden="true" tabindex="-1"></a>    fig <span class="op">=</span> go.Figure()</span>
<span id="cb4-77"><a href="#cb4-77" aria-hidden="true" tabindex="-1"></a>    fig.add_trace(trace1)</span>
<span id="cb4-78"><a href="#cb4-78" aria-hidden="true" tabindex="-1"></a>    fig.add_trace(trace2)</span>
<span id="cb4-79"><a href="#cb4-79" aria-hidden="true" tabindex="-1"></a>    fig.add_trace(trace3)</span>
<span id="cb4-80"><a href="#cb4-80" aria-hidden="true" tabindex="-1"></a>    fig.add_trace(trace4)</span>
<span id="cb4-81"><a href="#cb4-81" aria-hidden="true" tabindex="-1"></a>    fig.add_trace(trace5)</span>
<span id="cb4-82"><a href="#cb4-82" aria-hidden="true" tabindex="-1"></a>    fig.add_trace(trace6)</span>
<span id="cb4-83"><a href="#cb4-83" aria-hidden="true" tabindex="-1"></a>    fig.layout.xaxis[<span class="st">"title"</span>] <span class="op">=</span> <span class="st">"Standard Deviation"</span></span>
<span id="cb4-84"><a href="#cb4-84" aria-hidden="true" tabindex="-1"></a>    fig.layout.yaxis[<span class="st">"title"</span>] <span class="op">=</span> <span class="st">"Expected Return"</span>    </span>
<span id="cb4-85"><a href="#cb4-85" aria-hidden="true" tabindex="-1"></a>    fig.update_yaxes(tickformat<span class="op">=</span><span class="st">".0%"</span>)</span>
<span id="cb4-86"><a href="#cb4-86" aria-hidden="true" tabindex="-1"></a>    fig.update_xaxes(tickformat<span class="op">=</span><span class="st">".0%"</span>)</span>
<span id="cb4-87"><a href="#cb4-87" aria-hidden="true" tabindex="-1"></a>    fig.show()</span>
<span id="cb4-88"><a href="#cb4-88" aria-hidden="true" tabindex="-1"></a>figtbl(mn, sd, s, extra, raver1, raver2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-cal-preferences" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">

<div>                            <div id="271feb4c-ce18-4eae-bb4e-c954635358de" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("271feb4c-ce18-4eae-bb4e-c954635358de")) {                    Plotly.newPlot(                        "271feb4c-ce18-4eae-bb4e-c954635358de",                        [{"hovertemplate":"wealth in market = %{text:.0f}%<extra></extra>","mode":"lines","name":"CAL","text":[0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.000000000000001,8.0,9.0,10.0,11.0,12.0,13.0,14.000000000000002,15.0,16.0,17.0,18.0,19.0,20.0,21.0,22.0,23.0,24.0,25.0,26.0,27.0,28.000000000000004,28.999999999999996,30.0,31.0,32.0,33.0,34.0,35.0,36.0,37.0,38.0,39.0,40.0,41.0,42.0,43.0,44.0,45.0,46.0,47.0,48.0,49.0,50.0,51.0,52.0,53.0,54.0,55.00000000000001,56.00000000000001,57.00000000000001,57.99999999999999,59.0,60.0,61.0,62.0,63.0,64.0,65.0,66.0,67.0,68.0,69.0,70.0,71.0,72.0,73.0,74.0,75.0,76.0,77.0,78.0,79.0,80.0,81.0,82.0,83.0,84.0,85.0,86.0,87.0,88.0,89.0,90.0,91.0,92.0,93.0,94.0,95.0,96.0,97.0,98.0,99.0,100.0,101.0,102.0,103.0,104.0,105.0,106.0,107.0,108.0,109.00000000000001,110.00000000000001,111.00000000000001,112.00000000000001,113.00000000000001,114.00000000000001,115.00000000000001,115.99999999999999,117.0,118.0,119.0,120.0,121.0,122.0,123.0,124.0,125.0,126.0,127.0,128.0,129.0,130.0,131.0,132.0,133.0,134.0,135.0,136.0,137.0,138.0,139.0,140.0,141.0,142.0,143.0,144.0,145.0,146.0,147.0,148.0,149.0,150.0,151.0,152.0,153.0,154.0,155.0,156.0,157.0,158.0,159.0,160.0,161.0,162.0,163.0,164.0,165.0,166.0,167.0,168.0,169.0,170.0,171.0,172.0,173.0,174.0,175.0,176.0,177.0,178.0,179.0,180.0,181.0,182.0,183.0,184.0,185.0,186.0,187.0,188.0,189.0,190.0,191.0,192.0,193.0,194.0,195.0,196.0,197.0,198.0,199.0,200.0],"x":[0.0,0.002,0.004,0.006,0.008,0.010000000000000002,0.012,0.014000000000000002,0.016,0.018,0.020000000000000004,0.022000000000000002,0.024,0.026000000000000002,0.028000000000000004,0.03,0.032,0.034,0.036,0.038000000000000006,0.04000000000000001,0.042,0.044000000000000004,0.046000000000000006,0.048,0.05,0.052000000000000005,0.054000000000000006,0.05600000000000001,0.057999999999999996,0.06,0.062,0.064,0.066,0.068,0.07,0.072,0.074,0.07600000000000001,0.07800000000000001,0.08000000000000002,0.08200000000000002,0.084,0.08600000000000001,0.08800000000000001,0.09000000000000001,0.09200000000000001,0.09400000000000001,0.096,0.098,0.1,0.10200000000000001,0.10400000000000001,0.10600000000000001,0.10800000000000001,0.11000000000000001,0.11200000000000002,0.11400000000000002,0.11599999999999999,0.118,0.12,0.122,0.124,0.126,0.128,0.13,0.132,0.134,0.136,0.138,0.14,0.142,0.144,0.146,0.148,0.15000000000000002,0.15200000000000002,0.15400000000000003,0.15600000000000003,0.15800000000000003,0.16000000000000003,0.16200000000000003,0.16400000000000003,0.16600000000000004,0.168,0.17,0.17200000000000001,0.17400000000000002,0.17600000000000002,0.17800000000000002,0.18000000000000002,0.18200000000000002,0.18400000000000002,0.18600000000000003,0.18800000000000003,0.19000000000000003,0.192,0.194,0.196,0.198,0.2,0.202,0.20400000000000001,0.20600000000000002,0.20800000000000002,0.21000000000000002,0.21200000000000002,0.21400000000000002,0.21600000000000003,0.21800000000000003,0.22000000000000003,0.22200000000000003,0.22400000000000003,0.22600000000000003,0.22800000000000004,0.23000000000000004,0.23199999999999998,0.23399999999999999,0.236,0.238,0.24,0.242,0.244,0.246,0.248,0.25,0.252,0.254,0.256,0.258,0.26,0.262,0.264,0.266,0.268,0.27,0.272,0.274,0.276,0.278,0.28,0.282,0.284,0.286,0.288,0.29,0.292,0.294,0.296,0.298,0.30000000000000004,0.30200000000000005,0.30400000000000005,0.30600000000000005,0.30800000000000005,0.31000000000000005,0.31200000000000006,0.31400000000000006,0.31600000000000006,0.31800000000000006,0.32000000000000006,0.32200000000000006,0.32400000000000007,0.32600000000000007,0.32800000000000007,0.33000000000000007,0.3320000000000001,0.334,0.336,0.338,0.34,0.342,0.34400000000000003,0.34600000000000003,0.34800000000000003,0.35000000000000003,0.35200000000000004,0.35400000000000004,0.35600000000000004,0.35800000000000004,0.36000000000000004,0.36200000000000004,0.36400000000000005,0.36600000000000005,0.36800000000000005,0.37000000000000005,0.37200000000000005,0.37400000000000005,0.37600000000000006,0.37800000000000006,0.38000000000000006,0.38200000000000006,0.384,0.386,0.388,0.39,0.392,0.394,0.396,0.398,0.4],"y":[0.02,0.0206,0.0212,0.0218,0.0224,0.023,0.0236,0.0242,0.0248,0.0254,0.026000000000000002,0.0266,0.027200000000000002,0.0278,0.0284,0.028999999999999998,0.0296,0.0302,0.0308,0.0314,0.032,0.0326,0.0332,0.0338,0.0344,0.035,0.0356,0.036199999999999996,0.0368,0.0374,0.038,0.038599999999999995,0.0392,0.0398,0.040400000000000005,0.041,0.0416,0.0422,0.042800000000000005,0.0434,0.044,0.0446,0.0452,0.0458,0.0464,0.047,0.0476,0.0482,0.048799999999999996,0.0494,0.05,0.0506,0.051199999999999996,0.0518,0.0524,0.053000000000000005,0.05360000000000001,0.0542,0.0548,0.05539999999999999,0.055999999999999994,0.0566,0.0572,0.057800000000000004,0.058399999999999994,0.059,0.0596,0.060200000000000004,0.06080000000000001,0.061399999999999996,0.062,0.0626,0.06319999999999999,0.0638,0.0644,0.065,0.0656,0.0662,0.0668,0.0674,0.068,0.06860000000000001,0.0692,0.0698,0.07039999999999999,0.071,0.0716,0.0722,0.0728,0.07339999999999999,0.074,0.0746,0.0752,0.0758,0.0764,0.077,0.0776,0.07819999999999999,0.0788,0.0794,0.08,0.08030000000000001,0.0806,0.0809,0.0812,0.0815,0.08180000000000001,0.0821,0.0824,0.0827,0.083,0.08330000000000001,0.08360000000000001,0.0839,0.0842,0.0845,0.0848,0.08510000000000001,0.0854,0.0857,0.086,0.0863,0.08660000000000001,0.0869,0.0872,0.0875,0.0878,0.08810000000000001,0.0884,0.0887,0.089,0.0893,0.08960000000000001,0.08990000000000001,0.0902,0.0905,0.0908,0.09110000000000001,0.09140000000000001,0.0917,0.092,0.0923,0.0926,0.0929,0.0932,0.0935,0.0938,0.0941,0.0944,0.0947,0.095,0.0953,0.0956,0.0959,0.09620000000000001,0.0965,0.0968,0.0971,0.0974,0.09770000000000001,0.098,0.0983,0.09860000000000001,0.0989,0.09920000000000001,0.0995,0.0998,0.1001,0.10039999999999999,0.1007,0.101,0.1013,0.1016,0.10189999999999999,0.1022,0.10250000000000001,0.1028,0.1031,0.10339999999999999,0.1037,0.10400000000000001,0.1043,0.1046,0.1049,0.1052,0.10550000000000001,0.1058,0.1061,0.1064,0.1067,0.10700000000000001,0.1073,0.1076,0.1079,0.10819999999999999,0.1085,0.10880000000000001,0.1091,0.1094,0.10969999999999999,0.11],"type":"scatter"},{"hovertemplate":"wealth in market = 100%<extra></extra>","marker":{"size":15},"mode":"markers","name":"Market","x":[0.2],"y":[0.08],"type":"scatter"},{"hovertemplate":"wealth in market = 0%<extra></extra>","marker":{"size":15},"mode":"markers","name":"Risk-free (Saving)","x":[0],"y":[0.02],"type":"scatter"},{"hovertemplate":"Borrowing rate<extra></extra>","marker":{"size":15},"mode":"markers","name":"Risk-free (Borrowing)","x":[0],"y":[0.05],"type":"scatter"},{"hovertemplate":"indifference curve for <br>utility obtained from <br>optimal wealth in market = 50.0%<extra></extra>","mode":"lines","name":"Risk Aversion=3","x":[0.0,0.002,0.004,0.006,0.008,0.010000000000000002,0.012,0.014000000000000002,0.016,0.018,0.020000000000000004,0.022000000000000002,0.024,0.026000000000000002,0.028000000000000004,0.03,0.032,0.034,0.036,0.038000000000000006,0.04000000000000001,0.042,0.044000000000000004,0.046000000000000006,0.048,0.05,0.052000000000000005,0.054000000000000006,0.05600000000000001,0.057999999999999996,0.06,0.062,0.064,0.066,0.068,0.07,0.072,0.074,0.07600000000000001,0.07800000000000001,0.08000000000000002,0.08200000000000002,0.084,0.08600000000000001,0.08800000000000001,0.09000000000000001,0.09200000000000001,0.09400000000000001,0.096,0.098,0.1,0.10200000000000001,0.10400000000000001,0.10600000000000001,0.10800000000000001,0.11000000000000001,0.11200000000000002,0.11400000000000002,0.11599999999999999,0.118,0.12,0.122,0.124,0.126,0.128,0.13,0.132,0.134,0.136,0.138,0.14,0.142,0.144,0.146,0.148,0.15000000000000002,0.15200000000000002,0.15400000000000003,0.15600000000000003,0.15800000000000003,0.16000000000000003,0.16200000000000003,0.16400000000000003,0.16600000000000004,0.168,0.17,0.17200000000000001,0.17400000000000002,0.17600000000000002,0.17800000000000002,0.18000000000000002,0.18200000000000002,0.18400000000000002,0.18600000000000003,0.18800000000000003,0.19000000000000003,0.192,0.194,0.196,0.198,0.2,0.202,0.20400000000000001,0.20600000000000002,0.20800000000000002,0.21000000000000002,0.21200000000000002,0.21400000000000002,0.21600000000000003,0.21800000000000003,0.22000000000000003,0.22200000000000003,0.22400000000000003,0.22600000000000003,0.22800000000000004,0.23000000000000004,0.23199999999999998,0.23399999999999999,0.236,0.238,0.24,0.242,0.244,0.246,0.248,0.25,0.252,0.254,0.256,0.258,0.26,0.262,0.264,0.266,0.268,0.27,0.272,0.274,0.276,0.278,0.28,0.282,0.284,0.286,0.288,0.29,0.292,0.294,0.296,0.298,0.30000000000000004,0.30200000000000005,0.30400000000000005,0.30600000000000005,0.30800000000000005,0.31000000000000005,0.31200000000000006,0.31400000000000006,0.31600000000000006,0.31800000000000006,0.32000000000000006,0.32200000000000006,0.32400000000000007,0.32600000000000007,0.32800000000000007,0.33000000000000007,0.3320000000000001,0.334,0.336,0.338,0.34,0.342,0.34400000000000003,0.34600000000000003,0.34800000000000003,0.35000000000000003,0.35200000000000004,0.35400000000000004,0.35600000000000004,0.35800000000000004,0.36000000000000004,0.36200000000000004,0.36400000000000005,0.36600000000000005,0.36800000000000005,0.37000000000000005,0.37200000000000005,0.37400000000000005,0.37600000000000006,0.37800000000000006,0.38000000000000006,0.38200000000000006,0.384,0.386,0.388,0.39,0.392,0.394,0.396,0.398,0.4],"y":[0.035,0.035006,0.035024000000000007,0.035054,0.035096,0.03515,0.035216000000000004,0.035294000000000006,0.035384000000000006,0.035486000000000004,0.03560000000000001,0.035726,0.035864,0.036014000000000004,0.03617600000000001,0.03635,0.036536000000000006,0.036734,0.036944000000000005,0.037166000000000005,0.0374,0.037646000000000006,0.03790400000000001,0.03817400000000001,0.038456000000000004,0.03875000000000001,0.03905600000000001,0.039374000000000006,0.039704,0.040046000000000005,0.040400000000000005,0.040766000000000004,0.041144,0.041534,0.041936,0.042350000000000006,0.042776,0.043214,0.04366400000000001,0.044126000000000005,0.04460000000000001,0.04508600000000001,0.045584000000000006,0.04609400000000001,0.046616000000000005,0.047150000000000004,0.04769600000000001,0.048254000000000005,0.048824000000000006,0.049406000000000005,0.05,0.050606000000000005,0.051224000000000006,0.05185400000000001,0.05249600000000001,0.05315000000000001,0.05381600000000001,0.05449400000000001,0.055184,0.055886000000000005,0.056600000000000004,0.057326,0.058064000000000004,0.058814000000000005,0.059576000000000004,0.06035000000000001,0.06113600000000001,0.06193400000000001,0.06274400000000001,0.06356600000000001,0.06440000000000001,0.065246,0.066104,0.066974,0.067856,0.06875,0.06965600000000001,0.07057400000000001,0.07150400000000001,0.07244600000000001,0.07340000000000002,0.07436600000000002,0.07534400000000002,0.07633400000000001,0.07733600000000002,0.07835,0.07937600000000002,0.08041400000000001,0.08146400000000001,0.08252600000000002,0.08360000000000001,0.08468600000000001,0.08578400000000003,0.08689400000000001,0.08801600000000001,0.08915000000000002,0.090296,0.09145400000000001,0.09262400000000001,0.093806,0.09500000000000001,0.09620600000000001,0.09742400000000001,0.09865400000000002,0.09989600000000001,0.10115000000000002,0.10241600000000002,0.10369400000000002,0.10498400000000002,0.10628600000000002,0.10760000000000003,0.10892600000000002,0.11026400000000003,0.11161400000000003,0.11297600000000002,0.11435000000000003,0.11573599999999999,0.11713399999999999,0.118544,0.11996599999999999,0.12140000000000001,0.122846,0.124304,0.125774,0.12725599999999998,0.12875,0.130256,0.131774,0.133304,0.134846,0.13640000000000002,0.13796600000000003,0.139544,0.14113400000000004,0.14273600000000003,0.14435,0.14597600000000002,0.14761400000000002,0.149264,0.15092600000000003,0.1526,0.15428599999999998,0.15598399999999998,0.15769399999999997,0.159416,0.16115,0.16289599999999999,0.164654,0.166424,0.168206,0.17000000000000004,0.17180600000000004,0.17362400000000003,0.17545400000000003,0.17729600000000004,0.17915000000000006,0.18101600000000004,0.18289400000000006,0.18478400000000006,0.18668600000000005,0.18860000000000007,0.19052600000000006,0.19246400000000005,0.19441400000000006,0.19637600000000008,0.19835000000000008,0.20033600000000007,0.20233400000000004,0.20434400000000003,0.20636600000000002,0.20840000000000003,0.21044600000000002,0.21250400000000005,0.21457400000000001,0.21665600000000004,0.21875000000000003,0.22085600000000005,0.22297400000000006,0.22510400000000003,0.22724600000000003,0.22940000000000002,0.23156600000000002,0.23374400000000004,0.23593400000000006,0.23813600000000007,0.2403500000000001,0.24257600000000004,0.24481400000000006,0.24706400000000003,0.24932600000000008,0.25160000000000005,0.25388600000000006,0.25618399999999997,0.258494,0.26081600000000005,0.26315,0.26549600000000007,0.26785400000000004,0.270224,0.272606,0.275],"type":"scatter"},{"hovertemplate":"indifference curve for <br>utility obtained from <br>optimal wealth in market = 150.0%<extra></extra>","mode":"lines","name":"Risk Aversion=0.5","x":[0.0,0.002,0.004,0.006,0.008,0.010000000000000002,0.012,0.014000000000000002,0.016,0.018,0.020000000000000004,0.022000000000000002,0.024,0.026000000000000002,0.028000000000000004,0.03,0.032,0.034,0.036,0.038000000000000006,0.04000000000000001,0.042,0.044000000000000004,0.046000000000000006,0.048,0.05,0.052000000000000005,0.054000000000000006,0.05600000000000001,0.057999999999999996,0.06,0.062,0.064,0.066,0.068,0.07,0.072,0.074,0.07600000000000001,0.07800000000000001,0.08000000000000002,0.08200000000000002,0.084,0.08600000000000001,0.08800000000000001,0.09000000000000001,0.09200000000000001,0.09400000000000001,0.096,0.098,0.1,0.10200000000000001,0.10400000000000001,0.10600000000000001,0.10800000000000001,0.11000000000000001,0.11200000000000002,0.11400000000000002,0.11599999999999999,0.118,0.12,0.122,0.124,0.126,0.128,0.13,0.132,0.134,0.136,0.138,0.14,0.142,0.144,0.146,0.148,0.15000000000000002,0.15200000000000002,0.15400000000000003,0.15600000000000003,0.15800000000000003,0.16000000000000003,0.16200000000000003,0.16400000000000003,0.16600000000000004,0.168,0.17,0.17200000000000001,0.17400000000000002,0.17600000000000002,0.17800000000000002,0.18000000000000002,0.18200000000000002,0.18400000000000002,0.18600000000000003,0.18800000000000003,0.19000000000000003,0.192,0.194,0.196,0.198,0.2,0.202,0.20400000000000001,0.20600000000000002,0.20800000000000002,0.21000000000000002,0.21200000000000002,0.21400000000000002,0.21600000000000003,0.21800000000000003,0.22000000000000003,0.22200000000000003,0.22400000000000003,0.22600000000000003,0.22800000000000004,0.23000000000000004,0.23199999999999998,0.23399999999999999,0.236,0.238,0.24,0.242,0.244,0.246,0.248,0.25,0.252,0.254,0.256,0.258,0.26,0.262,0.264,0.266,0.268,0.27,0.272,0.274,0.276,0.278,0.28,0.282,0.284,0.286,0.288,0.29,0.292,0.294,0.296,0.298,0.30000000000000004,0.30200000000000005,0.30400000000000005,0.30600000000000005,0.30800000000000005,0.31000000000000005,0.31200000000000006,0.31400000000000006,0.31600000000000006,0.31800000000000006,0.32000000000000006,0.32200000000000006,0.32400000000000007,0.32600000000000007,0.32800000000000007,0.33000000000000007,0.3320000000000001,0.334,0.336,0.338,0.34,0.342,0.34400000000000003,0.34600000000000003,0.34800000000000003,0.35000000000000003,0.35200000000000004,0.35400000000000004,0.35600000000000004,0.35800000000000004,0.36000000000000004,0.36200000000000004,0.36400000000000005,0.36600000000000005,0.36800000000000005,0.37000000000000005,0.37200000000000005,0.37400000000000005,0.37600000000000006,0.37800000000000006,0.38000000000000006,0.38200000000000006,0.384,0.386,0.388,0.39,0.392,0.394,0.396,0.398,0.4],"y":[0.0725,0.072501,0.072504,0.07250899999999999,0.072516,0.07252499999999999,0.07253599999999999,0.07254899999999999,0.07256399999999999,0.07258099999999999,0.0726,0.07262099999999999,0.072644,0.072669,0.072696,0.072725,0.072756,0.07278899999999999,0.072824,0.072861,0.07289999999999999,0.07294099999999999,0.072984,0.073029,0.07307599999999999,0.073125,0.07317599999999999,0.07322899999999999,0.073284,0.07334099999999999,0.07339999999999999,0.073461,0.07352399999999999,0.073589,0.073656,0.073725,0.073796,0.07386899999999999,0.073944,0.07402099999999999,0.0741,0.074181,0.074264,0.074349,0.074436,0.074525,0.074616,0.074709,0.074804,0.074901,0.075,0.075101,0.075204,0.075309,0.075416,0.075525,0.075636,0.075749,0.075864,0.07598099999999999,0.0761,0.076221,0.076344,0.076469,0.076596,0.076725,0.076856,0.076989,0.077124,0.077261,0.0774,0.077541,0.07768399999999999,0.077829,0.07797599999999999,0.078125,0.078276,0.078429,0.078584,0.07874099999999999,0.0789,0.07906099999999999,0.079224,0.079389,0.079556,0.07972499999999999,0.079896,0.080069,0.080244,0.08042099999999999,0.08059999999999999,0.08078099999999999,0.080964,0.081149,0.08133599999999999,0.081525,0.081716,0.081909,0.082104,0.082301,0.08249999999999999,0.082701,0.08290399999999999,0.083109,0.083316,0.083525,0.083736,0.083949,0.084164,0.084381,0.0846,0.084821,0.085044,0.085269,0.085496,0.085725,0.08595599999999999,0.08618899999999999,0.086424,0.08666099999999999,0.08689999999999999,0.087141,0.08738399999999999,0.087629,0.087876,0.088125,0.088376,0.088629,0.08888399999999999,0.089141,0.0894,0.08966099999999999,0.089924,0.09018899999999999,0.090456,0.090725,0.090996,0.091269,0.091544,0.091821,0.0921,0.09238099999999999,0.092664,0.09294899999999999,0.09323599999999999,0.093525,0.093816,0.094109,0.09440399999999999,0.094701,0.095,0.095301,0.095604,0.095909,0.096216,0.096525,0.096836,0.097149,0.09746400000000001,0.097781,0.0981,0.09842100000000001,0.098744,0.099069,0.09939600000000001,0.09972500000000001,0.100056,0.100389,0.100724,0.101061,0.1014,0.101741,0.10208400000000001,0.10242899999999999,0.102776,0.103125,0.103476,0.103829,0.104184,0.104541,0.1049,0.105261,0.105624,0.105989,0.106356,0.10672500000000001,0.107096,0.10746900000000001,0.107844,0.10822100000000001,0.1086,0.10898100000000001,0.10936399999999999,0.109749,0.110136,0.110525,0.110916,0.11130899999999999,0.111704,0.112101,0.1125],"type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"title":{"text":"Standard Deviation"},"tickformat":".0%"},"yaxis":{"title":{"text":"Expected Return"},"tickformat":".0%"}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('271feb4c-ce18-4eae-bb4e-c954635358de');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
<p></p><figcaption class="figure-caption">Figure 4.4: Preferences and the Capital Allocation Line</figcaption><p></p>
</figure>
</div>
</div>
<p>Another way to see how risk aversion affects capital allocation is to plot the risky asset weight as a function of risk aversion, as in <a href="#fig-cal-wgt-by-riskaver">Figure&nbsp;<span>4.5</span></a>. Higher risk aversion translates into lower holdings of the risky asset. This effect is monotonic except for a region of risk aversion where the optimal weight is 100% in the market portfolio. This is due to the kink in the capital allocation line resulting from the difference in risk-free borrowing and savings rates.</p>
<div class="cell" data-execution_count="6">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.graph_objects <span class="im">as</span> go</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameter values (in percent)</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>mn <span class="op">=</span> <span class="dv">8</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>sd <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>extra <span class="op">=</span> <span class="dv">3</span>   <span class="co">#incremental borrowing rate</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> opt_wgt(mn, sd, s, b, A):</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># return/sd inputs must be in decimal</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    wgt <span class="op">=</span> (mn <span class="op">-</span> s) <span class="op">/</span> (A <span class="op">*</span> (sd<span class="op">**</span><span class="dv">2</span>))</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    expret<span class="op">=</span> wgt<span class="op">*</span>mn <span class="op">+</span> (<span class="dv">1</span><span class="op">-</span>wgt)<span class="op">*</span>s</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>    sdret <span class="op">=</span> wgt<span class="op">*</span>sd </span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> wgt <span class="op">&gt;</span> <span class="dv">1</span>:</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>        wgt <span class="op">=</span> (mn <span class="op">-</span> b) <span class="op">/</span> (A <span class="op">*</span> (sd<span class="op">**</span><span class="dv">2</span>))</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>        wgt <span class="op">=</span> <span class="bu">max</span>(wgt,<span class="dv">1</span>)</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>        expret<span class="op">=</span> wgt<span class="op">*</span>mn <span class="op">+</span> (<span class="dv">1</span><span class="op">-</span>wgt)<span class="op">*</span>b </span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>        sdret <span class="op">=</span> wgt<span class="op">*</span>sd   </span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>    u <span class="op">=</span> expret <span class="op">-</span> <span class="fl">0.5</span><span class="op">*</span>A<span class="op">*</span>sdret<span class="op">**</span><span class="dv">2</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> wgt</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> figtbl(mn, sd, s, extra):</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>    mn <span class="op">/=</span> <span class="dv">100</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>    sd <span class="op">/=</span> <span class="dv">100</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>    b <span class="op">=</span> s<span class="op">+</span>extra</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>    s <span class="op">/=</span> <span class="dv">100</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>    b <span class="op">/=</span> <span class="dv">100</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>    ravers <span class="op">=</span> np.arange(<span class="fl">0.2</span>,<span class="fl">5.1</span>,<span class="fl">0.1</span>)</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>    wgts <span class="op">=</span> [opt_wgt(mn,sd,s,b,A) <span class="cf">for</span> A <span class="kw">in</span> ravers]</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>    string <span class="op">=</span> <span class="st">"Risk Aversion: %</span><span class="sc">{x:.2f}</span><span class="st"> &lt;br&gt;Risky Asset Weight: %</span><span class="sc">{y:.1%}</span><span class="st">&lt;extra&gt;&lt;/extra&gt;"</span></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>    trace1 <span class="op">=</span> go.Scatter(</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span>ravers, y<span class="op">=</span>wgts, mode<span class="op">=</span><span class="st">"lines"</span>, hovertemplate<span class="op">=</span>string, marker<span class="op">=</span><span class="bu">dict</span>(size<span class="op">=</span><span class="dv">15</span>), name<span class="op">=</span><span class="st">'Optimal Weight'</span></span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>    )       </span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>    fig <span class="op">=</span> go.Figure()</span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>    fig.add_trace(trace1)</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>    fig.layout.xaxis[<span class="st">"title"</span>] <span class="op">=</span> <span class="st">"Risk Aversion"</span></span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>    fig.layout.yaxis[<span class="st">"title"</span>] <span class="op">=</span> <span class="st">"Weight in Risky Asset"</span></span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>    fig.update_yaxes(tickformat<span class="op">=</span><span class="st">".1%"</span>)</span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>    fig.update_xaxes(tickformat<span class="op">=</span><span class="st">".2"</span>)</span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>    fig.show()</span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>figtbl(mn, sd, s, extra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-cal-wgt-by-riskaver" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">

<div>                            <div id="1482ae92-cae8-499b-aaa7-aa99808b7863" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("1482ae92-cae8-499b-aaa7-aa99808b7863")) {                    Plotly.newPlot(                        "1482ae92-cae8-499b-aaa7-aa99808b7863",                        [{"hovertemplate":"Risk Aversion: %{x:.2f} <br>Risky Asset Weight: %{y:.1%}<extra></extra>","marker":{"size":15},"mode":"lines","name":"Optimal Weight","x":[0.2,0.30000000000000004,0.4000000000000001,0.5000000000000001,0.6000000000000001,0.7000000000000002,0.8000000000000003,0.9000000000000001,1.0000000000000002,1.1000000000000003,1.2000000000000004,1.3000000000000003,1.4000000000000004,1.5000000000000004,1.6000000000000003,1.7000000000000004,1.8000000000000005,1.9000000000000006,2.000000000000001,2.1000000000000005,2.200000000000001,2.3000000000000007,2.400000000000001,2.500000000000001,2.600000000000001,2.700000000000001,2.800000000000001,2.9000000000000012,3.000000000000001,3.100000000000001,3.200000000000001,3.300000000000001,3.4000000000000012,3.5000000000000013,3.6000000000000014,3.7000000000000015,3.8000000000000016,3.9000000000000012,4.000000000000001,4.100000000000001,4.200000000000002,4.300000000000002,4.400000000000001,4.500000000000002,4.600000000000001,4.700000000000002,4.800000000000002,4.900000000000002,5.000000000000002],"y":[3.749999999999999,2.499999999999999,1.8749999999999991,1.4999999999999993,1.2499999999999996,1.071428571428571,1,1,1,1,1,1,1,0.9999999999999994,0.9374999999999996,0.8823529411764701,0.8333333333333329,0.7894736842105259,0.7499999999999994,0.714285714285714,0.6818181818181813,0.6521739130434779,0.6249999999999996,0.5999999999999996,0.5769230769230765,0.5555555555555551,0.5357142857142854,0.5172413793103444,0.4999999999999997,0.4838709677419352,0.4687499999999998,0.4545454545454543,0.44117647058823506,0.4285714285714283,0.41666666666666646,0.4054054054054052,0.3947368421052629,0.3846153846153844,0.37499999999999983,0.36585365853658514,0.3571428571428569,0.34883720930232537,0.3409090909090908,0.33333333333333315,0.32608695652173897,0.31914893617021256,0.3124999999999998,0.3061224489795916,0.2999999999999998],"type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"title":{"text":"Risk Aversion"},"tickformat":".2"},"yaxis":{"title":{"text":"Weight in Risky Asset"},"tickformat":".1%"}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('1482ae92-cae8-499b-aaa7-aa99808b7863');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
<p></p><figcaption class="figure-caption">Figure 4.5: Risky asset weight as function of risk aversion</figcaption><p></p>
</figure>
</div>
</div>
</section>
<section id="sec-two-risky" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="sec-two-risky"><span class="header-section-number">4.4</span> Diversification and Portfolios of Two Risky Assets</h2>
<p>Diversification is a foundational concept in forming portfolios. We will discuss the benefits of diversification repeatedly throughout this chapter. Consider forming a portfolio of two risky assets. To fix ideas, let’s consider these to be a broad stock market index fund and a long-term government bond fund. If we invest all of our capital in some combination of these two assets, what are the expected returns and standard deviations of all the potential portfolios? Assume for now that we cannot short sell either asset; that is, the fraction invested in each must be non-negative.</p>
<p>For some weight <span class="math inline">\(w_S\)</span> in the stock portfolio, the expected return of the portfolio is:</p>
<p><span class="math display">\[ E[r_p] = w_S E[r_S] + (1-w_S) E[r_B]\,,\]</span></p>
<p>and the portfolio’s variance is:</p>
<p><span class="math display">\[  \text{var}[r_p] = w_S^2 \text{var}[r_S]+ (1-w_S)^2 \text{var}[r_B]+ 2 w_S (1-w_S) \rho_{S,B}\text{sd}[r_S]\text{sd}[r_B]\,. \]</span></p>
<p>Note that we have substituted out the covariance using the definition of correlation. We plot the possible combinations of the stock fund and bond fund in <a href="#fig-two-asset">Figure&nbsp;<span>4.6</span></a> for three distinct correlation values. The correlation of -5% is the realized correlation between stocks and bonds from 1980 to 2020. During that period though, the correlation varied dramatically, switching from negative to positive. From 1980 to 2000, the correlation was -63%, and it was 26% from 2000 to 2020. These differences can change the investment opportunity set substantially. With a correlation of -63%, the bond portfolio is dominated by a portfolio that invests just under 80% of wealth in bonds and the other 20% in stocks. This portfolio generates a higher expected return for the same level of risk.</p>
<p><a href="#fig-two-asset">Figure&nbsp;<span>4.6</span></a> shows the benefits of lower correlations across assets in the portfolio. For lower levels of correlation between stocks and bonds, it is possible to achieve a lower portfolio standard deviation for the same level of expected return. (Note: we are holding the stock and bond expected returns and standard deviations constant in the figure. In practice, these can also vary over time.)</p>
<p>HAVE A PLOT WITH JUST A SINGLE CURVE?</p>
<div class="cell" data-execution_count="7">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.graph_objects <span class="im">as</span> go</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>mn_stock <span class="op">=</span> <span class="dv">8</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>mn_bond  <span class="op">=</span> <span class="fl">3.5</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>sd_stock <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>sd_bond  <span class="op">=</span> <span class="fl">3.5</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>corr0 <span class="op">=</span> <span class="op">-</span><span class="dv">5</span>   <span class="co"># from 1980 to 2020</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>corr1 <span class="op">=</span> <span class="op">-</span><span class="dv">63</span>  <span class="co"># from 1980 to 2000</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>corr2 <span class="op">=</span> <span class="dv">26</span>   <span class="co"># from 2000 to 2020</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> data(mn1, mn2, sd1, sd2, c):</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>    c <span class="op">=</span> c <span class="op">/</span> <span class="dv">100</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>    mns <span class="op">=</span> [mn1, mn2]</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>    sds <span class="op">=</span> [sd1, sd2]</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>    grid <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">101</span>)</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>    ports <span class="op">=</span> [np.array([w, <span class="dv">1</span> <span class="op">-</span> w]) <span class="cf">for</span> w <span class="kw">in</span> grid]</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>    means <span class="op">=</span> [p.T <span class="op">@</span> np.array(mns) <span class="cf">for</span> p <span class="kw">in</span> ports]</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> pd.DataFrame(means)</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>    df.columns <span class="op">=</span> [<span class="st">"mean"</span>]</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>    cov <span class="op">=</span> np.array(</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>        [[sds[<span class="dv">0</span>] <span class="op">**</span> <span class="dv">2</span>, sds[<span class="dv">0</span>] <span class="op">*</span> sds[<span class="dv">1</span>] <span class="op">*</span> c], [sds[<span class="dv">0</span>] <span class="op">*</span> sds[<span class="dv">1</span>] <span class="op">*</span> c, sds[<span class="dv">1</span>] <span class="op">**</span> <span class="dv">2</span>]]</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>    ).reshape(<span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">"stdev"</span>] <span class="op">=</span> [np.sqrt(p.T <span class="op">@</span> cov <span class="op">@</span> p) <span class="cf">for</span> p <span class="kw">in</span> ports]</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">"wt1"</span>] <span class="op">=</span> grid</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">"wt2"</span>] <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> df.wt1</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col <span class="kw">in</span> [<span class="st">"mean"</span>, <span class="st">"stdev"</span>]:</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>        df[col] <span class="op">=</span> df[col] <span class="op">/</span> <span class="dv">100</span></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> figtbl(mn1, mn2, sd1, sd2, c0, c1, c2,asset1_name, asset2_name):</span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> data(mn1, mn2, sd1, sd2, c0)</span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>    string0 <span class="op">=</span> <span class="st">"Correlation = "</span> <span class="op">+</span><span class="bu">str</span>(np.<span class="bu">round</span>(c0,<span class="dv">1</span>)) <span class="op">+</span> <span class="st">"%"</span></span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>    trace0 <span class="op">=</span> go.Scatter(</span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span>df[<span class="st">"stdev"</span>],</span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span>df[<span class="st">"mean"</span>],</span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>        mode<span class="op">=</span><span class="st">"lines"</span>,</span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>        text<span class="op">=</span><span class="dv">100</span> <span class="op">*</span> df[<span class="st">"wt1"</span>],</span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>        customdata<span class="op">=</span><span class="dv">100</span> <span class="op">*</span> df[<span class="st">"wt2"</span>],</span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a>        hovertemplate<span class="op">=</span>string0 <span class="op">+</span> <span class="st">"&lt;br&gt;"</span><span class="op">+</span>asset1_name <span class="op">+</span> <span class="st">": %</span><span class="sc">{text:.0f}</span><span class="st">%&lt;br&gt;"</span><span class="op">+</span>asset2_name <span class="op">+</span> <span class="st">": %</span><span class="sc">{customdata:.0f}</span><span class="st">%&lt;extra&gt;&lt;/extra&gt;"</span>,</span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>        name<span class="op">=</span>string0</span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> data(mn1, mn2, sd1, sd2, c1)</span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a>    string1 <span class="op">=</span> <span class="st">"Correlation = "</span> <span class="op">+</span><span class="bu">str</span>(np.<span class="bu">round</span>(c1,<span class="dv">1</span>)) <span class="op">+</span> <span class="st">"%"</span></span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a>    trace1 <span class="op">=</span> go.Scatter(</span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span>df[<span class="st">"stdev"</span>],</span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span>df[<span class="st">"mean"</span>],</span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a>        mode<span class="op">=</span><span class="st">"lines"</span>,</span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a>        text<span class="op">=</span><span class="dv">100</span> <span class="op">*</span> df[<span class="st">"wt1"</span>],</span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a>        customdata<span class="op">=</span><span class="dv">100</span> <span class="op">*</span> df[<span class="st">"wt2"</span>],</span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a>        hovertemplate<span class="op">=</span>string1 <span class="op">+</span> <span class="st">"&lt;br&gt;"</span><span class="op">+</span>asset1_name <span class="op">+</span> <span class="st">": %</span><span class="sc">{text:.0f}</span><span class="st">%&lt;br&gt;"</span><span class="op">+</span>asset2_name <span class="op">+</span> <span class="st">": %</span><span class="sc">{customdata:.0f}</span><span class="st">%&lt;extra&gt;&lt;/extra&gt;"</span>,</span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a>        name<span class="op">=</span>string1</span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> data(mn1, mn2, sd1, sd2, c2)</span>
<span id="cb6-61"><a href="#cb6-61" aria-hidden="true" tabindex="-1"></a>    string2 <span class="op">=</span> <span class="st">"Correlation = "</span> <span class="op">+</span><span class="bu">str</span>(np.<span class="bu">round</span>(c2,<span class="dv">1</span>)) <span class="op">+</span> <span class="st">"%"</span></span>
<span id="cb6-62"><a href="#cb6-62" aria-hidden="true" tabindex="-1"></a>    trace2 <span class="op">=</span> go.Scatter(</span>
<span id="cb6-63"><a href="#cb6-63" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span>df[<span class="st">"stdev"</span>],</span>
<span id="cb6-64"><a href="#cb6-64" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span>df[<span class="st">"mean"</span>],</span>
<span id="cb6-65"><a href="#cb6-65" aria-hidden="true" tabindex="-1"></a>        mode<span class="op">=</span><span class="st">"lines"</span>,</span>
<span id="cb6-66"><a href="#cb6-66" aria-hidden="true" tabindex="-1"></a>        text<span class="op">=</span><span class="dv">100</span> <span class="op">*</span> df[<span class="st">"wt1"</span>],</span>
<span id="cb6-67"><a href="#cb6-67" aria-hidden="true" tabindex="-1"></a>        customdata<span class="op">=</span><span class="dv">100</span> <span class="op">*</span> df[<span class="st">"wt2"</span>],</span>
<span id="cb6-68"><a href="#cb6-68" aria-hidden="true" tabindex="-1"></a>        hovertemplate<span class="op">=</span>string2 <span class="op">+</span> <span class="st">"&lt;br&gt;"</span><span class="op">+</span>asset1_name <span class="op">+</span> <span class="st">": %</span><span class="sc">{text:.0f}</span><span class="st">%&lt;br&gt;"</span><span class="op">+</span>asset2_name <span class="op">+</span> <span class="st">": %</span><span class="sc">{customdata:.0f}</span><span class="st">%&lt;extra&gt;&lt;/extra&gt;"</span>,</span>
<span id="cb6-69"><a href="#cb6-69" aria-hidden="true" tabindex="-1"></a>        name<span class="op">=</span>string2</span>
<span id="cb6-70"><a href="#cb6-70" aria-hidden="true" tabindex="-1"></a>    )   </span>
<span id="cb6-71"><a href="#cb6-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-72"><a href="#cb6-72" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot the two assets</span></span>
<span id="cb6-73"><a href="#cb6-73" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> df[df.wt1.isin([<span class="dv">0</span>, <span class="dv">1</span>])]</span>
<span id="cb6-74"><a href="#cb6-74" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">"text"</span>] <span class="op">=</span> np.where(df.wt1 <span class="op">==</span> <span class="dv">1</span>, asset1_name, asset2_name)</span>
<span id="cb6-75"><a href="#cb6-75" aria-hidden="true" tabindex="-1"></a>    trace3 <span class="op">=</span> go.Scatter(</span>
<span id="cb6-76"><a href="#cb6-76" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span>df[df.wt1<span class="op">==</span><span class="dv">1</span>][<span class="st">"stdev"</span>],</span>
<span id="cb6-77"><a href="#cb6-77" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span>df[df.wt1<span class="op">==</span><span class="dv">1</span>][<span class="st">"mean"</span>],</span>
<span id="cb6-78"><a href="#cb6-78" aria-hidden="true" tabindex="-1"></a>        mode<span class="op">=</span><span class="st">"markers"</span>,</span>
<span id="cb6-79"><a href="#cb6-79" aria-hidden="true" tabindex="-1"></a>        text<span class="op">=</span>df[df.wt1<span class="op">==</span><span class="dv">1</span>][<span class="st">"text"</span>],</span>
<span id="cb6-80"><a href="#cb6-80" aria-hidden="true" tabindex="-1"></a>        hovertemplate<span class="op">=</span><span class="st">"%</span><span class="sc">{text}</span><span class="st">&lt;extra&gt;&lt;/extra&gt;"</span>,</span>
<span id="cb6-81"><a href="#cb6-81" aria-hidden="true" tabindex="-1"></a>        marker<span class="op">=</span><span class="bu">dict</span>(size<span class="op">=</span><span class="dv">15</span>),</span>
<span id="cb6-82"><a href="#cb6-82" aria-hidden="true" tabindex="-1"></a>        name<span class="op">=</span>asset1_name</span>
<span id="cb6-83"><a href="#cb6-83" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb6-84"><a href="#cb6-84" aria-hidden="true" tabindex="-1"></a>    trace4 <span class="op">=</span> go.Scatter(</span>
<span id="cb6-85"><a href="#cb6-85" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span>df[df.wt1<span class="op">==</span><span class="dv">0</span>][<span class="st">"stdev"</span>],</span>
<span id="cb6-86"><a href="#cb6-86" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span>df[df.wt1<span class="op">==</span><span class="dv">0</span>][<span class="st">"mean"</span>],</span>
<span id="cb6-87"><a href="#cb6-87" aria-hidden="true" tabindex="-1"></a>        mode<span class="op">=</span><span class="st">"markers"</span>,</span>
<span id="cb6-88"><a href="#cb6-88" aria-hidden="true" tabindex="-1"></a>        text<span class="op">=</span>df[df.wt1<span class="op">==</span><span class="dv">0</span>][<span class="st">"text"</span>],</span>
<span id="cb6-89"><a href="#cb6-89" aria-hidden="true" tabindex="-1"></a>        hovertemplate<span class="op">=</span><span class="st">"%</span><span class="sc">{text}</span><span class="st">&lt;extra&gt;&lt;/extra&gt;"</span>,</span>
<span id="cb6-90"><a href="#cb6-90" aria-hidden="true" tabindex="-1"></a>        marker<span class="op">=</span><span class="bu">dict</span>(size<span class="op">=</span><span class="dv">15</span>),</span>
<span id="cb6-91"><a href="#cb6-91" aria-hidden="true" tabindex="-1"></a>        name<span class="op">=</span>asset2_name</span>
<span id="cb6-92"><a href="#cb6-92" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb6-93"><a href="#cb6-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-94"><a href="#cb6-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-95"><a href="#cb6-95" aria-hidden="true" tabindex="-1"></a>    fig <span class="op">=</span> go.Figure()</span>
<span id="cb6-96"><a href="#cb6-96" aria-hidden="true" tabindex="-1"></a>    fig.add_trace(trace0)</span>
<span id="cb6-97"><a href="#cb6-97" aria-hidden="true" tabindex="-1"></a>    fig.add_trace(trace1)</span>
<span id="cb6-98"><a href="#cb6-98" aria-hidden="true" tabindex="-1"></a>    fig.add_trace(trace2)</span>
<span id="cb6-99"><a href="#cb6-99" aria-hidden="true" tabindex="-1"></a>    fig.add_trace(trace3)</span>
<span id="cb6-100"><a href="#cb6-100" aria-hidden="true" tabindex="-1"></a>    fig.add_trace(trace4)</span>
<span id="cb6-101"><a href="#cb6-101" aria-hidden="true" tabindex="-1"></a>    fig.layout.xaxis[<span class="st">"title"</span>] <span class="op">=</span> <span class="st">"Standard Deviation"</span></span>
<span id="cb6-102"><a href="#cb6-102" aria-hidden="true" tabindex="-1"></a>    fig.layout.yaxis[<span class="st">"title"</span>] <span class="op">=</span> <span class="st">"Expected Return"</span></span>
<span id="cb6-103"><a href="#cb6-103" aria-hidden="true" tabindex="-1"></a>    fig.update_xaxes(<span class="bu">range</span><span class="op">=</span>[<span class="dv">0</span>, <span class="fl">1.25</span> <span class="op">*</span> df[<span class="st">"stdev"</span>].<span class="bu">max</span>()])</span>
<span id="cb6-104"><a href="#cb6-104" aria-hidden="true" tabindex="-1"></a>    fig.update_yaxes(<span class="bu">range</span><span class="op">=</span>[<span class="dv">0</span>, <span class="fl">1.25</span> <span class="op">*</span> df[<span class="st">"mean"</span>].<span class="bu">max</span>()])</span>
<span id="cb6-105"><a href="#cb6-105" aria-hidden="true" tabindex="-1"></a>    fig.update_yaxes(tickformat<span class="op">=</span><span class="st">".0%"</span>)</span>
<span id="cb6-106"><a href="#cb6-106" aria-hidden="true" tabindex="-1"></a>    fig.update_xaxes(tickformat<span class="op">=</span><span class="st">".0%"</span>)</span>
<span id="cb6-107"><a href="#cb6-107" aria-hidden="true" tabindex="-1"></a>    fig.show()</span>
<span id="cb6-108"><a href="#cb6-108" aria-hidden="true" tabindex="-1"></a>figtbl(mn_stock,mn_bond,sd_stock,sd_bond,corr0, corr1, corr2,<span class="st">"Stock"</span>,<span class="st">"Bond"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-two-asset" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">

<div>                            <div id="3d75eccd-d2fb-4ab4-b22e-9046a31508ea" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("3d75eccd-d2fb-4ab4-b22e-9046a31508ea")) {                    Plotly.newPlot(                        "3d75eccd-d2fb-4ab4-b22e-9046a31508ea",                        [{"customdata":[100.0,99.0,98.0,97.0,96.0,95.0,94.0,93.0,92.0,91.0,90.0,89.0,88.0,87.0,86.0,85.0,84.0,83.0,82.0,81.0,80.0,79.0,78.0,77.0,76.0,75.0,74.0,73.0,72.0,71.0,70.0,69.0,68.0,67.0,65.99999999999999,64.99999999999999,64.0,63.0,62.0,61.0,60.0,59.0,58.00000000000001,57.00000000000001,56.00000000000001,55.00000000000001,54.0,53.0,52.0,51.0,50.0,49.0,48.0,47.0,46.0,44.99999999999999,43.99999999999999,42.99999999999999,42.00000000000001,41.0,40.0,39.0,38.0,37.0,36.0,35.0,34.0,32.99999999999999,31.999999999999996,30.999999999999993,29.999999999999993,29.000000000000004,28.000000000000004,27.0,26.0,25.0,24.0,23.0,21.999999999999996,20.999999999999996,19.999999999999996,18.999999999999993,17.999999999999993,16.999999999999993,16.000000000000004,15.000000000000002,14.000000000000002,13.0,12.0,10.999999999999998,9.999999999999998,8.999999999999996,7.9999999999999964,6.999999999999995,5.999999999999995,4.999999999999993,4.0000000000000036,3.0000000000000027,2.0000000000000018,1.0000000000000009,0.0],"hovertemplate":"Correlation = -5%<br>Stock: %{text:.0f}%<br>Bond: %{customdata:.0f}%<extra></extra>","mode":"lines","name":"Correlation = -5%","text":[0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.000000000000001,8.0,9.0,10.0,11.0,12.0,13.0,14.000000000000002,15.0,16.0,17.0,18.0,19.0,20.0,21.0,22.0,23.0,24.0,25.0,26.0,27.0,28.000000000000004,28.999999999999996,30.0,31.0,32.0,33.0,34.0,35.0,36.0,37.0,38.0,39.0,40.0,41.0,42.0,43.0,44.0,45.0,46.0,47.0,48.0,49.0,50.0,51.0,52.0,53.0,54.0,55.00000000000001,56.00000000000001,57.00000000000001,57.99999999999999,59.0,60.0,61.0,62.0,63.0,64.0,65.0,66.0,67.0,68.0,69.0,70.0,71.0,72.0,73.0,74.0,75.0,76.0,77.0,78.0,79.0,80.0,81.0,82.0,83.0,84.0,85.0,86.0,87.0,88.0,89.0,90.0,91.0,92.0,93.0,94.0,95.0,96.0,97.0,98.0,99.0,100.0],"x":[0.035,0.034607694231196626,0.034333220064538074,0.03417941632035281,0.03414791355266087,0.034239049344279404,0.03445185045828453,0.0347840840040384,0.0352323714785139,0.03579235253514359,0.03645888094826829,0.03722623402924341,0.03808831841916889,0.03903885884602674,0.040071560987812796,0.041180244049786784,0.04235894238528625,0.043601978166133704,0.04490400872973369,0.046260052961491514,0.04766550115125194,0.04911611242759346,0.05060800331963315,0.052137630364258024,0.05370176905838392,0.05529749090148666,0.056922139805175985,0.0585733087677314,0.06024881741578004,0.06194669079135704,0.06366513959774218,0.06540254199952782,0.06715742699061661,0.06892845928932402,0.07071442568528716,0.07251422274285231,0.07432684575575638,0.0761513788450347,0.07798698609383492,0.07983290361749346,0.0816884324736373,0.0835529323243655,0.0854258157701757,0.08730654328284908,0.08919461867175621,0.09108958502485341,0.09299102107192932,0.09489853792340533,0.09681177614319449,0.09873040311879619,0.10065411069598698,0.10258261304919075,0.1045156447619207,0.10645295909461605,0.10839432641979008,0.11033953280669627,0.11228837873974315,0.11424067795667181,0.11619625639408525,0.11815495122930735,0.12011661000877438,0.12208108985424401,0.12404825673906103,0.1260179848275634,0.12799015587145757,0.129964658657652,0.13194138850262263,0.13392024678890047,0.13590114053973204,0.13788398202837052,0.1398686884188166,0.14185518143515238,0.143843387056896,0.14583323523806224,0.14782465964784086,0.14981759743100942,0.15181198898637752,0.1538077777617244,0.15580491006383593,0.15780333488237822,0.15980300372646317,0.161803870472866,0.16380589122494954,0.16580902418143592,0.16781322951424302,0.1698184692546721,0.17182470718729598,0.173831908750954,0.17584004094631006,0.17784907224947788,0.1798589725312585,0.1818697129815737,0.18388126603871316,0.18589360532304494,0.18790670557486766,0.18992054259610783,0.1919350931955905,0.1939503351376326,0.19596624709372787,0.19798280859711023,0.2],"y":[0.035,0.03545,0.0359,0.03635,0.0368,0.03725,0.0377,0.038149999999999996,0.0386,0.03905,0.0395,0.03995,0.0404,0.04085,0.041299999999999996,0.041749999999999995,0.042199999999999994,0.042649999999999993,0.043100000000000006,0.043550000000000005,0.044000000000000004,0.04445,0.0449,0.04535,0.0458,0.04625,0.0467,0.04715,0.047599999999999996,0.048049999999999995,0.048499999999999995,0.048949999999999994,0.04939999999999999,0.04984999999999999,0.050300000000000004,0.05075,0.0512,0.05165,0.0521,0.05255,0.053,0.05345,0.0539,0.05435,0.0548,0.05525,0.0557,0.056150000000000005,0.056600000000000004,0.057050000000000003,0.0575,0.05795,0.0584,0.05885,0.0593,0.059750000000000004,0.060200000000000004,0.06065,0.061099999999999995,0.06155,0.062,0.06245,0.0629,0.06335,0.0638,0.06425,0.0647,0.06515,0.0656,0.06605,0.0665,0.06695000000000001,0.0674,0.06785000000000001,0.0683,0.06875,0.0692,0.06965,0.0701,0.07055,0.07100000000000001,0.07145,0.0719,0.07235,0.0728,0.07325,0.0737,0.07415,0.0746,0.07505,0.0755,0.07595,0.07640000000000001,0.07685,0.07730000000000001,0.07775,0.0782,0.07865,0.0791,0.07955,0.08],"type":"scatter"},{"customdata":[100.0,99.0,98.0,97.0,96.0,95.0,94.0,93.0,92.0,91.0,90.0,89.0,88.0,87.0,86.0,85.0,84.0,83.0,82.0,81.0,80.0,79.0,78.0,77.0,76.0,75.0,74.0,73.0,72.0,71.0,70.0,69.0,68.0,67.0,65.99999999999999,64.99999999999999,64.0,63.0,62.0,61.0,60.0,59.0,58.00000000000001,57.00000000000001,56.00000000000001,55.00000000000001,54.0,53.0,52.0,51.0,50.0,49.0,48.0,47.0,46.0,44.99999999999999,43.99999999999999,42.99999999999999,42.00000000000001,41.0,40.0,39.0,38.0,37.0,36.0,35.0,34.0,32.99999999999999,31.999999999999996,30.999999999999993,29.999999999999993,29.000000000000004,28.000000000000004,27.0,26.0,25.0,24.0,23.0,21.999999999999996,20.999999999999996,19.999999999999996,18.999999999999993,17.999999999999993,16.999999999999993,16.000000000000004,15.000000000000002,14.000000000000002,13.0,12.0,10.999999999999998,9.999999999999998,8.999999999999996,7.9999999999999964,6.999999999999995,5.999999999999995,4.999999999999993,4.0000000000000036,3.0000000000000027,2.0000000000000018,1.0000000000000009,0.0],"hovertemplate":"Correlation = -63%<br>Stock: %{text:.0f}%<br>Bond: %{customdata:.0f}%<extra></extra>","mode":"lines","name":"Correlation = -63%","text":[0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.000000000000001,8.0,9.0,10.0,11.0,12.0,13.0,14.000000000000002,15.0,16.0,17.0,18.0,19.0,20.0,21.0,22.0,23.0,24.0,25.0,26.0,27.0,28.000000000000004,28.999999999999996,30.0,31.0,32.0,33.0,34.0,35.0,36.0,37.0,38.0,39.0,40.0,41.0,42.0,43.0,44.0,45.0,46.0,47.0,48.0,49.0,50.0,51.0,52.0,53.0,54.0,55.00000000000001,56.00000000000001,57.00000000000001,57.99999999999999,59.0,60.0,61.0,62.0,63.0,64.0,65.0,66.0,67.0,68.0,69.0,70.0,71.0,72.0,73.0,74.0,75.0,76.0,77.0,78.0,79.0,80.0,81.0,82.0,83.0,84.0,85.0,86.0,87.0,88.0,89.0,90.0,91.0,92.0,93.0,94.0,95.0,96.0,97.0,98.0,99.0,100.0],"x":[0.035,0.03342610506774608,0.031931457843324344,0.03052770053574294,0.029227931846095442,0.028046612986241316,0.026999296287125704,0.026102116772399896,0.025371007075005916,0.02482064664749893,0.024463237725207185,0.02430729314423965,0.02435668286117796,0.024610170661740646,0.025061564196992972,0.025700437739462723,0.026513241974530387,0.027484550205524556,0.028598216727621324,0.029838305917059032,0.031189741903388687,0.03263869635877022,0.03417276693509028,0.03578100753192956,0.03745386495410053,0.03918306394349477,0.04096146970019508,0.04278294636885122,0.044642222166912805,0.046534766572961336,0.048456681685810875,0.050404607924276125,0.0523756431941413,0.0543672741637835,0.056377318134157466,0.058403874015342506,0.060445281039962086,0.06250008399994356,0.06456700395712968,0.06664491353434258,0.06873281603426416,0.07082982775639088,0.07293516298740958,0.07504812122898213,0.07716807630101971,0.0792944670200891,0.0814267892035539,0.08356458879214329,0.08570745591837386,0.0878550197769029,0.09000694417654673,0.09216292367324291,0.09432268019940909,0.09648596011855819,0.09865253164516358,0.10082218257903369,0.10299471831118334,0.10516996006464967,0.10734774333911261,0.10952791653272693,0.11171033971839849,0.11389488355496923,0.11608142831650546,0.11826986302520182,0.12046008467538118,0.12265199753774905,0.12484551253449201,0.12704054667703535,0.12923702255932704,0.13143486790041675,0.133634015130879,0.13583440101829874,0.13803596632762058,0.14023865551266526,0.14244241643555475,0.14464720011116705,0.1468529604740742,0.14905965416570643,0.1512672403397378,0.1534756804839125,0.15568493825672414,0.15789497933753308,0.16010577128885767,0.1623172834297075,0.16452948671894652,0.166742353647776,0.16895585814052144,0.17116997546298826,0.17338468213772518,0.17559995586559807,0.1778157754531358,0.18003212074516037,0.18224897256226164,0.18446631264271535,0.18668412358848305,0.18890238881496443,0.19112109250420267,0.19334021956126976,0.19555975557358418,0.1977796867729343,0.2],"y":[0.035,0.03545,0.0359,0.03635,0.0368,0.03725,0.0377,0.038149999999999996,0.0386,0.03905,0.0395,0.03995,0.0404,0.04085,0.041299999999999996,0.041749999999999995,0.042199999999999994,0.042649999999999993,0.043100000000000006,0.043550000000000005,0.044000000000000004,0.04445,0.0449,0.04535,0.0458,0.04625,0.0467,0.04715,0.047599999999999996,0.048049999999999995,0.048499999999999995,0.048949999999999994,0.04939999999999999,0.04984999999999999,0.050300000000000004,0.05075,0.0512,0.05165,0.0521,0.05255,0.053,0.05345,0.0539,0.05435,0.0548,0.05525,0.0557,0.056150000000000005,0.056600000000000004,0.057050000000000003,0.0575,0.05795,0.0584,0.05885,0.0593,0.059750000000000004,0.060200000000000004,0.06065,0.061099999999999995,0.06155,0.062,0.06245,0.0629,0.06335,0.0638,0.06425,0.0647,0.06515,0.0656,0.06605,0.0665,0.06695000000000001,0.0674,0.06785000000000001,0.0683,0.06875,0.0692,0.06965,0.0701,0.07055,0.07100000000000001,0.07145,0.0719,0.07235,0.0728,0.07325,0.0737,0.07415,0.0746,0.07505,0.0755,0.07595,0.07640000000000001,0.07685,0.07730000000000001,0.07775,0.0782,0.07865,0.0791,0.07955,0.08],"type":"scatter"},{"customdata":[100.0,99.0,98.0,97.0,96.0,95.0,94.0,93.0,92.0,91.0,90.0,89.0,88.0,87.0,86.0,85.0,84.0,83.0,82.0,81.0,80.0,79.0,78.0,77.0,76.0,75.0,74.0,73.0,72.0,71.0,70.0,69.0,68.0,67.0,65.99999999999999,64.99999999999999,64.0,63.0,62.0,61.0,60.0,59.0,58.00000000000001,57.00000000000001,56.00000000000001,55.00000000000001,54.0,53.0,52.0,51.0,50.0,49.0,48.0,47.0,46.0,44.99999999999999,43.99999999999999,42.99999999999999,42.00000000000001,41.0,40.0,39.0,38.0,37.0,36.0,35.0,34.0,32.99999999999999,31.999999999999996,30.999999999999993,29.999999999999993,29.000000000000004,28.000000000000004,27.0,26.0,25.0,24.0,23.0,21.999999999999996,20.999999999999996,19.999999999999996,18.999999999999993,17.999999999999993,16.999999999999993,16.000000000000004,15.000000000000002,14.000000000000002,13.0,12.0,10.999999999999998,9.999999999999998,8.999999999999996,7.9999999999999964,6.999999999999995,5.999999999999995,4.999999999999993,4.0000000000000036,3.0000000000000027,2.0000000000000018,1.0000000000000009,0.0],"hovertemplate":"Correlation = 26%<br>Stock: %{text:.0f}%<br>Bond: %{customdata:.0f}%<extra></extra>","mode":"lines","name":"Correlation = 26%","text":[0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.000000000000001,8.0,9.0,10.0,11.0,12.0,13.0,14.000000000000002,15.0,16.0,17.0,18.0,19.0,20.0,21.0,22.0,23.0,24.0,25.0,26.0,27.0,28.000000000000004,28.999999999999996,30.0,31.0,32.0,33.0,34.0,35.0,36.0,37.0,38.0,39.0,40.0,41.0,42.0,43.0,44.0,45.0,46.0,47.0,48.0,49.0,50.0,51.0,52.0,53.0,54.0,55.00000000000001,56.00000000000001,57.00000000000001,57.99999999999999,59.0,60.0,61.0,62.0,63.0,64.0,65.0,66.0,67.0,68.0,69.0,70.0,71.0,72.0,73.0,74.0,75.0,76.0,77.0,78.0,79.0,80.0,81.0,82.0,83.0,84.0,85.0,86.0,87.0,88.0,89.0,90.0,91.0,92.0,93.0,94.0,95.0,96.0,97.0,98.0,99.0,100.0],"x":[0.035,0.03522298255400868,0.03555044303521406,0.03597952890186307,0.036506656927196166,0.03712765142047097,0.03783789106173863,0.03863245397331109,0.03950625266967243,0.04045415306244836,0.04147107425664303,0.04255206810485244,0.04369237919820801,0.044887487120577385,0.04613313342923933,0.04742533605574135,0.04876039376379153,0.05013488306558618,0.05154564967094702,0.05298979618756804,0.05446466744596905,0.05596783451233396,0.05749707818663483,0.05905037256444705,0.06062586906593587,0.0622218811994623,0.06383687022403275,0.06546943179835915,0.06711828364909223,0.06878225425209615,0.07046027249450573,0.07215135826857315,0.07385461393846697,0.07556921661629158,0.07729441118218057,0.0790295039842716,0.08077385715687965,0.0825268834986515,0.08428804185648163,0.08605683296519807,0.08783279569727927,0.08961550368100378,0.09140456224937572,0.09319960568586114,0.0950002947363849,0.0968063143601697,0.09861737169484897,0.10043319421386537,0.10225352805649299,0.10407813651291034,0.10590679864862311,0.10773930805421018,0.10957547170785988,0.11141510893949708,0.1132580504864886,0.1151041376319722,0.11695322141779595,0.11880516192489282,0.1206598276146622,0.12251709472559329,0.12437684671995829,0.12623897377593024,0.12810337232095023,0.1299699446025888,0.1318385982935195,0.13370924612755844,0.13558180556402102,0.13745619847791513,0.13933235087372928,0.14121019262078782,0.14308965720833913,0.14497068151871262,0.14685320561703785,0.14873717255615693,0.1506225281954861,0.1525092210326969,0.15439720204718738,0.1562864245544059,0.15817684407017357,0.16006841818422524,0.16196110644225667,0.1638548702358279,0.165749672699526,0.16764547861484366,0.16954225432027262,0.17143996762715513,0.17333858774087205,0.1752380851869821,0.17713843174195712,0.1790396003681867,0.18094156515295207,0.18284430125109177,0.18474778483110427,0.18665199302445182,0.18855690387784796,0.1904624963083284,0.19236875006091814,0.19427564566872502,0.19618316441529837,0.1980912882991072,0.2],"y":[0.035,0.03545,0.0359,0.03635,0.0368,0.03725,0.0377,0.038149999999999996,0.0386,0.03905,0.0395,0.03995,0.0404,0.04085,0.041299999999999996,0.041749999999999995,0.042199999999999994,0.042649999999999993,0.043100000000000006,0.043550000000000005,0.044000000000000004,0.04445,0.0449,0.04535,0.0458,0.04625,0.0467,0.04715,0.047599999999999996,0.048049999999999995,0.048499999999999995,0.048949999999999994,0.04939999999999999,0.04984999999999999,0.050300000000000004,0.05075,0.0512,0.05165,0.0521,0.05255,0.053,0.05345,0.0539,0.05435,0.0548,0.05525,0.0557,0.056150000000000005,0.056600000000000004,0.057050000000000003,0.0575,0.05795,0.0584,0.05885,0.0593,0.059750000000000004,0.060200000000000004,0.06065,0.061099999999999995,0.06155,0.062,0.06245,0.0629,0.06335,0.0638,0.06425,0.0647,0.06515,0.0656,0.06605,0.0665,0.06695000000000001,0.0674,0.06785000000000001,0.0683,0.06875,0.0692,0.06965,0.0701,0.07055,0.07100000000000001,0.07145,0.0719,0.07235,0.0728,0.07325,0.0737,0.07415,0.0746,0.07505,0.0755,0.07595,0.07640000000000001,0.07685,0.07730000000000001,0.07775,0.0782,0.07865,0.0791,0.07955,0.08],"type":"scatter"},{"hovertemplate":"%{text}<extra></extra>","marker":{"size":15},"mode":"markers","name":"Stock","text":["Stock"],"x":[0.2],"y":[0.08],"type":"scatter"},{"hovertemplate":"%{text}<extra></extra>","marker":{"size":15},"mode":"markers","name":"Bond","text":["Bond"],"x":[0.035],"y":[0.035],"type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"title":{"text":"Standard Deviation"},"range":[0,0.25],"tickformat":".0%"},"yaxis":{"title":{"text":"Expected Return"},"range":[0,0.1],"tickformat":".0%"}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('3d75eccd-d2fb-4ab4-b22e-9046a31508ea');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
<p></p><figcaption class="figure-caption">Figure 4.6: Portfolios of two risky assets</figcaption><p></p>
</figure>
</div>
</div>
</section>
<section id="sec-multiple-cals" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="sec-multiple-cals"><span class="header-section-number">4.5</span> Allocating Capital Between Two Risky Assets and a Risk-free Asset</h2>
<p>We’ve now seen how to combine two risky assets as well as a risky asset with a risk-free asset. What if we can invest in two risky assets <em>and</em> the risk-free asset? What is the best way to form a portfolio in this case? We’ll proceed with our stock and bond fund example (assuming a -5% correlation).</p>
<p>First, let’s consider the investment opportunity sets that would obtain if we restricted attention to investing in only a single risky fund, along with the risk-free asset. We assume for the moment that we can both borrow and save at a single risk-free rate. The possible portfolios are the capital allocation lines for the stock fund and the bond fund, respectively. These are plotted as the orange and red lines in <a href="#fig-two-asset-plus_rf">Figure&nbsp;<span>4.7</span></a>. We can see immediately that all portfolios on the CAL for the stock fund are dominated by both the stock-bond frontier (the black line) and by the bond CAL. The same expected return can be achieved for smaller standard deviation.</p>
<p>Recall from <a href="#eq-cal">Equation&nbsp;<span>4.6</span></a> that the slope of the CAL for a risky asset is the Sharpe ratio. The Sharpe ratio is a measure of the excess return of an investment per unit of risk. Since investors like expected returns and dislike risk, they want high Sharpe ratios. Note in <a href="#fig-two-asset-plus_rf">Figure&nbsp;<span>4.7</span></a> that the Sharpe ratio of the bond is higher than that of the stock portfolio. In fact, the Sharpe ratio for all portfolios on the frontier have higher Sharpe ratios than that of the stock portfolio. The highest Sharpe ratio is obtained by combining the risk-free asset with a risky portfolio so that the CAL slope is as high as possible. This occurs when the CAL is tangent to the curve of risky-only portfolios. This portfolio of risky assets is thus called the tangency portfolio. Investing along the CAL of the tangency portfolio offers the highest possible Sharpe ratio, regardless of any desired level of expected return or risk.</p>
<div class="cell" data-execution_count="8">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.graph_objects <span class="im">as</span> go</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>mn_stock <span class="op">=</span> <span class="dv">8</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>mn_bond  <span class="op">=</span> <span class="fl">3.5</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>sd_stock <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>sd_bond  <span class="op">=</span> <span class="fl">3.5</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>corr <span class="op">=</span> <span class="op">-</span><span class="dv">5</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>rs <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>extra <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> data(mn1, mn2, sd1, sd2, c, rs, extra):</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    c <span class="op">=</span> c <span class="op">/</span> <span class="dv">100</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    rb <span class="op">=</span> rs <span class="op">+</span> extra   </span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>    rs <span class="op">=</span> rs<span class="op">/</span><span class="dv">100</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>    rb <span class="op">=</span> rb<span class="op">/</span><span class="dv">100</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>    mns <span class="op">=</span> [mn1, mn2]</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>    sds <span class="op">=</span> [sd1, sd2]</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>    grid <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">101</span>)</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>    ports <span class="op">=</span> [np.array([w, <span class="dv">1</span> <span class="op">-</span> w]) <span class="cf">for</span> w <span class="kw">in</span> grid]</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>    means <span class="op">=</span> [p.T <span class="op">@</span> np.array(mns) <span class="cf">for</span> p <span class="kw">in</span> ports]</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> pd.DataFrame(means)</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>    df.columns <span class="op">=</span> [<span class="st">"mean"</span>]</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>    cov <span class="op">=</span> np.array(</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>        [[sds[<span class="dv">0</span>] <span class="op">**</span> <span class="dv">2</span>, sds[<span class="dv">0</span>] <span class="op">*</span> sds[<span class="dv">1</span>] <span class="op">*</span> c], [sds[<span class="dv">0</span>] <span class="op">*</span> sds[<span class="dv">1</span>] <span class="op">*</span> c, sds[<span class="dv">1</span>] <span class="op">**</span> <span class="dv">2</span>]]</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>    ).reshape(<span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">"stdev"</span>] <span class="op">=</span> [np.sqrt(p.T <span class="op">@</span> cov <span class="op">@</span> p) <span class="cf">for</span> p <span class="kw">in</span> ports]</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">"wt1"</span>] <span class="op">=</span> grid</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">"wt2"</span>] <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> df.wt1</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col <span class="kw">in</span> [<span class="st">"mean"</span>, <span class="st">"stdev"</span>]:</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>        df[col] <span class="op">=</span> df[col] <span class="op">/</span> <span class="dv">100</span></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">"sr_s"</span>]<span class="op">=</span> (df[<span class="st">"mean"</span>] <span class="op">-</span> rs)<span class="op">/</span>df[<span class="st">"stdev"</span>]</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">"sr_b"</span>]<span class="op">=</span> (df[<span class="st">"mean"</span>] <span class="op">-</span> rb)<span class="op">/</span>df[<span class="st">"stdev"</span>]</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> rf_plus_risky(mn, sd, rs, rb, w_min, w_max):</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>    mn <span class="op">/=</span> <span class="dv">100</span></span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>    sd <span class="op">/=</span> <span class="dv">100</span></span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>    rs <span class="op">/=</span> <span class="dv">100</span></span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>    rb <span class="op">/=</span> <span class="dv">100</span></span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>    grid <span class="op">=</span> np.linspace(w_min, w_max, <span class="dv">201</span>)</span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>    mns <span class="op">=</span> [(rs <span class="op">+</span> w <span class="op">*</span> (mn <span class="op">-</span> rs) <span class="cf">if</span> w <span class="op">&lt;=</span> <span class="dv">1</span> <span class="cf">else</span> rb <span class="op">+</span> w <span class="op">*</span> (mn <span class="op">-</span> rb)) <span class="cf">for</span> w <span class="kw">in</span> grid]</span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>    sds <span class="op">=</span> [w <span class="op">*</span> sd <span class="cf">for</span> w <span class="kw">in</span> grid]</span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>    srs <span class="op">=</span> (mn <span class="op">-</span> rs)<span class="op">/</span>sd</span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>    srb <span class="op">=</span> (mn <span class="op">-</span> rb)<span class="op">/</span>sd</span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> grid, mns, sds, srs, srb</span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> rf_plus_risky_nokink(mn, sd, rf, w_min, w_max):</span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a>    mn <span class="op">/=</span> <span class="dv">100</span></span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a>    sd <span class="op">/=</span> <span class="dv">100</span></span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a>    rf <span class="op">/=</span> <span class="dv">100</span></span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a>    grid <span class="op">=</span> np.linspace(w_min, w_max, <span class="dv">201</span>)</span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a>    mns <span class="op">=</span> [(rf <span class="op">+</span> w <span class="op">*</span> (mn <span class="op">-</span> rf)) <span class="cf">for</span> w <span class="kw">in</span> grid]</span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a>    sds <span class="op">=</span> [w <span class="op">*</span> sd <span class="cf">for</span> w <span class="kw">in</span> grid]</span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> grid, mns, sds</span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-60"><a href="#cb7-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-61"><a href="#cb7-61" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> figtbl(mn1, mn2, sd1, sd2, c, rs, extra, asset1_name, asset2_name):</span>
<span id="cb7-62"><a href="#cb7-62" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> data(mn1, mn2, sd1, sd2, c, rs, extra)</span>
<span id="cb7-63"><a href="#cb7-63" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-64"><a href="#cb7-64" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Plot the portfolios of the two assets</span></span>
<span id="cb7-65"><a href="#cb7-65" aria-hidden="true" tabindex="-1"></a>    trace1 <span class="op">=</span> go.Scatter(</span>
<span id="cb7-66"><a href="#cb7-66" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span>df[<span class="st">"stdev"</span>],</span>
<span id="cb7-67"><a href="#cb7-67" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span>df[<span class="st">"mean"</span>],</span>
<span id="cb7-68"><a href="#cb7-68" aria-hidden="true" tabindex="-1"></a>        mode<span class="op">=</span><span class="st">"lines"</span>,</span>
<span id="cb7-69"><a href="#cb7-69" aria-hidden="true" tabindex="-1"></a>        <span class="co"># line={'color': green},</span></span>
<span id="cb7-70"><a href="#cb7-70" aria-hidden="true" tabindex="-1"></a>        text<span class="op">=</span><span class="dv">100</span> <span class="op">*</span> df[<span class="st">"wt1"</span>],</span>
<span id="cb7-71"><a href="#cb7-71" aria-hidden="true" tabindex="-1"></a>        customdata<span class="op">=</span><span class="dv">100</span> <span class="op">*</span> df[<span class="st">"wt2"</span>],</span>
<span id="cb7-72"><a href="#cb7-72" aria-hidden="true" tabindex="-1"></a>        hovertemplate<span class="op">=</span>asset1_name<span class="op">+</span><span class="st">": %</span><span class="sc">{text:.0f}</span><span class="st">%&lt;br&gt;"</span><span class="op">+</span>asset2_name<span class="op">+</span><span class="st">": %</span><span class="sc">{customdata:.0f}</span><span class="st">%&lt;extra&gt;&lt;/extra&gt;"</span>,</span>
<span id="cb7-73"><a href="#cb7-73" aria-hidden="true" tabindex="-1"></a>        line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">"black"</span>),</span>
<span id="cb7-74"><a href="#cb7-74" aria-hidden="true" tabindex="-1"></a>        name<span class="op">=</span><span class="st">"Stock &amp; Bond Frontier"</span></span>
<span id="cb7-75"><a href="#cb7-75" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb7-76"><a href="#cb7-76" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-77"><a href="#cb7-77" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot the two assets</span></span>
<span id="cb7-78"><a href="#cb7-78" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> df[df.wt1.isin([<span class="dv">0</span>, <span class="dv">1</span>])]</span>
<span id="cb7-79"><a href="#cb7-79" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">"text"</span>] <span class="op">=</span> np.where(df.wt1 <span class="op">==</span> <span class="dv">1</span>, asset1_name, asset2_name)</span>
<span id="cb7-80"><a href="#cb7-80" aria-hidden="true" tabindex="-1"></a>    trace2a <span class="op">=</span> go.Scatter(</span>
<span id="cb7-81"><a href="#cb7-81" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span>df[df.wt1<span class="op">==</span><span class="dv">1</span>][<span class="st">"stdev"</span>],</span>
<span id="cb7-82"><a href="#cb7-82" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span>df[df.wt1<span class="op">==</span><span class="dv">1</span>][<span class="st">"mean"</span>],</span>
<span id="cb7-83"><a href="#cb7-83" aria-hidden="true" tabindex="-1"></a>        mode<span class="op">=</span><span class="st">"markers"</span>,</span>
<span id="cb7-84"><a href="#cb7-84" aria-hidden="true" tabindex="-1"></a>        text<span class="op">=</span>df[df.wt1<span class="op">==</span><span class="dv">1</span>][<span class="st">"text"</span>],</span>
<span id="cb7-85"><a href="#cb7-85" aria-hidden="true" tabindex="-1"></a>        hovertemplate<span class="op">=</span><span class="st">"%</span><span class="sc">{text}</span><span class="st">&lt;extra&gt;&lt;/extra&gt;"</span>,</span>
<span id="cb7-86"><a href="#cb7-86" aria-hidden="true" tabindex="-1"></a>        marker<span class="op">=</span><span class="bu">dict</span>(size<span class="op">=</span><span class="dv">10</span>, color<span class="op">=</span><span class="st">"orange"</span>),</span>
<span id="cb7-87"><a href="#cb7-87" aria-hidden="true" tabindex="-1"></a>        name<span class="op">=</span>asset1_name</span>
<span id="cb7-88"><a href="#cb7-88" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb7-89"><a href="#cb7-89" aria-hidden="true" tabindex="-1"></a>    trace2b <span class="op">=</span> go.Scatter(</span>
<span id="cb7-90"><a href="#cb7-90" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span>df[df.wt1<span class="op">==</span><span class="dv">0</span>][<span class="st">"stdev"</span>],</span>
<span id="cb7-91"><a href="#cb7-91" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span>df[df.wt1<span class="op">==</span><span class="dv">0</span>][<span class="st">"mean"</span>],</span>
<span id="cb7-92"><a href="#cb7-92" aria-hidden="true" tabindex="-1"></a>        mode<span class="op">=</span><span class="st">"markers"</span>,</span>
<span id="cb7-93"><a href="#cb7-93" aria-hidden="true" tabindex="-1"></a>        text<span class="op">=</span>df[df.wt1<span class="op">==</span><span class="dv">0</span>][<span class="st">"text"</span>],</span>
<span id="cb7-94"><a href="#cb7-94" aria-hidden="true" tabindex="-1"></a>        hovertemplate<span class="op">=</span><span class="st">"%</span><span class="sc">{text}</span><span class="st">&lt;extra&gt;&lt;/extra&gt;"</span>,</span>
<span id="cb7-95"><a href="#cb7-95" aria-hidden="true" tabindex="-1"></a>        marker<span class="op">=</span><span class="bu">dict</span>(size<span class="op">=</span><span class="dv">10</span>, color<span class="op">=</span><span class="st">"red"</span>),</span>
<span id="cb7-96"><a href="#cb7-96" aria-hidden="true" tabindex="-1"></a>        name<span class="op">=</span>asset2_name</span>
<span id="cb7-97"><a href="#cb7-97" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb7-98"><a href="#cb7-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-99"><a href="#cb7-99" aria-hidden="true" tabindex="-1"></a>    fig <span class="op">=</span> go.Figure()</span>
<span id="cb7-100"><a href="#cb7-100" aria-hidden="true" tabindex="-1"></a>    fig.add_trace(trace2a)</span>
<span id="cb7-101"><a href="#cb7-101" aria-hidden="true" tabindex="-1"></a>    fig.add_trace(trace2b)</span>
<span id="cb7-102"><a href="#cb7-102" aria-hidden="true" tabindex="-1"></a>    fig.add_trace(trace1)</span>
<span id="cb7-103"><a href="#cb7-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-104"><a href="#cb7-104" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot the combination of the risk-free and each asset (CAL for each asset)</span></span>
<span id="cb7-105"><a href="#cb7-105" aria-hidden="true" tabindex="-1"></a>    grid, mns_cal, sds_cal, srs_cal, srb_cal <span class="op">=</span> rf_plus_risky(mn1, sd1, rs, rs <span class="op">+</span> extra, <span class="dv">0</span>, <span class="fl">1.0</span>)</span>
<span id="cb7-106"><a href="#cb7-106" aria-hidden="true" tabindex="-1"></a>    string <span class="op">=</span> <span class="st">"wealth in "</span><span class="op">+</span>asset1_name<span class="op">+</span><span class="st">"= %</span><span class="sc">{text:.0f}</span><span class="st">%&lt;br&gt;"</span> <span class="op">+</span> <span class="st">"Sharpe ratio: "</span> <span class="op">+</span> <span class="st">"</span><span class="sc">{:.4f}</span><span class="st">"</span>.<span class="bu">format</span>(srs_cal) <span class="op">+</span><span class="st">"&lt;extra&gt;&lt;/extra&gt;"</span></span>
<span id="cb7-107"><a href="#cb7-107" aria-hidden="true" tabindex="-1"></a>    trace3 <span class="op">=</span> go.Scatter(</span>
<span id="cb7-108"><a href="#cb7-108" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span>sds_cal, </span>
<span id="cb7-109"><a href="#cb7-109" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span>mns_cal, </span>
<span id="cb7-110"><a href="#cb7-110" aria-hidden="true" tabindex="-1"></a>        mode<span class="op">=</span><span class="st">"lines"</span>, </span>
<span id="cb7-111"><a href="#cb7-111" aria-hidden="true" tabindex="-1"></a>        text<span class="op">=</span><span class="dv">100</span> <span class="op">*</span> grid, </span>
<span id="cb7-112"><a href="#cb7-112" aria-hidden="true" tabindex="-1"></a>        hovertemplate<span class="op">=</span>string, </span>
<span id="cb7-113"><a href="#cb7-113" aria-hidden="true" tabindex="-1"></a>        line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">"orange"</span>),</span>
<span id="cb7-114"><a href="#cb7-114" aria-hidden="true" tabindex="-1"></a>        name<span class="op">=</span><span class="st">"CAL: "</span><span class="op">+</span>asset1_name</span>
<span id="cb7-115"><a href="#cb7-115" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb7-116"><a href="#cb7-116" aria-hidden="true" tabindex="-1"></a>    grid, mns_cal, sds_cal, srs_cal, srb_cal <span class="op">=</span> rf_plus_risky(mn2, sd2, rs, rs <span class="op">+</span> extra, <span class="dv">0</span>, <span class="fl">4.0</span>)</span>
<span id="cb7-117"><a href="#cb7-117" aria-hidden="true" tabindex="-1"></a>    string <span class="op">=</span> <span class="st">"wealth in "</span><span class="op">+</span>asset2_name<span class="op">+</span><span class="st">"= %</span><span class="sc">{text:.0f}</span><span class="st">%&lt;br&gt;"</span> <span class="op">+</span> <span class="st">"Sharpe ratio : "</span> <span class="op">+</span> <span class="st">"</span><span class="sc">{:.4f}</span><span class="st">"</span>.<span class="bu">format</span>(srs_cal) <span class="op">+</span><span class="st">"&lt;extra&gt;&lt;/extra&gt;"</span></span>
<span id="cb7-118"><a href="#cb7-118" aria-hidden="true" tabindex="-1"></a>    trace4 <span class="op">=</span> go.Scatter(</span>
<span id="cb7-119"><a href="#cb7-119" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span>sds_cal, </span>
<span id="cb7-120"><a href="#cb7-120" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span>mns_cal, </span>
<span id="cb7-121"><a href="#cb7-121" aria-hidden="true" tabindex="-1"></a>        mode<span class="op">=</span><span class="st">"lines"</span>, </span>
<span id="cb7-122"><a href="#cb7-122" aria-hidden="true" tabindex="-1"></a>        text<span class="op">=</span><span class="dv">100</span> <span class="op">*</span> grid, </span>
<span id="cb7-123"><a href="#cb7-123" aria-hidden="true" tabindex="-1"></a>        hovertemplate<span class="op">=</span>string, </span>
<span id="cb7-124"><a href="#cb7-124" aria-hidden="true" tabindex="-1"></a>        line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">"red"</span>),</span>
<span id="cb7-125"><a href="#cb7-125" aria-hidden="true" tabindex="-1"></a>        name<span class="op">=</span><span class="st">"CAL: "</span><span class="op">+</span>asset2_name</span>
<span id="cb7-126"><a href="#cb7-126" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb7-127"><a href="#cb7-127" aria-hidden="true" tabindex="-1"></a>    fig.add_trace(trace3)</span>
<span id="cb7-128"><a href="#cb7-128" aria-hidden="true" tabindex="-1"></a>    fig.add_trace(trace4)  </span>
<span id="cb7-129"><a href="#cb7-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-130"><a href="#cb7-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-131"><a href="#cb7-131" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> custom(string, ports,srTang,borrow_flag):</span>
<span id="cb7-132"><a href="#cb7-132" aria-hidden="true" tabindex="-1"></a>        <span class="co"># borrow_flag=1 adds statement about "relative to borrowing rate"</span></span>
<span id="cb7-133"><a href="#cb7-133" aria-hidden="true" tabindex="-1"></a>        cd <span class="op">=</span> np.empty(shape<span class="op">=</span>(<span class="bu">len</span>(ports), N<span class="op">+</span><span class="dv">1</span>, <span class="dv">1</span>), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb7-134"><a href="#cb7-134" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(N):</span>
<span id="cb7-135"><a href="#cb7-135" aria-hidden="true" tabindex="-1"></a>            cd[:, i] <span class="op">=</span> np.array([w[i] <span class="cf">for</span> w <span class="kw">in</span> ports]).reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb7-136"><a href="#cb7-136" aria-hidden="true" tabindex="-1"></a>        cd[:,N] <span class="op">=</span> np.<span class="bu">round</span>(srTang,<span class="dv">4</span>)</span>
<span id="cb7-137"><a href="#cb7-137" aria-hidden="true" tabindex="-1"></a>        <span class="co"># print(cd)</span></span>
<span id="cb7-138"><a href="#cb7-138" aria-hidden="true" tabindex="-1"></a>        string <span class="op">+=</span> <span class="st">"&lt;br&gt;"</span></span>
<span id="cb7-139"><a href="#cb7-139" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(N):</span>
<span id="cb7-140"><a href="#cb7-140" aria-hidden="true" tabindex="-1"></a>            string <span class="op">+=</span> <span class="st">"asset "</span> <span class="op">+</span> <span class="bu">str</span>(i <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb7-141"><a href="#cb7-141" aria-hidden="true" tabindex="-1"></a>            string <span class="op">+=</span> <span class="st">": %{customdata["</span></span>
<span id="cb7-142"><a href="#cb7-142" aria-hidden="true" tabindex="-1"></a>            string <span class="op">+=</span> <span class="bu">str</span>(i)</span>
<span id="cb7-143"><a href="#cb7-143" aria-hidden="true" tabindex="-1"></a>            string <span class="op">+=</span> <span class="st">"]:.1%}&lt;br&gt;"</span></span>
<span id="cb7-144"><a href="#cb7-144" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> borrow_flag<span class="op">==</span><span class="dv">1</span>:</span>
<span id="cb7-145"><a href="#cb7-145" aria-hidden="true" tabindex="-1"></a>            string <span class="op">+=</span> <span class="st">"Sharpe ratio (relative to borrowing rate): %{customdata["</span> <span class="op">+</span>  <span class="bu">str</span>(N) <span class="op">+</span> <span class="st">"]:.4f}&lt;br&gt;"</span>    </span>
<span id="cb7-146"><a href="#cb7-146" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb7-147"><a href="#cb7-147" aria-hidden="true" tabindex="-1"></a>            string <span class="op">+=</span> <span class="st">"Sharpe ratio: %{customdata["</span> <span class="op">+</span>  <span class="bu">str</span>(N) <span class="op">+</span> <span class="st">"]:.4f}&lt;br&gt;"</span></span>
<span id="cb7-148"><a href="#cb7-148" aria-hidden="true" tabindex="-1"></a>        string <span class="op">+=</span> <span class="st">"&lt;extra&gt;&lt;/extra&gt;"</span></span>
<span id="cb7-149"><a href="#cb7-149" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> string, cd  </span>
<span id="cb7-150"><a href="#cb7-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-151"><a href="#cb7-151" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot the tangency portfolios</span></span>
<span id="cb7-152"><a href="#cb7-152" aria-hidden="true" tabindex="-1"></a>    c <span class="op">=</span> c <span class="op">/</span> <span class="dv">100</span></span>
<span id="cb7-153"><a href="#cb7-153" aria-hidden="true" tabindex="-1"></a>    rb <span class="op">=</span> rs <span class="op">+</span> extra     </span>
<span id="cb7-154"><a href="#cb7-154" aria-hidden="true" tabindex="-1"></a>    rs <span class="op">=</span> rs<span class="op">/</span><span class="dv">100</span></span>
<span id="cb7-155"><a href="#cb7-155" aria-hidden="true" tabindex="-1"></a>    rb <span class="op">=</span> rb<span class="op">/</span><span class="dv">100</span></span>
<span id="cb7-156"><a href="#cb7-156" aria-hidden="true" tabindex="-1"></a>    mns <span class="op">=</span> [mn1, mn2]</span>
<span id="cb7-157"><a href="#cb7-157" aria-hidden="true" tabindex="-1"></a>    mns <span class="op">=</span> np.array(mns) <span class="op">/</span> <span class="dv">100</span></span>
<span id="cb7-158"><a href="#cb7-158" aria-hidden="true" tabindex="-1"></a>    sds <span class="op">=</span> [sd1, sd2]</span>
<span id="cb7-159"><a href="#cb7-159" aria-hidden="true" tabindex="-1"></a>    sds <span class="op">=</span> np.array(sds) <span class="op">/</span> <span class="dv">100</span></span>
<span id="cb7-160"><a href="#cb7-160" aria-hidden="true" tabindex="-1"></a>    cov <span class="op">=</span> np.array(</span>
<span id="cb7-161"><a href="#cb7-161" aria-hidden="true" tabindex="-1"></a>        [[sds[<span class="dv">0</span>] <span class="op">**</span> <span class="dv">2</span>, sds[<span class="dv">0</span>] <span class="op">*</span> sds[<span class="dv">1</span>] <span class="op">*</span> c], [sds[<span class="dv">0</span>] <span class="op">*</span> sds[<span class="dv">1</span>] <span class="op">*</span> c, sds[<span class="dv">1</span>] <span class="op">**</span> <span class="dv">2</span>]]</span>
<span id="cb7-162"><a href="#cb7-162" aria-hidden="true" tabindex="-1"></a>    ).reshape(<span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb7-163"><a href="#cb7-163" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-164"><a href="#cb7-164" aria-hidden="true" tabindex="-1"></a>    Shorts <span class="op">=</span> <span class="fl">0.0</span>     </span>
<span id="cb7-165"><a href="#cb7-165" aria-hidden="true" tabindex="-1"></a>    N <span class="op">=</span> <span class="bu">len</span>(mns)</span>
<span id="cb7-166"><a href="#cb7-166" aria-hidden="true" tabindex="-1"></a>    P <span class="op">=</span> portfolio(mns, cov, Shorts)    </span>
<span id="cb7-167"><a href="#cb7-167" aria-hidden="true" tabindex="-1"></a>    gmv <span class="op">=</span> P.GMV <span class="op">@</span> mns</span>
<span id="cb7-168"><a href="#cb7-168" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print('GMV return is: ',gmv)</span></span>
<span id="cb7-169"><a href="#cb7-169" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (rs <span class="op">&lt;</span> gmv) <span class="kw">or</span> (<span class="kw">not</span> Shorts):</span>
<span id="cb7-170"><a href="#cb7-170" aria-hidden="true" tabindex="-1"></a>        portTang <span class="op">=</span> P.tangency(rs)</span>
<span id="cb7-171"><a href="#cb7-171" aria-hidden="true" tabindex="-1"></a>        mnTang <span class="op">=</span> portTang <span class="op">@</span> mns</span>
<span id="cb7-172"><a href="#cb7-172" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> mnTang <span class="op">&lt;</span> np.<span class="bu">max</span>(mns):</span>
<span id="cb7-173"><a href="#cb7-173" aria-hidden="true" tabindex="-1"></a>            sdTang <span class="op">=</span> np.sqrt(portTang <span class="op">@</span> cov <span class="op">@</span> portTang)</span>
<span id="cb7-174"><a href="#cb7-174" aria-hidden="true" tabindex="-1"></a>            srTang <span class="op">=</span> (mnTang <span class="op">-</span> rs)<span class="op">/</span>sdTang</span>
<span id="cb7-175"><a href="#cb7-175" aria-hidden="true" tabindex="-1"></a>            string0 <span class="op">=</span> <span class="st">'tangency portfolio'</span> <span class="cf">if</span> rb <span class="op">==</span> rs <span class="cf">else</span> <span class="st">'efficient low risk portfolio'</span> <span class="cf">if</span> rb <span class="op">!=</span> rs <span class="cf">else</span> <span class="st">'tangency portfolio'</span></span>
<span id="cb7-176"><a href="#cb7-176" aria-hidden="true" tabindex="-1"></a>            string, cd <span class="op">=</span> custom(string0, [portTang], srTang,<span class="dv">0</span>)</span>
<span id="cb7-177"><a href="#cb7-177" aria-hidden="true" tabindex="-1"></a>            trace <span class="op">=</span> go.Scatter(</span>
<span id="cb7-178"><a href="#cb7-178" aria-hidden="true" tabindex="-1"></a>                x<span class="op">=</span>[sdTang],</span>
<span id="cb7-179"><a href="#cb7-179" aria-hidden="true" tabindex="-1"></a>                y<span class="op">=</span>[mnTang],</span>
<span id="cb7-180"><a href="#cb7-180" aria-hidden="true" tabindex="-1"></a>                mode<span class="op">=</span><span class="st">"markers"</span>,</span>
<span id="cb7-181"><a href="#cb7-181" aria-hidden="true" tabindex="-1"></a>                customdata<span class="op">=</span>cd,</span>
<span id="cb7-182"><a href="#cb7-182" aria-hidden="true" tabindex="-1"></a>                hovertemplate<span class="op">=</span>string,</span>
<span id="cb7-183"><a href="#cb7-183" aria-hidden="true" tabindex="-1"></a>                marker<span class="op">=</span><span class="bu">dict</span>(size<span class="op">=</span><span class="dv">10</span>, color<span class="op">=</span><span class="st">"blue"</span>),</span>
<span id="cb7-184"><a href="#cb7-184" aria-hidden="true" tabindex="-1"></a>                name<span class="op">=</span>string0</span>
<span id="cb7-185"><a href="#cb7-185" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb7-186"><a href="#cb7-186" aria-hidden="true" tabindex="-1"></a>            fig.add_trace(trace)</span>
<span id="cb7-187"><a href="#cb7-187" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb7-188"><a href="#cb7-188" aria-hidden="true" tabindex="-1"></a>            <span class="co">#Plot CAL (no leverage)</span></span>
<span id="cb7-189"><a href="#cb7-189" aria-hidden="true" tabindex="-1"></a>            grid, mns_cal, sds_cal <span class="op">=</span> rf_plus_risky_nokink(mnTang<span class="op">*</span><span class="dv">100</span>, sdTang<span class="op">*</span><span class="dv">100</span>, rs<span class="op">*</span><span class="dv">100</span>,<span class="dv">0</span>, <span class="fl">3.0</span>)</span>
<span id="cb7-190"><a href="#cb7-190" aria-hidden="true" tabindex="-1"></a>            portlabel <span class="op">=</span> <span class="st">'tangency portfolio'</span> <span class="cf">if</span> rb <span class="op">==</span> rs <span class="cf">else</span> <span class="st">'efficient low risk portfolio'</span> <span class="cf">if</span> rb <span class="op">!=</span> rs <span class="cf">else</span> <span class="st">'tangency portfolio'</span></span>
<span id="cb7-191"><a href="#cb7-191" aria-hidden="true" tabindex="-1"></a>            string <span class="op">=</span> <span class="st">"wealth in "</span><span class="op">+</span>portlabel <span class="op">+</span> <span class="st">" = %</span><span class="sc">{text:.0f}</span><span class="st">%&lt;br&gt;"</span> <span class="op">+</span> <span class="st">"Sharpe ratio: "</span> <span class="op">+</span>  <span class="st">"</span><span class="sc">{:.4f}</span><span class="st">"</span>.<span class="bu">format</span>(srTang) <span class="op">+</span><span class="st">"&lt;extra&gt;&lt;/extra&gt;"</span></span>
<span id="cb7-192"><a href="#cb7-192" aria-hidden="true" tabindex="-1"></a>            trace5 <span class="op">=</span> go.Scatter(</span>
<span id="cb7-193"><a href="#cb7-193" aria-hidden="true" tabindex="-1"></a>                x<span class="op">=</span>sds_cal, </span>
<span id="cb7-194"><a href="#cb7-194" aria-hidden="true" tabindex="-1"></a>                y<span class="op">=</span>mns_cal, </span>
<span id="cb7-195"><a href="#cb7-195" aria-hidden="true" tabindex="-1"></a>                mode<span class="op">=</span><span class="st">"lines"</span>, </span>
<span id="cb7-196"><a href="#cb7-196" aria-hidden="true" tabindex="-1"></a>                text<span class="op">=</span><span class="dv">100</span> <span class="op">*</span> grid, </span>
<span id="cb7-197"><a href="#cb7-197" aria-hidden="true" tabindex="-1"></a>                hovertemplate<span class="op">=</span>string, </span>
<span id="cb7-198"><a href="#cb7-198" aria-hidden="true" tabindex="-1"></a>                line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">"blue"</span>),</span>
<span id="cb7-199"><a href="#cb7-199" aria-hidden="true" tabindex="-1"></a>                name<span class="op">=</span><span class="st">"CAL: "</span> <span class="op">+</span> portlabel</span>
<span id="cb7-200"><a href="#cb7-200" aria-hidden="true" tabindex="-1"></a>            )           </span>
<span id="cb7-201"><a href="#cb7-201" aria-hidden="true" tabindex="-1"></a>            fig.add_trace(trace5)</span>
<span id="cb7-202"><a href="#cb7-202" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb7-203"><a href="#cb7-203" aria-hidden="true" tabindex="-1"></a>            <span class="co">#Plot CAL (with leverage)</span></span>
<span id="cb7-204"><a href="#cb7-204" aria-hidden="true" tabindex="-1"></a>            grid, mns_cal, sds_cal <span class="op">=</span> rf_plus_risky_nokink(mnTang<span class="op">*</span><span class="dv">100</span>, sdTang<span class="op">*</span><span class="dv">100</span>, rs<span class="op">*</span><span class="dv">100</span>,<span class="fl">1.0</span>, <span class="fl">2.5</span>)</span>
<span id="cb7-205"><a href="#cb7-205" aria-hidden="true" tabindex="-1"></a>            trace5a <span class="op">=</span> go.Scatter(</span>
<span id="cb7-206"><a href="#cb7-206" aria-hidden="true" tabindex="-1"></a>                x<span class="op">=</span>sds_cal, </span>
<span id="cb7-207"><a href="#cb7-207" aria-hidden="true" tabindex="-1"></a>                y<span class="op">=</span>mns_cal, </span>
<span id="cb7-208"><a href="#cb7-208" aria-hidden="true" tabindex="-1"></a>                mode<span class="op">=</span><span class="st">"lines"</span>, </span>
<span id="cb7-209"><a href="#cb7-209" aria-hidden="true" tabindex="-1"></a>                text<span class="op">=</span><span class="dv">100</span> <span class="op">*</span> grid, </span>
<span id="cb7-210"><a href="#cb7-210" aria-hidden="true" tabindex="-1"></a>                hovertemplate<span class="op">=</span>string, </span>
<span id="cb7-211"><a href="#cb7-211" aria-hidden="true" tabindex="-1"></a>                line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">"blue"</span>,dash<span class="op">=</span><span class="st">'dot'</span>),</span>
<span id="cb7-212"><a href="#cb7-212" aria-hidden="true" tabindex="-1"></a>                name<span class="op">=</span><span class="st">"CAL: "</span>  <span class="op">+</span> portlabel <span class="op">+</span> <span class="st">" (levered)"</span></span>
<span id="cb7-213"><a href="#cb7-213" aria-hidden="true" tabindex="-1"></a>                <span class="co"># showlegend=False</span></span>
<span id="cb7-214"><a href="#cb7-214" aria-hidden="true" tabindex="-1"></a>            )           </span>
<span id="cb7-215"><a href="#cb7-215" aria-hidden="true" tabindex="-1"></a>            <span class="co"># fig.add_trace(trace5a)           </span></span>
<span id="cb7-216"><a href="#cb7-216" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb7-217"><a href="#cb7-217" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb7-218"><a href="#cb7-218" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb7-219"><a href="#cb7-219" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb7-220"><a href="#cb7-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-221"><a href="#cb7-221" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (rb <span class="op">!=</span> rs) <span class="kw">and</span> ((gmv <span class="op">&gt;</span> rb) <span class="kw">or</span> (<span class="kw">not</span> Shorts)):</span>
<span id="cb7-222"><a href="#cb7-222" aria-hidden="true" tabindex="-1"></a>        portTang <span class="op">=</span> P.tangency(rb)</span>
<span id="cb7-223"><a href="#cb7-223" aria-hidden="true" tabindex="-1"></a>        mnTang <span class="op">=</span> portTang <span class="op">@</span> mns</span>
<span id="cb7-224"><a href="#cb7-224" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> mnTang <span class="op">&lt;</span> np.<span class="bu">max</span>(mns):</span>
<span id="cb7-225"><a href="#cb7-225" aria-hidden="true" tabindex="-1"></a>            sdTang <span class="op">=</span> np.sqrt(portTang <span class="op">@</span> cov <span class="op">@</span> portTang)</span>
<span id="cb7-226"><a href="#cb7-226" aria-hidden="true" tabindex="-1"></a>            srTang <span class="op">=</span> (mnTang <span class="op">-</span> rb)<span class="op">/</span>sdTang</span>
<span id="cb7-227"><a href="#cb7-227" aria-hidden="true" tabindex="-1"></a>            string <span class="op">=</span> <span class="st">'efficient high mean portfolio'</span></span>
<span id="cb7-228"><a href="#cb7-228" aria-hidden="true" tabindex="-1"></a>            string, cd <span class="op">=</span> custom(string, [portTang], srTang,<span class="dv">1</span>)</span>
<span id="cb7-229"><a href="#cb7-229" aria-hidden="true" tabindex="-1"></a>            trace <span class="op">=</span> go.Scatter(</span>
<span id="cb7-230"><a href="#cb7-230" aria-hidden="true" tabindex="-1"></a>                x<span class="op">=</span>[sdTang],</span>
<span id="cb7-231"><a href="#cb7-231" aria-hidden="true" tabindex="-1"></a>                y<span class="op">=</span>[mnTang],</span>
<span id="cb7-232"><a href="#cb7-232" aria-hidden="true" tabindex="-1"></a>                mode<span class="op">=</span><span class="st">"markers"</span>,</span>
<span id="cb7-233"><a href="#cb7-233" aria-hidden="true" tabindex="-1"></a>                customdata<span class="op">=</span>cd,</span>
<span id="cb7-234"><a href="#cb7-234" aria-hidden="true" tabindex="-1"></a>                hovertemplate<span class="op">=</span>string,</span>
<span id="cb7-235"><a href="#cb7-235" aria-hidden="true" tabindex="-1"></a>                marker<span class="op">=</span><span class="bu">dict</span>(size<span class="op">=</span><span class="dv">10</span>, color<span class="op">=</span><span class="st">"blue"</span>),</span>
<span id="cb7-236"><a href="#cb7-236" aria-hidden="true" tabindex="-1"></a>                name<span class="op">=</span><span class="st">"efficient high mean portfolio"</span></span>
<span id="cb7-237"><a href="#cb7-237" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb7-238"><a href="#cb7-238" aria-hidden="true" tabindex="-1"></a>            fig.add_trace(trace)</span>
<span id="cb7-239"><a href="#cb7-239" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb7-240"><a href="#cb7-240" aria-hidden="true" tabindex="-1"></a>            <span class="co">#Plot CAL (with leverage)            </span></span>
<span id="cb7-241"><a href="#cb7-241" aria-hidden="true" tabindex="-1"></a>            grid, mns_cal, sds_cal <span class="op">=</span> rf_plus_risky_nokink(mnTang<span class="op">*</span><span class="dv">100</span>, sdTang<span class="op">*</span><span class="dv">100</span>, rb<span class="op">*</span><span class="dv">100</span>, <span class="fl">1.0</span>, <span class="fl">1.5</span>)</span>
<span id="cb7-242"><a href="#cb7-242" aria-hidden="true" tabindex="-1"></a>            string <span class="op">=</span> <span class="st">"wealth in efficient high mean portfolio = %</span><span class="sc">{text:.0f}</span><span class="st">%&lt;br&gt;"</span> <span class="op">+</span> <span class="st">"Sharpe ratio (relative to borrowing rate): "</span> <span class="op">+</span> <span class="st">"</span><span class="sc">{:.4f}</span><span class="st">"</span>.<span class="bu">format</span>(srTang) <span class="op">+</span><span class="st">"&lt;extra&gt;&lt;/extra&gt;"</span></span>
<span id="cb7-243"><a href="#cb7-243" aria-hidden="true" tabindex="-1"></a>            trace6 <span class="op">=</span> go.Scatter(</span>
<span id="cb7-244"><a href="#cb7-244" aria-hidden="true" tabindex="-1"></a>                x<span class="op">=</span>sds_cal, </span>
<span id="cb7-245"><a href="#cb7-245" aria-hidden="true" tabindex="-1"></a>                y<span class="op">=</span>mns_cal, </span>
<span id="cb7-246"><a href="#cb7-246" aria-hidden="true" tabindex="-1"></a>                mode<span class="op">=</span><span class="st">"lines"</span>, </span>
<span id="cb7-247"><a href="#cb7-247" aria-hidden="true" tabindex="-1"></a>                text<span class="op">=</span><span class="dv">100</span> <span class="op">*</span> grid, </span>
<span id="cb7-248"><a href="#cb7-248" aria-hidden="true" tabindex="-1"></a>                hovertemplate<span class="op">=</span>string,</span>
<span id="cb7-249"><a href="#cb7-249" aria-hidden="true" tabindex="-1"></a>                line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">"blue"</span>),</span>
<span id="cb7-250"><a href="#cb7-250" aria-hidden="true" tabindex="-1"></a>                name <span class="op">=</span> <span class="st">"CAL: efficient high mean"</span></span>
<span id="cb7-251"><a href="#cb7-251" aria-hidden="true" tabindex="-1"></a>            )           </span>
<span id="cb7-252"><a href="#cb7-252" aria-hidden="true" tabindex="-1"></a>            fig.add_trace(trace6)   </span>
<span id="cb7-253"><a href="#cb7-253" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb7-254"><a href="#cb7-254" aria-hidden="true" tabindex="-1"></a>            <span class="co">#Plot CAL (without leverage) </span></span>
<span id="cb7-255"><a href="#cb7-255" aria-hidden="true" tabindex="-1"></a>            grid, mns_cal, sds_cal <span class="op">=</span> rf_plus_risky_nokink(mnTang<span class="op">*</span><span class="dv">100</span>, sdTang<span class="op">*</span><span class="dv">100</span>, rb<span class="op">*</span><span class="dv">100</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb7-256"><a href="#cb7-256" aria-hidden="true" tabindex="-1"></a>            trace6a <span class="op">=</span> go.Scatter(</span>
<span id="cb7-257"><a href="#cb7-257" aria-hidden="true" tabindex="-1"></a>                x<span class="op">=</span>sds_cal, </span>
<span id="cb7-258"><a href="#cb7-258" aria-hidden="true" tabindex="-1"></a>                y<span class="op">=</span>mns_cal, </span>
<span id="cb7-259"><a href="#cb7-259" aria-hidden="true" tabindex="-1"></a>                mode<span class="op">=</span><span class="st">"lines"</span>, </span>
<span id="cb7-260"><a href="#cb7-260" aria-hidden="true" tabindex="-1"></a>                text<span class="op">=</span><span class="dv">100</span> <span class="op">*</span> grid, </span>
<span id="cb7-261"><a href="#cb7-261" aria-hidden="true" tabindex="-1"></a>                hovertemplate<span class="op">=</span>string, </span>
<span id="cb7-262"><a href="#cb7-262" aria-hidden="true" tabindex="-1"></a>                line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">"blue"</span>, dash<span class="op">=</span><span class="st">'dot'</span>),</span>
<span id="cb7-263"><a href="#cb7-263" aria-hidden="true" tabindex="-1"></a>                name <span class="op">=</span> <span class="st">"CAL: efficient high mean (unlevered)"</span></span>
<span id="cb7-264"><a href="#cb7-264" aria-hidden="true" tabindex="-1"></a>            )           </span>
<span id="cb7-265"><a href="#cb7-265" aria-hidden="true" tabindex="-1"></a>            fig.add_trace(trace6a)      </span>
<span id="cb7-266"><a href="#cb7-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-267"><a href="#cb7-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-268"><a href="#cb7-268" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb7-269"><a href="#cb7-269" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-270"><a href="#cb7-270" aria-hidden="true" tabindex="-1"></a>    fig.layout.xaxis[<span class="st">"title"</span>] <span class="op">=</span> <span class="st">"Standard Deviation"</span></span>
<span id="cb7-271"><a href="#cb7-271" aria-hidden="true" tabindex="-1"></a>    fig.layout.yaxis[<span class="st">"title"</span>] <span class="op">=</span> <span class="st">"Expected Return"</span></span>
<span id="cb7-272"><a href="#cb7-272" aria-hidden="true" tabindex="-1"></a>    fig.update_xaxes(<span class="bu">range</span><span class="op">=</span>[<span class="dv">0</span>, <span class="fl">1.25</span> <span class="op">*</span> df[<span class="st">"stdev"</span>].<span class="bu">max</span>()])</span>
<span id="cb7-273"><a href="#cb7-273" aria-hidden="true" tabindex="-1"></a>    fig.update_yaxes(<span class="bu">range</span><span class="op">=</span>[<span class="dv">0</span>, <span class="fl">1.25</span> <span class="op">*</span> df[<span class="st">"mean"</span>].<span class="bu">max</span>()])</span>
<span id="cb7-274"><a href="#cb7-274" aria-hidden="true" tabindex="-1"></a>    fig.update_yaxes(tickformat<span class="op">=</span><span class="st">".0%"</span>)</span>
<span id="cb7-275"><a href="#cb7-275" aria-hidden="true" tabindex="-1"></a>    fig.update_xaxes(tickformat<span class="op">=</span><span class="st">".0%"</span>)</span>
<span id="cb7-276"><a href="#cb7-276" aria-hidden="true" tabindex="-1"></a>    fig.show()</span>
<span id="cb7-277"><a href="#cb7-277" aria-hidden="true" tabindex="-1"></a>figtbl(mn_stock,mn_bond,sd_stock,sd_bond,corr,rs,extra,<span class="st">"Stock"</span>,<span class="st">"Bond"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-two-asset-plus_rf" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">

<div>                            <div id="d0fbf110-c838-443a-a76b-be9d2cf36c5e" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("d0fbf110-c838-443a-a76b-be9d2cf36c5e")) {                    Plotly.newPlot(                        "d0fbf110-c838-443a-a76b-be9d2cf36c5e",                        [{"hovertemplate":"%{text}<extra></extra>","marker":{"color":"orange","size":10},"mode":"markers","name":"Stock","text":["Stock"],"x":[0.2],"y":[0.08],"type":"scatter"},{"hovertemplate":"%{text}<extra></extra>","marker":{"color":"red","size":10},"mode":"markers","name":"Bond","text":["Bond"],"x":[0.035],"y":[0.035],"type":"scatter"},{"customdata":[100.0,99.0,98.0,97.0,96.0,95.0,94.0,93.0,92.0,91.0,90.0,89.0,88.0,87.0,86.0,85.0,84.0,83.0,82.0,81.0,80.0,79.0,78.0,77.0,76.0,75.0,74.0,73.0,72.0,71.0,70.0,69.0,68.0,67.0,65.99999999999999,64.99999999999999,64.0,63.0,62.0,61.0,60.0,59.0,58.00000000000001,57.00000000000001,56.00000000000001,55.00000000000001,54.0,53.0,52.0,51.0,50.0,49.0,48.0,47.0,46.0,44.99999999999999,43.99999999999999,42.99999999999999,42.00000000000001,41.0,40.0,39.0,38.0,37.0,36.0,35.0,34.0,32.99999999999999,31.999999999999996,30.999999999999993,29.999999999999993,29.000000000000004,28.000000000000004,27.0,26.0,25.0,24.0,23.0,21.999999999999996,20.999999999999996,19.999999999999996,18.999999999999993,17.999999999999993,16.999999999999993,16.000000000000004,15.000000000000002,14.000000000000002,13.0,12.0,10.999999999999998,9.999999999999998,8.999999999999996,7.9999999999999964,6.999999999999995,5.999999999999995,4.999999999999993,4.0000000000000036,3.0000000000000027,2.0000000000000018,1.0000000000000009,0.0],"hovertemplate":"Stock: %{text:.0f}%<br>Bond: %{customdata:.0f}%<extra></extra>","line":{"color":"black"},"mode":"lines","name":"Stock & Bond Frontier","text":[0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.000000000000001,8.0,9.0,10.0,11.0,12.0,13.0,14.000000000000002,15.0,16.0,17.0,18.0,19.0,20.0,21.0,22.0,23.0,24.0,25.0,26.0,27.0,28.000000000000004,28.999999999999996,30.0,31.0,32.0,33.0,34.0,35.0,36.0,37.0,38.0,39.0,40.0,41.0,42.0,43.0,44.0,45.0,46.0,47.0,48.0,49.0,50.0,51.0,52.0,53.0,54.0,55.00000000000001,56.00000000000001,57.00000000000001,57.99999999999999,59.0,60.0,61.0,62.0,63.0,64.0,65.0,66.0,67.0,68.0,69.0,70.0,71.0,72.0,73.0,74.0,75.0,76.0,77.0,78.0,79.0,80.0,81.0,82.0,83.0,84.0,85.0,86.0,87.0,88.0,89.0,90.0,91.0,92.0,93.0,94.0,95.0,96.0,97.0,98.0,99.0,100.0],"x":[0.035,0.034607694231196626,0.034333220064538074,0.03417941632035281,0.03414791355266087,0.034239049344279404,0.03445185045828453,0.0347840840040384,0.0352323714785139,0.03579235253514359,0.03645888094826829,0.03722623402924341,0.03808831841916889,0.03903885884602674,0.040071560987812796,0.041180244049786784,0.04235894238528625,0.043601978166133704,0.04490400872973369,0.046260052961491514,0.04766550115125194,0.04911611242759346,0.05060800331963315,0.052137630364258024,0.05370176905838392,0.05529749090148666,0.056922139805175985,0.0585733087677314,0.06024881741578004,0.06194669079135704,0.06366513959774218,0.06540254199952782,0.06715742699061661,0.06892845928932402,0.07071442568528716,0.07251422274285231,0.07432684575575638,0.0761513788450347,0.07798698609383492,0.07983290361749346,0.0816884324736373,0.0835529323243655,0.0854258157701757,0.08730654328284908,0.08919461867175621,0.09108958502485341,0.09299102107192932,0.09489853792340533,0.09681177614319449,0.09873040311879619,0.10065411069598698,0.10258261304919075,0.1045156447619207,0.10645295909461605,0.10839432641979008,0.11033953280669627,0.11228837873974315,0.11424067795667181,0.11619625639408525,0.11815495122930735,0.12011661000877438,0.12208108985424401,0.12404825673906103,0.1260179848275634,0.12799015587145757,0.129964658657652,0.13194138850262263,0.13392024678890047,0.13590114053973204,0.13788398202837052,0.1398686884188166,0.14185518143515238,0.143843387056896,0.14583323523806224,0.14782465964784086,0.14981759743100942,0.15181198898637752,0.1538077777617244,0.15580491006383593,0.15780333488237822,0.15980300372646317,0.161803870472866,0.16380589122494954,0.16580902418143592,0.16781322951424302,0.1698184692546721,0.17182470718729598,0.173831908750954,0.17584004094631006,0.17784907224947788,0.1798589725312585,0.1818697129815737,0.18388126603871316,0.18589360532304494,0.18790670557486766,0.18992054259610783,0.1919350931955905,0.1939503351376326,0.19596624709372787,0.19798280859711023,0.2],"y":[0.035,0.03545,0.0359,0.03635,0.0368,0.03725,0.0377,0.038149999999999996,0.0386,0.03905,0.0395,0.03995,0.0404,0.04085,0.041299999999999996,0.041749999999999995,0.042199999999999994,0.042649999999999993,0.043100000000000006,0.043550000000000005,0.044000000000000004,0.04445,0.0449,0.04535,0.0458,0.04625,0.0467,0.04715,0.047599999999999996,0.048049999999999995,0.048499999999999995,0.048949999999999994,0.04939999999999999,0.04984999999999999,0.050300000000000004,0.05075,0.0512,0.05165,0.0521,0.05255,0.053,0.05345,0.0539,0.05435,0.0548,0.05525,0.0557,0.056150000000000005,0.056600000000000004,0.057050000000000003,0.0575,0.05795,0.0584,0.05885,0.0593,0.059750000000000004,0.060200000000000004,0.06065,0.061099999999999995,0.06155,0.062,0.06245,0.0629,0.06335,0.0638,0.06425,0.0647,0.06515,0.0656,0.06605,0.0665,0.06695000000000001,0.0674,0.06785000000000001,0.0683,0.06875,0.0692,0.06965,0.0701,0.07055,0.07100000000000001,0.07145,0.0719,0.07235,0.0728,0.07325,0.0737,0.07415,0.0746,0.07505,0.0755,0.07595,0.07640000000000001,0.07685,0.07730000000000001,0.07775,0.0782,0.07865,0.0791,0.07955,0.08],"type":"scatter"},{"hovertemplate":"wealth in Stock= %{text:.0f}%<br>Sharpe ratio: 0.3000<extra></extra>","line":{"color":"orange"},"mode":"lines","name":"CAL: Stock","text":[0.0,0.5,1.0,1.5,2.0,2.5,3.0,3.5000000000000004,4.0,4.5,5.0,5.5,6.0,6.5,7.000000000000001,7.5,8.0,8.5,9.0,9.5,10.0,10.5,11.0,11.5,12.0,12.5,13.0,13.5,14.000000000000002,14.499999999999998,15.0,15.5,16.0,16.5,17.0,17.5,18.0,18.5,19.0,19.5,20.0,20.5,21.0,21.5,22.0,22.5,23.0,23.5,24.0,24.5,25.0,25.5,26.0,26.5,27.0,27.500000000000004,28.000000000000004,28.500000000000004,28.999999999999996,29.5,30.0,30.5,31.0,31.5,32.0,32.5,33.0,33.5,34.0,34.5,35.0,35.5,36.0,36.5,37.0,37.5,38.0,38.5,39.0,39.5,40.0,40.5,41.0,41.5,42.0,42.5,43.0,43.5,44.0,44.5,45.0,45.5,46.0,46.5,47.0,47.5,48.0,48.5,49.0,49.5,50.0,50.5,51.0,51.5,52.0,52.5,53.0,53.5,54.0,54.50000000000001,55.00000000000001,55.50000000000001,56.00000000000001,56.50000000000001,57.00000000000001,57.50000000000001,57.99999999999999,58.5,59.0,59.5,60.0,60.5,61.0,61.5,62.0,62.5,63.0,63.5,64.0,64.5,65.0,65.5,66.0,66.5,67.0,67.5,68.0,68.5,69.0,69.5,70.0,70.5,71.0,71.5,72.0,72.5,73.0,73.5,74.0,74.5,75.0,75.5,76.0,76.5,77.0,77.5,78.0,78.5,79.0,79.5,80.0,80.5,81.0,81.5,82.0,82.5,83.0,83.5,84.0,84.5,85.0,85.5,86.0,86.5,87.0,87.5,88.0,88.5,89.0,89.5,90.0,90.5,91.0,91.5,92.0,92.5,93.0,93.5,94.0,94.5,95.0,95.5,96.0,96.5,97.0,97.5,98.0,98.5,99.0,99.5,100.0],"x":[0.0,0.001,0.002,0.003,0.004,0.005000000000000001,0.006,0.007000000000000001,0.008,0.009,0.010000000000000002,0.011000000000000001,0.012,0.013000000000000001,0.014000000000000002,0.015,0.016,0.017,0.018,0.019000000000000003,0.020000000000000004,0.021,0.022000000000000002,0.023000000000000003,0.024,0.025,0.026000000000000002,0.027000000000000003,0.028000000000000004,0.028999999999999998,0.03,0.031,0.032,0.033,0.034,0.035,0.036,0.037,0.038000000000000006,0.03900000000000001,0.04000000000000001,0.04100000000000001,0.042,0.043000000000000003,0.044000000000000004,0.045000000000000005,0.046000000000000006,0.04700000000000001,0.048,0.049,0.05,0.051000000000000004,0.052000000000000005,0.053000000000000005,0.054000000000000006,0.05500000000000001,0.05600000000000001,0.05700000000000001,0.057999999999999996,0.059,0.06,0.061,0.062,0.063,0.064,0.065,0.066,0.067,0.068,0.069,0.07,0.071,0.072,0.073,0.074,0.07500000000000001,0.07600000000000001,0.07700000000000001,0.07800000000000001,0.07900000000000001,0.08000000000000002,0.08100000000000002,0.08200000000000002,0.08300000000000002,0.084,0.085,0.08600000000000001,0.08700000000000001,0.08800000000000001,0.08900000000000001,0.09000000000000001,0.09100000000000001,0.09200000000000001,0.09300000000000001,0.09400000000000001,0.09500000000000001,0.096,0.097,0.098,0.099,0.1,0.101,0.10200000000000001,0.10300000000000001,0.10400000000000001,0.10500000000000001,0.10600000000000001,0.10700000000000001,0.10800000000000001,0.10900000000000001,0.11000000000000001,0.11100000000000002,0.11200000000000002,0.11300000000000002,0.11400000000000002,0.11500000000000002,0.11599999999999999,0.11699999999999999,0.118,0.119,0.12,0.121,0.122,0.123,0.124,0.125,0.126,0.127,0.128,0.129,0.13,0.131,0.132,0.133,0.134,0.135,0.136,0.137,0.138,0.139,0.14,0.141,0.142,0.143,0.144,0.145,0.146,0.147,0.148,0.149,0.15000000000000002,0.15100000000000002,0.15200000000000002,0.15300000000000002,0.15400000000000003,0.15500000000000003,0.15600000000000003,0.15700000000000003,0.15800000000000003,0.15900000000000003,0.16000000000000003,0.16100000000000003,0.16200000000000003,0.16300000000000003,0.16400000000000003,0.16500000000000004,0.16600000000000004,0.167,0.168,0.169,0.17,0.171,0.17200000000000001,0.17300000000000001,0.17400000000000002,0.17500000000000002,0.17600000000000002,0.17700000000000002,0.17800000000000002,0.17900000000000002,0.18000000000000002,0.18100000000000002,0.18200000000000002,0.18300000000000002,0.18400000000000002,0.18500000000000003,0.18600000000000003,0.18700000000000003,0.18800000000000003,0.18900000000000003,0.19000000000000003,0.19100000000000003,0.192,0.193,0.194,0.195,0.196,0.197,0.198,0.199,0.2],"y":[0.02,0.020300000000000002,0.0206,0.020900000000000002,0.0212,0.021500000000000002,0.0218,0.0221,0.0224,0.0227,0.023,0.0233,0.0236,0.0239,0.0242,0.0245,0.0248,0.0251,0.0254,0.0257,0.026000000000000002,0.0263,0.0266,0.0269,0.027200000000000002,0.0275,0.0278,0.0281,0.0284,0.0287,0.028999999999999998,0.0293,0.0296,0.029900000000000003,0.0302,0.0305,0.0308,0.0311,0.0314,0.0317,0.032,0.0323,0.0326,0.0329,0.0332,0.0335,0.0338,0.0341,0.0344,0.0347,0.035,0.0353,0.0356,0.0359,0.036199999999999996,0.036500000000000005,0.0368,0.0371,0.0374,0.0377,0.038,0.0383,0.038599999999999995,0.038900000000000004,0.0392,0.0395,0.0398,0.0401,0.040400000000000005,0.0407,0.041,0.0413,0.0416,0.0419,0.0422,0.042499999999999996,0.042800000000000005,0.0431,0.0434,0.0437,0.044,0.044300000000000006,0.0446,0.0449,0.0452,0.0455,0.0458,0.0461,0.0464,0.0467,0.047,0.0473,0.0476,0.0479,0.0482,0.0485,0.048799999999999996,0.0491,0.0494,0.049699999999999994,0.05,0.0503,0.0506,0.0509,0.051199999999999996,0.051500000000000004,0.0518,0.05210000000000001,0.0524,0.0527,0.053000000000000005,0.0533,0.05360000000000001,0.0539,0.0542,0.05450000000000001,0.0548,0.055099999999999996,0.05539999999999999,0.0557,0.055999999999999994,0.0563,0.0566,0.05689999999999999,0.0572,0.057499999999999996,0.057800000000000004,0.0581,0.058399999999999994,0.0587,0.059,0.059300000000000005,0.0596,0.059899999999999995,0.060200000000000004,0.0605,0.06080000000000001,0.0611,0.061399999999999996,0.061700000000000005,0.062,0.062299999999999994,0.0626,0.0629,0.06319999999999999,0.0635,0.0638,0.0641,0.0644,0.0647,0.065,0.0653,0.0656,0.0659,0.0662,0.0665,0.0668,0.0671,0.0674,0.0677,0.068,0.0683,0.06860000000000001,0.0689,0.0692,0.0695,0.0698,0.0701,0.07039999999999999,0.0707,0.071,0.0713,0.0716,0.07189999999999999,0.0722,0.0725,0.0728,0.0731,0.07339999999999999,0.0737,0.074,0.0743,0.0746,0.0749,0.0752,0.0755,0.0758,0.0761,0.0764,0.0767,0.077,0.07730000000000001,0.0776,0.0779,0.07819999999999999,0.0785,0.0788,0.0791,0.0794,0.0797,0.08],"type":"scatter"},{"hovertemplate":"wealth in Bond= %{text:.0f}%<br>Sharpe ratio : 0.4286<extra></extra>","line":{"color":"red"},"mode":"lines","name":"CAL: Bond","text":[0.0,2.0,4.0,6.0,8.0,10.0,12.0,14.000000000000002,16.0,18.0,20.0,22.0,24.0,26.0,28.000000000000004,30.0,32.0,34.0,36.0,38.0,40.0,42.0,44.0,46.0,48.0,50.0,52.0,54.0,56.00000000000001,57.99999999999999,60.0,62.0,64.0,66.0,68.0,70.0,72.0,74.0,76.0,78.0,80.0,82.0,84.0,86.0,88.0,90.0,92.0,94.0,96.0,98.0,100.0,102.0,104.0,106.0,108.0,110.00000000000001,112.00000000000001,114.00000000000001,115.99999999999999,118.0,120.0,122.0,124.0,126.0,128.0,130.0,132.0,134.0,136.0,138.0,140.0,142.0,144.0,146.0,148.0,150.0,152.0,154.0,156.0,158.0,160.0,162.0,164.0,166.0,168.0,170.0,172.0,174.0,176.0,178.0,180.0,182.0,184.0,186.0,188.0,190.0,192.0,194.0,196.0,198.0,200.0,202.0,204.0,206.0,208.0,210.0,212.0,214.0,216.0,218.00000000000003,220.00000000000003,222.00000000000003,224.00000000000003,226.00000000000003,228.00000000000003,230.00000000000003,231.99999999999997,234.0,236.0,238.0,240.0,242.0,244.0,246.0,248.0,250.0,252.0,254.0,256.0,258.0,260.0,262.0,264.0,266.0,268.0,270.0,272.0,274.0,276.0,278.0,280.0,282.0,284.0,286.0,288.0,290.0,292.0,294.0,296.0,298.0,300.0,302.0,304.0,306.0,308.0,310.0,312.0,314.0,316.0,318.0,320.0,322.0,324.0,326.0,328.0,330.0,332.0,334.0,336.0,338.0,340.0,342.0,344.0,346.0,348.0,350.0,352.0,354.0,356.0,358.0,360.0,362.0,364.0,366.0,368.0,370.0,372.0,374.0,376.0,378.0,380.0,382.0,384.0,386.0,388.0,390.0,392.0,394.0,396.0,398.0,400.0],"x":[0.0,0.0007000000000000001,0.0014000000000000002,0.0021000000000000003,0.0028000000000000004,0.0035000000000000005,0.004200000000000001,0.004900000000000001,0.005600000000000001,0.0063,0.007000000000000001,0.007700000000000001,0.008400000000000001,0.0091,0.009800000000000001,0.0105,0.011200000000000002,0.011900000000000003,0.0126,0.013300000000000001,0.014000000000000002,0.014700000000000001,0.015400000000000002,0.016100000000000003,0.016800000000000002,0.0175,0.0182,0.018900000000000004,0.019600000000000003,0.020300000000000002,0.021,0.0217,0.022400000000000003,0.023100000000000002,0.023800000000000005,0.024500000000000004,0.0252,0.025900000000000003,0.026600000000000002,0.027300000000000005,0.028000000000000004,0.028700000000000003,0.029400000000000003,0.030100000000000002,0.030800000000000004,0.03150000000000001,0.032200000000000006,0.032900000000000006,0.033600000000000005,0.034300000000000004,0.035,0.0357,0.0364,0.03710000000000001,0.03780000000000001,0.038500000000000006,0.039200000000000006,0.039900000000000005,0.040600000000000004,0.0413,0.042,0.0427,0.0434,0.04410000000000001,0.044800000000000006,0.045500000000000006,0.046200000000000005,0.046900000000000004,0.04760000000000001,0.04830000000000001,0.04900000000000001,0.0497,0.0504,0.051100000000000007,0.051800000000000006,0.052500000000000005,0.053200000000000004,0.0539,0.05460000000000001,0.05530000000000001,0.05600000000000001,0.05670000000000001,0.05740000000000001,0.05810000000000001,0.058800000000000005,0.059500000000000004,0.060200000000000004,0.0609,0.06160000000000001,0.06230000000000001,0.06300000000000001,0.0637,0.06440000000000001,0.0651,0.06580000000000001,0.06650000000000002,0.06720000000000001,0.0679,0.06860000000000001,0.0693,0.07,0.07070000000000001,0.0714,0.07210000000000001,0.0728,0.07350000000000001,0.07420000000000002,0.07490000000000001,0.07560000000000001,0.0763,0.07700000000000001,0.07770000000000002,0.07840000000000001,0.07910000000000002,0.07980000000000001,0.08050000000000002,0.08120000000000001,0.0819,0.0826,0.0833,0.084,0.08470000000000001,0.0854,0.08610000000000001,0.0868,0.08750000000000001,0.08820000000000001,0.0889,0.08960000000000001,0.0903,0.09100000000000001,0.09170000000000002,0.09240000000000001,0.09310000000000002,0.09380000000000001,0.09450000000000001,0.09520000000000002,0.09590000000000001,0.09660000000000002,0.09730000000000001,0.09800000000000002,0.09870000000000001,0.0994,0.10010000000000001,0.1008,0.1015,0.10220000000000001,0.1029,0.10360000000000001,0.1043,0.10500000000000001,0.10570000000000002,0.10640000000000001,0.10710000000000001,0.1078,0.10850000000000001,0.10920000000000002,0.10990000000000001,0.11060000000000002,0.11130000000000001,0.11200000000000002,0.11270000000000002,0.11340000000000001,0.11410000000000002,0.11480000000000001,0.11550000000000002,0.11620000000000003,0.1169,0.11760000000000001,0.1183,0.11900000000000001,0.11970000000000001,0.12040000000000001,0.12110000000000001,0.1218,0.12250000000000001,0.12320000000000002,0.12390000000000001,0.12460000000000002,0.12530000000000002,0.12600000000000003,0.1267,0.1274,0.12810000000000002,0.12880000000000003,0.12950000000000003,0.1302,0.13090000000000002,0.13160000000000002,0.13230000000000003,0.13300000000000003,0.1337,0.13440000000000002,0.1351,0.1358,0.1365,0.13720000000000002,0.13790000000000002,0.1386,0.1393,0.14],"y":[0.02,0.020300000000000002,0.0206,0.020900000000000002,0.0212,0.021500000000000002,0.0218,0.0221,0.0224,0.0227,0.023,0.0233,0.023600000000000003,0.0239,0.024200000000000003,0.0245,0.024800000000000003,0.0251,0.025400000000000002,0.0257,0.026000000000000002,0.0263,0.026600000000000002,0.0269,0.027200000000000002,0.027500000000000004,0.027800000000000002,0.0281,0.0284,0.028700000000000003,0.029,0.0293,0.0296,0.029900000000000003,0.030200000000000005,0.030500000000000003,0.0308,0.031100000000000003,0.031400000000000004,0.031700000000000006,0.032,0.0323,0.032600000000000004,0.0329,0.03320000000000001,0.0335,0.033800000000000004,0.034100000000000005,0.0344,0.0347,0.035,0.035300000000000005,0.03560000000000001,0.0359,0.0362,0.036500000000000005,0.036800000000000006,0.03710000000000001,0.0374,0.037700000000000004,0.038000000000000006,0.0383,0.0386,0.038900000000000004,0.039200000000000006,0.03950000000000001,0.0398,0.04010000000000001,0.040400000000000005,0.04070000000000001,0.04100000000000001,0.0413,0.041600000000000005,0.04190000000000001,0.0422,0.04250000000000001,0.042800000000000005,0.043100000000000006,0.04340000000000001,0.0437,0.04400000000000001,0.044300000000000006,0.04460000000000001,0.04490000000000001,0.045200000000000004,0.045500000000000006,0.04580000000000001,0.0461,0.04640000000000001,0.046700000000000005,0.04700000000000001,0.04730000000000001,0.0476,0.04790000000000001,0.04820000000000001,0.04850000000000001,0.04880000000000001,0.049100000000000005,0.049400000000000006,0.04970000000000001,0.05,0.05030000000000001,0.050600000000000006,0.05090000000000001,0.05120000000000001,0.051500000000000004,0.05180000000000001,0.05210000000000001,0.0524,0.05270000000000001,0.053000000000000005,0.053300000000000014,0.05360000000000001,0.05390000000000002,0.05420000000000001,0.05450000000000001,0.0548,0.05510000000000001,0.055400000000000005,0.0557,0.05600000000000001,0.0563,0.05660000000000001,0.056900000000000006,0.0572,0.05750000000000001,0.057800000000000004,0.05810000000000001,0.05840000000000001,0.0587,0.05900000000000001,0.059300000000000005,0.059600000000000014,0.05990000000000001,0.06020000000000002,0.06050000000000001,0.06080000000000001,0.061100000000000015,0.06140000000000001,0.06170000000000002,0.06200000000000001,0.06230000000000001,0.0626,0.06290000000000001,0.0632,0.0635,0.06380000000000001,0.0641,0.06440000000000001,0.06470000000000001,0.06500000000000002,0.06530000000000001,0.0656,0.06590000000000001,0.06620000000000001,0.06650000000000002,0.06680000000000001,0.0671,0.06740000000000002,0.06770000000000001,0.06800000000000002,0.06830000000000001,0.06860000000000001,0.06890000000000002,0.06920000000000001,0.06950000000000002,0.06980000000000001,0.07010000000000001,0.0704,0.07070000000000001,0.07100000000000001,0.07130000000000002,0.07160000000000001,0.0719,0.07220000000000001,0.07250000000000001,0.07280000000000002,0.07310000000000001,0.0734,0.07370000000000002,0.07400000000000001,0.07430000000000002,0.07460000000000001,0.07490000000000001,0.07520000000000002,0.07550000000000001,0.07580000000000002,0.07610000000000001,0.07640000000000001,0.07670000000000002,0.07700000000000001,0.07730000000000002,0.07760000000000002,0.07790000000000001,0.0782,0.07850000000000001,0.07880000000000001,0.07910000000000002,0.07940000000000001,0.07970000000000001,0.08000000000000002],"type":"scatter"},{"customdata":[[[0.11254401505577158],[0.8874559849442285],[0.536]]],"hovertemplate":"tangency portfolio<br>asset 1: %{customdata[0]:.1%}<br>asset 2: %{customdata[1]:.1%}<br>Sharpe ratio: %{customdata[2]:.4f}<br><extra></extra>","marker":{"color":"blue","size":10},"mode":"markers","name":"tangency portfolio","x":[0.03743681229177574],"y":[0.04006448067750973],"type":"scatter"},{"hovertemplate":"wealth in tangency portfolio = %{text:.0f}%<br>Sharpe ratio: 0.5360<extra></extra>","line":{"color":"blue"},"mode":"lines","name":"CAL: tangency portfolio","text":[0.0,1.5,3.0,4.5,6.0,7.5,9.0,10.5,12.0,13.5,15.0,16.499999999999996,18.0,19.5,21.0,22.499999999999996,24.0,25.5,27.0,28.499999999999996,30.0,31.5,32.99999999999999,34.5,36.0,37.5,39.0,40.5,42.0,43.5,44.99999999999999,46.5,48.0,49.5,51.0,52.5,54.0,55.49999999999999,56.99999999999999,58.5,60.0,61.5,63.0,64.5,65.99999999999999,67.5,69.0,70.5,72.0,73.5,75.0,76.5,78.0,79.5,81.0,82.5,84.0,85.5,87.0,88.5,89.99999999999999,91.49999999999999,93.0,94.5,96.0,97.5,99.0,100.49999999999999,102.0,103.49999999999999,105.0,106.5,108.0,109.5,110.99999999999999,112.5,113.99999999999999,115.5,117.0,118.5,120.0,121.49999999999999,123.0,124.49999999999999,126.0,127.49999999999999,129.0,130.5,131.99999999999997,133.5,135.0,136.5,138.0,139.5,141.0,142.5,144.0,145.49999999999997,147.0,148.5,150.0,151.5,153.0,154.5,156.0,157.5,159.0,160.5,162.0,163.5,165.0,166.5,168.0,169.49999999999997,171.0,172.5,174.0,175.5,177.0,178.5,179.99999999999997,181.5,182.99999999999997,184.5,186.0,187.5,189.0,190.5,192.0,193.49999999999997,195.0,196.5,198.0,199.5,200.99999999999997,202.5,204.0,205.49999999999997,206.99999999999997,208.5,210.0,211.49999999999997,213.0,214.5,216.0,217.49999999999997,219.0,220.5,221.99999999999997,223.5,225.0,226.5,227.99999999999997,229.5,231.0,232.49999999999997,234.0,235.5,237.0,238.49999999999997,240.0,241.5,242.99999999999997,244.49999999999997,246.0,247.5,248.99999999999997,250.5,252.0,253.49999999999997,254.99999999999997,256.5,258.0,259.5,261.0,262.5,263.99999999999994,265.5,267.0,268.5,270.0,271.5,273.0,274.5,276.0,277.5,279.0,280.5,282.0,283.5,285.0,286.5,288.0,289.5,290.99999999999994,292.5,294.0,295.5,297.0,298.5,300.0],"x":[0.0,0.0005615521843766361,0.0011231043687532723,0.0016846565531299083,0.0022462087375065445,0.0028077609218831808,0.0033693131062598166,0.003930865290636453,0.004492417475013089,0.005053969659389725,0.0056155218437663615,0.006177074028142997,0.006738626212519633,0.00730017839689627,0.007861730581272906,0.008423282765649541,0.008984834950026178,0.009546387134402815,0.01010793931877945,0.010669491503156086,0.011231043687532723,0.011792595871909358,0.012354148056285994,0.012915700240662631,0.013477252425039266,0.014038804609415903,0.01460035679379254,0.015161908978169174,0.01572346116254581,0.016285013346922447,0.016846565531299082,0.017408117715675717,0.017969669900052356,0.01853122208442899,0.01909277426880563,0.019654326453182266,0.0202158786375589,0.020777430821935533,0.021338983006312172,0.021900535190688807,0.022462087375065446,0.02302363955944208,0.023585191743818717,0.024146743928195356,0.024708296112571988,0.025269848296948623,0.025831400481325262,0.026392952665701897,0.026954504850078533,0.02751605703445517,0.028077609218831807,0.028639161403208442,0.02920071358758508,0.029762265771961713,0.030323817956338348,0.030885370140714987,0.03144692232509162,0.03200847450946826,0.03257002669384489,0.03313157887822153,0.033693131062598164,0.0342546832469748,0.034816235431351435,0.035377787615728074,0.03593933980010471,0.03650089198448135,0.03706244416885798,0.037623996353234615,0.03818554853761126,0.03874710072198789,0.03930865290636453,0.03987020509074116,0.0404317572751178,0.040993309459494434,0.041554861643871066,0.04211641382824771,0.042677966012624344,0.04323951819700098,0.043801070381377614,0.04436262256575425,0.04492417475013089,0.045485726934507524,0.04604727911888416,0.046608831303260795,0.047170383487637434,0.047731935672014066,0.04829348785639071,0.04885504004076734,0.049416592225143975,0.049978144409520614,0.050539696593897246,0.051101248778273885,0.051662800962650524,0.05222435314702716,0.052785905331403794,0.05334745751578043,0.053909009700157065,0.0544705618845337,0.05503211406891034,0.055593666253286975,0.056155218437663613,0.056716770622040245,0.057278322806416884,0.057839874990793516,0.05840142717517016,0.058962979359546794,0.059524531543923426,0.060086083728300065,0.060647635912676696,0.06120918809705334,0.061770740281429974,0.06233229246580661,0.06289384465018324,0.06345539683455988,0.06401694901893652,0.06457850120331315,0.06514005338768979,0.06570160557206642,0.06626315775644306,0.0668247099408197,0.06738626212519633,0.06794781430957297,0.0685093664939496,0.06907091867832624,0.06963247086270287,0.07019402304707952,0.07075557523145615,0.07131712741583279,0.07187867960020942,0.07244023178458606,0.0730017839689627,0.07356333615333933,0.07412488833771597,0.0746864405220926,0.07524799270646923,0.07580954489084588,0.07637109707522252,0.07693264925959914,0.07749420144397579,0.07805575362835242,0.07861730581272906,0.07917885799710568,0.07974041018148233,0.08030196236585897,0.0808635145502356,0.08142506673461224,0.08198661891898887,0.08254817110336551,0.08310972328774213,0.08367127547211878,0.08423282765649542,0.08479437984087206,0.08535593202524869,0.08591748420962532,0.08647903639400197,0.0870405885783786,0.08760214076275523,0.08816369294713187,0.0887252451315085,0.08928679731588514,0.08984834950026178,0.09040990168463842,0.09097145386901505,0.09153300605339168,0.09209455823776833,0.09265611042214497,0.09321766260652159,0.09377921479089824,0.09434076697527487,0.0949023191596515,0.09546387134402813,0.09602542352840478,0.09658697571278142,0.09714852789715804,0.09771008008153469,0.09827163226591132,0.09883318445028795,0.09939473663466458,0.09995628881904123,0.10051784100341787,0.10107939318779449,0.10164094537217114,0.10220249755654777,0.10276404974092442,0.10332560192530105,0.10388715410967768,0.10444870629405432,0.10501025847843094,0.10557181066280759,0.10613336284718423,0.10669491503156087,0.1072564672159375,0.10781801940031413,0.10837957158469078,0.1089411237690674,0.10950267595344404,0.11006422813782069,0.11062578032219732,0.11118733250657395,0.11174888469095058,0.11231043687532723],"y":[0.02,0.020300967210162647,0.02060193442032529,0.020902901630487938,0.021203868840650585,0.02150483605081323,0.021805803260975875,0.022106770471138522,0.02240773768130117,0.022708704891463816,0.02300967210162646,0.023310639311789106,0.023611606521951753,0.023912573732114396,0.024213540942277043,0.02451450815243969,0.024815475362602334,0.02511644257276498,0.025417409782927627,0.02571837699309027,0.026019344203252918,0.026320311413415565,0.026621278623578208,0.026922245833740855,0.027223213043903502,0.02752418025406615,0.027825147464228796,0.02812611467439144,0.028427081884554086,0.028728049094716733,0.029029016304879376,0.029329983515042023,0.02963095072520467,0.029931917935367314,0.030232885145529964,0.030533852355692608,0.030834819565855254,0.031135786776017898,0.031436753986180545,0.03173772119634319,0.03203868840650584,0.03233965561666848,0.032640622826831125,0.032941590036993776,0.03324255724715642,0.03354352445731906,0.03384449166748171,0.03414545887764436,0.034446426087807,0.03474739329796965,0.0350483605081323,0.035349327718294944,0.03565029492845759,0.03595126213862023,0.036252229348782875,0.036553196558945525,0.036854163769108175,0.03715513097927082,0.03745609818943346,0.03775706539959611,0.03805803260975875,0.0383589998199214,0.03865996703008405,0.03896093424024669,0.03926190145040934,0.03956286866057199,0.03986383587073463,0.040164803080897274,0.040465770291059924,0.04076673750122257,0.04106770471138521,0.04136867192154786,0.04166963913171051,0.04197060634187315,0.0422715735520358,0.04257254076219845,0.042873507972361086,0.043174475182523736,0.04347544239268638,0.04377640960284903,0.04407737681301167,0.04437834402317432,0.04467931123333697,0.04498027844349961,0.04528124565366226,0.0455822128638249,0.04588318007398755,0.0461841472841502,0.046485114494312835,0.046786081704475485,0.047087048914638135,0.04738801612480078,0.04768898333496342,0.04798995054512607,0.048290917755288716,0.04859188496545136,0.04889285217561401,0.049193819385776646,0.0494947865959393,0.04979575380610195,0.0500967210162646,0.050397688226427234,0.050698655436589884,0.05099962264675253,0.05130058985691517,0.05160155706707782,0.05190252427724046,0.05220349148740311,0.05250445869756576,0.05280542590772841,0.053106393117891046,0.053407360328053696,0.05370832753821635,0.05400929474837898,0.054310261958541634,0.054611229168704284,0.05491219637886692,0.05521316358902957,0.05551413079919222,0.05581509800935486,0.05611606521951751,0.05641703242968016,0.056717999639842795,0.057018966850005445,0.057319934060168096,0.057620901270330746,0.05792186848049338,0.05822283569065603,0.05852380290081868,0.05882477011098132,0.05912573732114397,0.05942670453130661,0.05972767174146926,0.06002863895163191,0.060329606161794544,0.060630573371957194,0.060931540582119845,0.06123250779228248,0.06153347500244513,0.06183444221260778,0.06213540942277043,0.06243637663293307,0.06273734384309572,0.06303831105325837,0.06333927826342102,0.06364024547358366,0.0639412126837463,0.06424217989390896,0.0645431471040716,0.06484411431423424,0.0651450815243969,0.06544604873455953,0.06574701594472218,0.06604798315488482,0.06634895036504747,0.06664991757521012,0.06695088478537276,0.0672518519955354,0.06755281920569806,0.06785378641586069,0.06815475362602334,0.068455720836186,0.06875668804634863,0.06905765525651128,0.06935862246667393,0.06965958967683658,0.06996055688699922,0.07026152409716187,0.07056249130732452,0.07086345851748715,0.0711644257276498,0.07146539293781246,0.0717663601479751,0.07206732735813774,0.07236829456830039,0.07266926177846304,0.07297022898862568,0.07327119619878833,0.07357216340895097,0.07387313061911362,0.07417409782927627,0.0744750650394389,0.07477603224960155,0.0750769994597642,0.07537796666992684,0.07567893388008949,0.07597990109025214,0.07628086830041478,0.07658183551057743,0.07688280272074008,0.07718376993090273,0.07748473714106537,0.07778570435122802,0.07808667156139067,0.0783876387715533,0.07868860598171595,0.0789895731918786,0.07929054040204125,0.07959150761220389,0.07989247482236654,0.08019344203252919],"type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"title":{"text":"Standard Deviation"},"range":[0,0.25],"tickformat":".0%"},"yaxis":{"title":{"text":"Expected Return"},"range":[0,0.1],"tickformat":".0%"}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('d0fbf110-c838-443a-a76b-be9d2cf36c5e');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
<p></p><figcaption class="figure-caption">Figure 4.7: Tangency portfolio of two risky assets</figcaption><p></p>
</figure>
</div>
</div>
<p>Now relax the restriction that the risk-free rate applies to borrowing as well as saving–<span class="math inline">\(r_f^{\text{borrow}}&gt;r_f^{\text{saving}}\)</span>. If the interest rates are lower than expected returns, the efficient portfolios fall into three regions, separated by blue dots in <a href="#fig-two-asset-plus_rf_saveborrow">Figure&nbsp;<span>4.8</span></a>.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> These blue dots indicate an efficient low risk portfolio and an efficient high mean portfolio, both comprised solely of risky assets. To the left of the efficient low risk portfolio, the optimal portfolios are scaled-down versions of the efficient low risk portfolio with some savings. To the right of the efficient high mean portfolio, the optimal portfolios are scaled-up versions of the efficient high mean portfolio with some borrowing. Both cases are shown as blue lines in the figure. The third region is the black curve between the efficient low risk and efficient high mean portfolios. These portfolios do not involve saving or borrowing. The blue dotted lines extend the blue solid lines, but the points on the blue dotted lines are infeasible, because they involve saving at the borrowing rate or borrowing at the savings rate.</p>
<div class="cell" data-execution_count="9">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.graph_objects <span class="im">as</span> go</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>mn_stock <span class="op">=</span> <span class="dv">8</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>mn_bond  <span class="op">=</span> <span class="fl">3.5</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>sd_stock <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>sd_bond  <span class="op">=</span> <span class="fl">3.5</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>corr <span class="op">=</span> <span class="op">-</span><span class="dv">5</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>rs <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>extra <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> data(mn1, mn2, sd1, sd2, c, rs, extra):</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    c <span class="op">=</span> c <span class="op">/</span> <span class="dv">100</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>    rb <span class="op">=</span> rs <span class="op">+</span> extra   </span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>    rs <span class="op">=</span> rs<span class="op">/</span><span class="dv">100</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>    rb <span class="op">=</span> rb<span class="op">/</span><span class="dv">100</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>    mns <span class="op">=</span> [mn1, mn2]</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>    sds <span class="op">=</span> [sd1, sd2]</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>    grid <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">101</span>)</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>    ports <span class="op">=</span> [np.array([w, <span class="dv">1</span> <span class="op">-</span> w]) <span class="cf">for</span> w <span class="kw">in</span> grid]</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>    means <span class="op">=</span> [p.T <span class="op">@</span> np.array(mns) <span class="cf">for</span> p <span class="kw">in</span> ports]</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> pd.DataFrame(means)</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>    df.columns <span class="op">=</span> [<span class="st">"mean"</span>]</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>    cov <span class="op">=</span> np.array(</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>        [[sds[<span class="dv">0</span>] <span class="op">**</span> <span class="dv">2</span>, sds[<span class="dv">0</span>] <span class="op">*</span> sds[<span class="dv">1</span>] <span class="op">*</span> c], [sds[<span class="dv">0</span>] <span class="op">*</span> sds[<span class="dv">1</span>] <span class="op">*</span> c, sds[<span class="dv">1</span>] <span class="op">**</span> <span class="dv">2</span>]]</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>    ).reshape(<span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">"stdev"</span>] <span class="op">=</span> [np.sqrt(p.T <span class="op">@</span> cov <span class="op">@</span> p) <span class="cf">for</span> p <span class="kw">in</span> ports]</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">"wt1"</span>] <span class="op">=</span> grid</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">"wt2"</span>] <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> df.wt1</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col <span class="kw">in</span> [<span class="st">"mean"</span>, <span class="st">"stdev"</span>]:</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>        df[col] <span class="op">=</span> df[col] <span class="op">/</span> <span class="dv">100</span></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">"sr_s"</span>]<span class="op">=</span> (df[<span class="st">"mean"</span>] <span class="op">-</span> rs)<span class="op">/</span>df[<span class="st">"stdev"</span>]</span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">"sr_b"</span>]<span class="op">=</span> (df[<span class="st">"mean"</span>] <span class="op">-</span> rb)<span class="op">/</span>df[<span class="st">"stdev"</span>]</span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> rf_plus_risky(mn, sd, rs, rb, w_min, w_max):</span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>    mn <span class="op">/=</span> <span class="dv">100</span></span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>    sd <span class="op">/=</span> <span class="dv">100</span></span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a>    rs <span class="op">/=</span> <span class="dv">100</span></span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a>    rb <span class="op">/=</span> <span class="dv">100</span></span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>    grid <span class="op">=</span> np.linspace(w_min, w_max, <span class="dv">201</span>)</span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>    mns <span class="op">=</span> [(rs <span class="op">+</span> w <span class="op">*</span> (mn <span class="op">-</span> rs) <span class="cf">if</span> w <span class="op">&lt;=</span> <span class="dv">1</span> <span class="cf">else</span> rb <span class="op">+</span> w <span class="op">*</span> (mn <span class="op">-</span> rb)) <span class="cf">for</span> w <span class="kw">in</span> grid]</span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a>    sds <span class="op">=</span> [w <span class="op">*</span> sd <span class="cf">for</span> w <span class="kw">in</span> grid]</span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a>    srs <span class="op">=</span> (mn <span class="op">-</span> rs)<span class="op">/</span>sd</span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a>    srb <span class="op">=</span> (mn <span class="op">-</span> rb)<span class="op">/</span>sd</span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> grid, mns, sds, srs, srb</span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> rf_plus_risky_nokink(mn, sd, rf, w_min, w_max):</span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a>    mn <span class="op">/=</span> <span class="dv">100</span></span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a>    sd <span class="op">/=</span> <span class="dv">100</span></span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a>    rf <span class="op">/=</span> <span class="dv">100</span></span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a>    grid <span class="op">=</span> np.linspace(w_min, w_max, <span class="dv">201</span>)</span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true" tabindex="-1"></a>    mns <span class="op">=</span> [(rf <span class="op">+</span> w <span class="op">*</span> (mn <span class="op">-</span> rf)) <span class="cf">for</span> w <span class="kw">in</span> grid]</span>
<span id="cb8-58"><a href="#cb8-58" aria-hidden="true" tabindex="-1"></a>    sds <span class="op">=</span> [w <span class="op">*</span> sd <span class="cf">for</span> w <span class="kw">in</span> grid]</span>
<span id="cb8-59"><a href="#cb8-59" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> grid, mns, sds</span>
<span id="cb8-60"><a href="#cb8-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-61"><a href="#cb8-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-62"><a href="#cb8-62" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> figtbl(mn1, mn2, sd1, sd2, c, rs, extra, asset1_name, asset2_name):</span>
<span id="cb8-63"><a href="#cb8-63" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> data(mn1, mn2, sd1, sd2, c, rs, extra)</span>
<span id="cb8-64"><a href="#cb8-64" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-65"><a href="#cb8-65" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Plot the portfolios of the two assets</span></span>
<span id="cb8-66"><a href="#cb8-66" aria-hidden="true" tabindex="-1"></a>    trace1 <span class="op">=</span> go.Scatter(</span>
<span id="cb8-67"><a href="#cb8-67" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span>df[<span class="st">"stdev"</span>],</span>
<span id="cb8-68"><a href="#cb8-68" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span>df[<span class="st">"mean"</span>],</span>
<span id="cb8-69"><a href="#cb8-69" aria-hidden="true" tabindex="-1"></a>        mode<span class="op">=</span><span class="st">"lines"</span>,</span>
<span id="cb8-70"><a href="#cb8-70" aria-hidden="true" tabindex="-1"></a>        <span class="co"># line={'color': green},</span></span>
<span id="cb8-71"><a href="#cb8-71" aria-hidden="true" tabindex="-1"></a>        text<span class="op">=</span><span class="dv">100</span> <span class="op">*</span> df[<span class="st">"wt1"</span>],</span>
<span id="cb8-72"><a href="#cb8-72" aria-hidden="true" tabindex="-1"></a>        customdata<span class="op">=</span><span class="dv">100</span> <span class="op">*</span> df[<span class="st">"wt2"</span>],</span>
<span id="cb8-73"><a href="#cb8-73" aria-hidden="true" tabindex="-1"></a>        hovertemplate<span class="op">=</span>asset1_name<span class="op">+</span><span class="st">": %</span><span class="sc">{text:.0f}</span><span class="st">%&lt;br&gt;"</span><span class="op">+</span>asset2_name<span class="op">+</span><span class="st">": %</span><span class="sc">{customdata:.0f}</span><span class="st">%&lt;extra&gt;&lt;/extra&gt;"</span>,</span>
<span id="cb8-74"><a href="#cb8-74" aria-hidden="true" tabindex="-1"></a>        line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">"black"</span>),</span>
<span id="cb8-75"><a href="#cb8-75" aria-hidden="true" tabindex="-1"></a>        name<span class="op">=</span><span class="st">"Stock &amp; Bond Frontier"</span></span>
<span id="cb8-76"><a href="#cb8-76" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb8-77"><a href="#cb8-77" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-78"><a href="#cb8-78" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot the two assets</span></span>
<span id="cb8-79"><a href="#cb8-79" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> df[df.wt1.isin([<span class="dv">0</span>, <span class="dv">1</span>])]</span>
<span id="cb8-80"><a href="#cb8-80" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">"text"</span>] <span class="op">=</span> np.where(df.wt1 <span class="op">==</span> <span class="dv">1</span>, asset1_name, asset2_name)</span>
<span id="cb8-81"><a href="#cb8-81" aria-hidden="true" tabindex="-1"></a>    trace2a <span class="op">=</span> go.Scatter(</span>
<span id="cb8-82"><a href="#cb8-82" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span>df[df.wt1<span class="op">==</span><span class="dv">1</span>][<span class="st">"stdev"</span>],</span>
<span id="cb8-83"><a href="#cb8-83" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span>df[df.wt1<span class="op">==</span><span class="dv">1</span>][<span class="st">"mean"</span>],</span>
<span id="cb8-84"><a href="#cb8-84" aria-hidden="true" tabindex="-1"></a>        mode<span class="op">=</span><span class="st">"markers"</span>,</span>
<span id="cb8-85"><a href="#cb8-85" aria-hidden="true" tabindex="-1"></a>        text<span class="op">=</span>df[df.wt1<span class="op">==</span><span class="dv">1</span>][<span class="st">"text"</span>],</span>
<span id="cb8-86"><a href="#cb8-86" aria-hidden="true" tabindex="-1"></a>        hovertemplate<span class="op">=</span><span class="st">"%</span><span class="sc">{text}</span><span class="st">&lt;extra&gt;&lt;/extra&gt;"</span>,</span>
<span id="cb8-87"><a href="#cb8-87" aria-hidden="true" tabindex="-1"></a>        marker<span class="op">=</span><span class="bu">dict</span>(size<span class="op">=</span><span class="dv">10</span>, color<span class="op">=</span><span class="st">"orange"</span>),</span>
<span id="cb8-88"><a href="#cb8-88" aria-hidden="true" tabindex="-1"></a>        name<span class="op">=</span>asset1_name</span>
<span id="cb8-89"><a href="#cb8-89" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb8-90"><a href="#cb8-90" aria-hidden="true" tabindex="-1"></a>    trace2b <span class="op">=</span> go.Scatter(</span>
<span id="cb8-91"><a href="#cb8-91" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span>df[df.wt1<span class="op">==</span><span class="dv">0</span>][<span class="st">"stdev"</span>],</span>
<span id="cb8-92"><a href="#cb8-92" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span>df[df.wt1<span class="op">==</span><span class="dv">0</span>][<span class="st">"mean"</span>],</span>
<span id="cb8-93"><a href="#cb8-93" aria-hidden="true" tabindex="-1"></a>        mode<span class="op">=</span><span class="st">"markers"</span>,</span>
<span id="cb8-94"><a href="#cb8-94" aria-hidden="true" tabindex="-1"></a>        text<span class="op">=</span>df[df.wt1<span class="op">==</span><span class="dv">0</span>][<span class="st">"text"</span>],</span>
<span id="cb8-95"><a href="#cb8-95" aria-hidden="true" tabindex="-1"></a>        hovertemplate<span class="op">=</span><span class="st">"%</span><span class="sc">{text}</span><span class="st">&lt;extra&gt;&lt;/extra&gt;"</span>,</span>
<span id="cb8-96"><a href="#cb8-96" aria-hidden="true" tabindex="-1"></a>        marker<span class="op">=</span><span class="bu">dict</span>(size<span class="op">=</span><span class="dv">10</span>, color<span class="op">=</span><span class="st">"red"</span>),</span>
<span id="cb8-97"><a href="#cb8-97" aria-hidden="true" tabindex="-1"></a>        name<span class="op">=</span>asset2_name</span>
<span id="cb8-98"><a href="#cb8-98" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb8-99"><a href="#cb8-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-100"><a href="#cb8-100" aria-hidden="true" tabindex="-1"></a>    fig <span class="op">=</span> go.Figure()</span>
<span id="cb8-101"><a href="#cb8-101" aria-hidden="true" tabindex="-1"></a>    fig.add_trace(trace2a)</span>
<span id="cb8-102"><a href="#cb8-102" aria-hidden="true" tabindex="-1"></a>    fig.add_trace(trace2b)</span>
<span id="cb8-103"><a href="#cb8-103" aria-hidden="true" tabindex="-1"></a>    fig.add_trace(trace1)</span>
<span id="cb8-104"><a href="#cb8-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-105"><a href="#cb8-105" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot the combination of the risk-free and each asset (CAL for each asset)</span></span>
<span id="cb8-106"><a href="#cb8-106" aria-hidden="true" tabindex="-1"></a>    grid, mns_cal, sds_cal, srs_cal, srb_cal <span class="op">=</span> rf_plus_risky(mn1, sd1, rs, rs <span class="op">+</span> extra, <span class="dv">0</span>, <span class="fl">1.0</span>)</span>
<span id="cb8-107"><a href="#cb8-107" aria-hidden="true" tabindex="-1"></a>    string <span class="op">=</span> <span class="st">"wealth in "</span><span class="op">+</span>asset1_name<span class="op">+</span><span class="st">"= %</span><span class="sc">{text:.0f}</span><span class="st">%&lt;br&gt;"</span> <span class="op">+</span> <span class="st">"Sharpe ratio: "</span> <span class="op">+</span> <span class="st">"</span><span class="sc">{:.4f}</span><span class="st">"</span>.<span class="bu">format</span>(srs_cal) <span class="op">+</span><span class="st">"&lt;extra&gt;&lt;/extra&gt;"</span></span>
<span id="cb8-108"><a href="#cb8-108" aria-hidden="true" tabindex="-1"></a>    trace3 <span class="op">=</span> go.Scatter(</span>
<span id="cb8-109"><a href="#cb8-109" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span>sds_cal, </span>
<span id="cb8-110"><a href="#cb8-110" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span>mns_cal, </span>
<span id="cb8-111"><a href="#cb8-111" aria-hidden="true" tabindex="-1"></a>        mode<span class="op">=</span><span class="st">"lines"</span>, </span>
<span id="cb8-112"><a href="#cb8-112" aria-hidden="true" tabindex="-1"></a>        text<span class="op">=</span><span class="dv">100</span> <span class="op">*</span> grid, </span>
<span id="cb8-113"><a href="#cb8-113" aria-hidden="true" tabindex="-1"></a>        hovertemplate<span class="op">=</span>string, </span>
<span id="cb8-114"><a href="#cb8-114" aria-hidden="true" tabindex="-1"></a>        line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">"orange"</span>),</span>
<span id="cb8-115"><a href="#cb8-115" aria-hidden="true" tabindex="-1"></a>        name<span class="op">=</span><span class="st">"CAL: "</span><span class="op">+</span>asset1_name</span>
<span id="cb8-116"><a href="#cb8-116" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb8-117"><a href="#cb8-117" aria-hidden="true" tabindex="-1"></a>    grid, mns_cal, sds_cal, srs_cal, srb_cal <span class="op">=</span> rf_plus_risky(mn2, sd2, rs, rs <span class="op">+</span> extra, <span class="dv">0</span>, <span class="fl">1.0</span>)</span>
<span id="cb8-118"><a href="#cb8-118" aria-hidden="true" tabindex="-1"></a>    string <span class="op">=</span> <span class="st">"wealth in "</span><span class="op">+</span>asset2_name<span class="op">+</span><span class="st">"= %</span><span class="sc">{text:.0f}</span><span class="st">%&lt;br&gt;"</span> <span class="op">+</span> <span class="st">"Sharpe ratio : "</span> <span class="op">+</span> <span class="st">"</span><span class="sc">{:.4f}</span><span class="st">"</span>.<span class="bu">format</span>(srs_cal) <span class="op">+</span><span class="st">"&lt;extra&gt;&lt;/extra&gt;"</span></span>
<span id="cb8-119"><a href="#cb8-119" aria-hidden="true" tabindex="-1"></a>    trace4 <span class="op">=</span> go.Scatter(</span>
<span id="cb8-120"><a href="#cb8-120" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span>sds_cal, </span>
<span id="cb8-121"><a href="#cb8-121" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span>mns_cal, </span>
<span id="cb8-122"><a href="#cb8-122" aria-hidden="true" tabindex="-1"></a>        mode<span class="op">=</span><span class="st">"lines"</span>, </span>
<span id="cb8-123"><a href="#cb8-123" aria-hidden="true" tabindex="-1"></a>        text<span class="op">=</span><span class="dv">100</span> <span class="op">*</span> grid, </span>
<span id="cb8-124"><a href="#cb8-124" aria-hidden="true" tabindex="-1"></a>        hovertemplate<span class="op">=</span>string, </span>
<span id="cb8-125"><a href="#cb8-125" aria-hidden="true" tabindex="-1"></a>        line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">"red"</span>),</span>
<span id="cb8-126"><a href="#cb8-126" aria-hidden="true" tabindex="-1"></a>        name<span class="op">=</span><span class="st">"CAL: "</span><span class="op">+</span>asset2_name</span>
<span id="cb8-127"><a href="#cb8-127" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb8-128"><a href="#cb8-128" aria-hidden="true" tabindex="-1"></a>    fig.add_trace(trace3)</span>
<span id="cb8-129"><a href="#cb8-129" aria-hidden="true" tabindex="-1"></a>    fig.add_trace(trace4)  </span>
<span id="cb8-130"><a href="#cb8-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-131"><a href="#cb8-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-132"><a href="#cb8-132" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> custom(string, ports,srTang,borrow_flag):</span>
<span id="cb8-133"><a href="#cb8-133" aria-hidden="true" tabindex="-1"></a>        <span class="co"># borrow_flag=1 adds statement about "relative to borrowing rate"</span></span>
<span id="cb8-134"><a href="#cb8-134" aria-hidden="true" tabindex="-1"></a>        cd <span class="op">=</span> np.empty(shape<span class="op">=</span>(<span class="bu">len</span>(ports), N<span class="op">+</span><span class="dv">1</span>, <span class="dv">1</span>), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb8-135"><a href="#cb8-135" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(N):</span>
<span id="cb8-136"><a href="#cb8-136" aria-hidden="true" tabindex="-1"></a>            cd[:, i] <span class="op">=</span> np.array([w[i] <span class="cf">for</span> w <span class="kw">in</span> ports]).reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb8-137"><a href="#cb8-137" aria-hidden="true" tabindex="-1"></a>        cd[:,N] <span class="op">=</span> np.<span class="bu">round</span>(srTang,<span class="dv">4</span>)</span>
<span id="cb8-138"><a href="#cb8-138" aria-hidden="true" tabindex="-1"></a>        <span class="co"># print(cd)</span></span>
<span id="cb8-139"><a href="#cb8-139" aria-hidden="true" tabindex="-1"></a>        string <span class="op">+=</span> <span class="st">"&lt;br&gt;"</span></span>
<span id="cb8-140"><a href="#cb8-140" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(N):</span>
<span id="cb8-141"><a href="#cb8-141" aria-hidden="true" tabindex="-1"></a>            string <span class="op">+=</span> <span class="st">"asset "</span> <span class="op">+</span> <span class="bu">str</span>(i <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb8-142"><a href="#cb8-142" aria-hidden="true" tabindex="-1"></a>            string <span class="op">+=</span> <span class="st">": %{customdata["</span></span>
<span id="cb8-143"><a href="#cb8-143" aria-hidden="true" tabindex="-1"></a>            string <span class="op">+=</span> <span class="bu">str</span>(i)</span>
<span id="cb8-144"><a href="#cb8-144" aria-hidden="true" tabindex="-1"></a>            string <span class="op">+=</span> <span class="st">"]:.1%}&lt;br&gt;"</span></span>
<span id="cb8-145"><a href="#cb8-145" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> borrow_flag<span class="op">==</span><span class="dv">1</span>:</span>
<span id="cb8-146"><a href="#cb8-146" aria-hidden="true" tabindex="-1"></a>            string <span class="op">+=</span> <span class="st">"Sharpe ratio (relative to borrowing rate): %{customdata["</span> <span class="op">+</span>  <span class="bu">str</span>(N) <span class="op">+</span> <span class="st">"]:.4f}&lt;br&gt;"</span>    </span>
<span id="cb8-147"><a href="#cb8-147" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb8-148"><a href="#cb8-148" aria-hidden="true" tabindex="-1"></a>            string <span class="op">+=</span> <span class="st">"Sharpe ratio: %{customdata["</span> <span class="op">+</span>  <span class="bu">str</span>(N) <span class="op">+</span> <span class="st">"]:.4f}&lt;br&gt;"</span></span>
<span id="cb8-149"><a href="#cb8-149" aria-hidden="true" tabindex="-1"></a>        string <span class="op">+=</span> <span class="st">"&lt;extra&gt;&lt;/extra&gt;"</span></span>
<span id="cb8-150"><a href="#cb8-150" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> string, cd  </span>
<span id="cb8-151"><a href="#cb8-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-152"><a href="#cb8-152" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot the tangency portfolios</span></span>
<span id="cb8-153"><a href="#cb8-153" aria-hidden="true" tabindex="-1"></a>    c <span class="op">=</span> c <span class="op">/</span> <span class="dv">100</span></span>
<span id="cb8-154"><a href="#cb8-154" aria-hidden="true" tabindex="-1"></a>    rb <span class="op">=</span> rs <span class="op">+</span> extra     </span>
<span id="cb8-155"><a href="#cb8-155" aria-hidden="true" tabindex="-1"></a>    rs <span class="op">=</span> rs<span class="op">/</span><span class="dv">100</span></span>
<span id="cb8-156"><a href="#cb8-156" aria-hidden="true" tabindex="-1"></a>    rb <span class="op">=</span> rb<span class="op">/</span><span class="dv">100</span></span>
<span id="cb8-157"><a href="#cb8-157" aria-hidden="true" tabindex="-1"></a>    mns <span class="op">=</span> [mn1, mn2]</span>
<span id="cb8-158"><a href="#cb8-158" aria-hidden="true" tabindex="-1"></a>    mns <span class="op">=</span> np.array(mns) <span class="op">/</span> <span class="dv">100</span></span>
<span id="cb8-159"><a href="#cb8-159" aria-hidden="true" tabindex="-1"></a>    sds <span class="op">=</span> [sd1, sd2]</span>
<span id="cb8-160"><a href="#cb8-160" aria-hidden="true" tabindex="-1"></a>    sds <span class="op">=</span> np.array(sds) <span class="op">/</span> <span class="dv">100</span></span>
<span id="cb8-161"><a href="#cb8-161" aria-hidden="true" tabindex="-1"></a>    cov <span class="op">=</span> np.array(</span>
<span id="cb8-162"><a href="#cb8-162" aria-hidden="true" tabindex="-1"></a>        [[sds[<span class="dv">0</span>] <span class="op">**</span> <span class="dv">2</span>, sds[<span class="dv">0</span>] <span class="op">*</span> sds[<span class="dv">1</span>] <span class="op">*</span> c], [sds[<span class="dv">0</span>] <span class="op">*</span> sds[<span class="dv">1</span>] <span class="op">*</span> c, sds[<span class="dv">1</span>] <span class="op">**</span> <span class="dv">2</span>]]</span>
<span id="cb8-163"><a href="#cb8-163" aria-hidden="true" tabindex="-1"></a>    ).reshape(<span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb8-164"><a href="#cb8-164" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-165"><a href="#cb8-165" aria-hidden="true" tabindex="-1"></a>    Shorts <span class="op">=</span> <span class="fl">0.0</span>     </span>
<span id="cb8-166"><a href="#cb8-166" aria-hidden="true" tabindex="-1"></a>    N <span class="op">=</span> <span class="bu">len</span>(mns)</span>
<span id="cb8-167"><a href="#cb8-167" aria-hidden="true" tabindex="-1"></a>    P <span class="op">=</span> portfolio(mns, cov, Shorts)    </span>
<span id="cb8-168"><a href="#cb8-168" aria-hidden="true" tabindex="-1"></a>    gmv <span class="op">=</span> P.GMV <span class="op">@</span> mns</span>
<span id="cb8-169"><a href="#cb8-169" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print('GMV return is: ',gmv)</span></span>
<span id="cb8-170"><a href="#cb8-170" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (rs <span class="op">&lt;</span> gmv) <span class="kw">or</span> (<span class="kw">not</span> Shorts):</span>
<span id="cb8-171"><a href="#cb8-171" aria-hidden="true" tabindex="-1"></a>        portTang <span class="op">=</span> P.tangency(rs)</span>
<span id="cb8-172"><a href="#cb8-172" aria-hidden="true" tabindex="-1"></a>        mnTang <span class="op">=</span> portTang <span class="op">@</span> mns</span>
<span id="cb8-173"><a href="#cb8-173" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> mnTang <span class="op">&lt;</span> np.<span class="bu">max</span>(mns):</span>
<span id="cb8-174"><a href="#cb8-174" aria-hidden="true" tabindex="-1"></a>            sdTang <span class="op">=</span> np.sqrt(portTang <span class="op">@</span> cov <span class="op">@</span> portTang)</span>
<span id="cb8-175"><a href="#cb8-175" aria-hidden="true" tabindex="-1"></a>            srTang <span class="op">=</span> (mnTang <span class="op">-</span> rs)<span class="op">/</span>sdTang</span>
<span id="cb8-176"><a href="#cb8-176" aria-hidden="true" tabindex="-1"></a>            string0 <span class="op">=</span> <span class="st">'tangency portfolio'</span> <span class="cf">if</span> rb <span class="op">==</span> rs <span class="cf">else</span> <span class="st">'efficient low risk portfolio'</span> <span class="cf">if</span> rb <span class="op">!=</span> rs <span class="cf">else</span> <span class="st">'tangency portfolio'</span></span>
<span id="cb8-177"><a href="#cb8-177" aria-hidden="true" tabindex="-1"></a>            string, cd <span class="op">=</span> custom(string0, [portTang], srTang,<span class="dv">0</span>)</span>
<span id="cb8-178"><a href="#cb8-178" aria-hidden="true" tabindex="-1"></a>            trace <span class="op">=</span> go.Scatter(</span>
<span id="cb8-179"><a href="#cb8-179" aria-hidden="true" tabindex="-1"></a>                x<span class="op">=</span>[sdTang],</span>
<span id="cb8-180"><a href="#cb8-180" aria-hidden="true" tabindex="-1"></a>                y<span class="op">=</span>[mnTang],</span>
<span id="cb8-181"><a href="#cb8-181" aria-hidden="true" tabindex="-1"></a>                mode<span class="op">=</span><span class="st">"markers"</span>,</span>
<span id="cb8-182"><a href="#cb8-182" aria-hidden="true" tabindex="-1"></a>                customdata<span class="op">=</span>cd,</span>
<span id="cb8-183"><a href="#cb8-183" aria-hidden="true" tabindex="-1"></a>                hovertemplate<span class="op">=</span>string,</span>
<span id="cb8-184"><a href="#cb8-184" aria-hidden="true" tabindex="-1"></a>                marker<span class="op">=</span><span class="bu">dict</span>(size<span class="op">=</span><span class="dv">10</span>, color<span class="op">=</span><span class="st">"blue"</span>),</span>
<span id="cb8-185"><a href="#cb8-185" aria-hidden="true" tabindex="-1"></a>                name<span class="op">=</span>string0</span>
<span id="cb8-186"><a href="#cb8-186" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb8-187"><a href="#cb8-187" aria-hidden="true" tabindex="-1"></a>            fig.add_trace(trace)</span>
<span id="cb8-188"><a href="#cb8-188" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-189"><a href="#cb8-189" aria-hidden="true" tabindex="-1"></a>            <span class="co">#Plot CAL (no leverage)</span></span>
<span id="cb8-190"><a href="#cb8-190" aria-hidden="true" tabindex="-1"></a>            grid, mns_cal, sds_cal <span class="op">=</span> rf_plus_risky_nokink(mnTang<span class="op">*</span><span class="dv">100</span>, sdTang<span class="op">*</span><span class="dv">100</span>, rs<span class="op">*</span><span class="dv">100</span>,<span class="dv">0</span>, <span class="fl">1.0</span>)</span>
<span id="cb8-191"><a href="#cb8-191" aria-hidden="true" tabindex="-1"></a>            portlabel <span class="op">=</span> <span class="st">'tangency portfolio'</span> <span class="cf">if</span> rb <span class="op">==</span> rs <span class="cf">else</span> <span class="st">'efficient low risk portfolio'</span> <span class="cf">if</span> rb <span class="op">!=</span> rs <span class="cf">else</span> <span class="st">'tangency portfolio'</span></span>
<span id="cb8-192"><a href="#cb8-192" aria-hidden="true" tabindex="-1"></a>            string <span class="op">=</span> <span class="st">"wealth in "</span><span class="op">+</span>portlabel <span class="op">+</span> <span class="st">" = %</span><span class="sc">{text:.0f}</span><span class="st">%&lt;br&gt;"</span> <span class="op">+</span> <span class="st">"Sharpe ratio: "</span> <span class="op">+</span>  <span class="st">"</span><span class="sc">{:.4f}</span><span class="st">"</span>.<span class="bu">format</span>(srTang) <span class="op">+</span><span class="st">"&lt;extra&gt;&lt;/extra&gt;"</span></span>
<span id="cb8-193"><a href="#cb8-193" aria-hidden="true" tabindex="-1"></a>            trace5 <span class="op">=</span> go.Scatter(</span>
<span id="cb8-194"><a href="#cb8-194" aria-hidden="true" tabindex="-1"></a>                x<span class="op">=</span>sds_cal, </span>
<span id="cb8-195"><a href="#cb8-195" aria-hidden="true" tabindex="-1"></a>                y<span class="op">=</span>mns_cal, </span>
<span id="cb8-196"><a href="#cb8-196" aria-hidden="true" tabindex="-1"></a>                mode<span class="op">=</span><span class="st">"lines"</span>, </span>
<span id="cb8-197"><a href="#cb8-197" aria-hidden="true" tabindex="-1"></a>                text<span class="op">=</span><span class="dv">100</span> <span class="op">*</span> grid, </span>
<span id="cb8-198"><a href="#cb8-198" aria-hidden="true" tabindex="-1"></a>                hovertemplate<span class="op">=</span>string, </span>
<span id="cb8-199"><a href="#cb8-199" aria-hidden="true" tabindex="-1"></a>                line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">"blue"</span>),</span>
<span id="cb8-200"><a href="#cb8-200" aria-hidden="true" tabindex="-1"></a>                name<span class="op">=</span><span class="st">"CAL: "</span> <span class="op">+</span> portlabel</span>
<span id="cb8-201"><a href="#cb8-201" aria-hidden="true" tabindex="-1"></a>            )           </span>
<span id="cb8-202"><a href="#cb8-202" aria-hidden="true" tabindex="-1"></a>            fig.add_trace(trace5)</span>
<span id="cb8-203"><a href="#cb8-203" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-204"><a href="#cb8-204" aria-hidden="true" tabindex="-1"></a>            <span class="co">#Plot CAL (with leverage)</span></span>
<span id="cb8-205"><a href="#cb8-205" aria-hidden="true" tabindex="-1"></a>            grid, mns_cal, sds_cal <span class="op">=</span> rf_plus_risky_nokink(mnTang<span class="op">*</span><span class="dv">100</span>, sdTang<span class="op">*</span><span class="dv">100</span>, rs<span class="op">*</span><span class="dv">100</span>,<span class="fl">1.0</span>, <span class="fl">1.5</span>)</span>
<span id="cb8-206"><a href="#cb8-206" aria-hidden="true" tabindex="-1"></a>            trace5a <span class="op">=</span> go.Scatter(</span>
<span id="cb8-207"><a href="#cb8-207" aria-hidden="true" tabindex="-1"></a>                x<span class="op">=</span>sds_cal, </span>
<span id="cb8-208"><a href="#cb8-208" aria-hidden="true" tabindex="-1"></a>                y<span class="op">=</span>mns_cal, </span>
<span id="cb8-209"><a href="#cb8-209" aria-hidden="true" tabindex="-1"></a>                mode<span class="op">=</span><span class="st">"lines"</span>, </span>
<span id="cb8-210"><a href="#cb8-210" aria-hidden="true" tabindex="-1"></a>                text<span class="op">=</span><span class="dv">100</span> <span class="op">*</span> grid, </span>
<span id="cb8-211"><a href="#cb8-211" aria-hidden="true" tabindex="-1"></a>                hovertemplate<span class="op">=</span>string, </span>
<span id="cb8-212"><a href="#cb8-212" aria-hidden="true" tabindex="-1"></a>                line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">"blue"</span>,dash<span class="op">=</span><span class="st">'dot'</span>),</span>
<span id="cb8-213"><a href="#cb8-213" aria-hidden="true" tabindex="-1"></a>                name<span class="op">=</span><span class="st">"CAL: "</span>  <span class="op">+</span> portlabel <span class="op">+</span> <span class="st">" (levered)"</span></span>
<span id="cb8-214"><a href="#cb8-214" aria-hidden="true" tabindex="-1"></a>                <span class="co"># showlegend=False</span></span>
<span id="cb8-215"><a href="#cb8-215" aria-hidden="true" tabindex="-1"></a>            )           </span>
<span id="cb8-216"><a href="#cb8-216" aria-hidden="true" tabindex="-1"></a>            fig.add_trace(trace5a)         </span>
<span id="cb8-217"><a href="#cb8-217" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-218"><a href="#cb8-218" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-219"><a href="#cb8-219" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-220"><a href="#cb8-220" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-221"><a href="#cb8-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-222"><a href="#cb8-222" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (rb <span class="op">!=</span> rs) <span class="kw">and</span> ((gmv <span class="op">&gt;</span> rb) <span class="kw">or</span> (<span class="kw">not</span> Shorts)):</span>
<span id="cb8-223"><a href="#cb8-223" aria-hidden="true" tabindex="-1"></a>        portTang <span class="op">=</span> P.tangency(rb)</span>
<span id="cb8-224"><a href="#cb8-224" aria-hidden="true" tabindex="-1"></a>        mnTang <span class="op">=</span> portTang <span class="op">@</span> mns</span>
<span id="cb8-225"><a href="#cb8-225" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> mnTang <span class="op">&lt;</span> np.<span class="bu">max</span>(mns):</span>
<span id="cb8-226"><a href="#cb8-226" aria-hidden="true" tabindex="-1"></a>            sdTang <span class="op">=</span> np.sqrt(portTang <span class="op">@</span> cov <span class="op">@</span> portTang)</span>
<span id="cb8-227"><a href="#cb8-227" aria-hidden="true" tabindex="-1"></a>            srTang <span class="op">=</span> (mnTang <span class="op">-</span> rb)<span class="op">/</span>sdTang</span>
<span id="cb8-228"><a href="#cb8-228" aria-hidden="true" tabindex="-1"></a>            string <span class="op">=</span> <span class="st">'efficient high mean portfolio'</span></span>
<span id="cb8-229"><a href="#cb8-229" aria-hidden="true" tabindex="-1"></a>            string, cd <span class="op">=</span> custom(string, [portTang], srTang,<span class="dv">1</span>)</span>
<span id="cb8-230"><a href="#cb8-230" aria-hidden="true" tabindex="-1"></a>            trace <span class="op">=</span> go.Scatter(</span>
<span id="cb8-231"><a href="#cb8-231" aria-hidden="true" tabindex="-1"></a>                x<span class="op">=</span>[sdTang],</span>
<span id="cb8-232"><a href="#cb8-232" aria-hidden="true" tabindex="-1"></a>                y<span class="op">=</span>[mnTang],</span>
<span id="cb8-233"><a href="#cb8-233" aria-hidden="true" tabindex="-1"></a>                mode<span class="op">=</span><span class="st">"markers"</span>,</span>
<span id="cb8-234"><a href="#cb8-234" aria-hidden="true" tabindex="-1"></a>                customdata<span class="op">=</span>cd,</span>
<span id="cb8-235"><a href="#cb8-235" aria-hidden="true" tabindex="-1"></a>                hovertemplate<span class="op">=</span>string,</span>
<span id="cb8-236"><a href="#cb8-236" aria-hidden="true" tabindex="-1"></a>                marker<span class="op">=</span><span class="bu">dict</span>(size<span class="op">=</span><span class="dv">10</span>, color<span class="op">=</span><span class="st">"blue"</span>),</span>
<span id="cb8-237"><a href="#cb8-237" aria-hidden="true" tabindex="-1"></a>                name<span class="op">=</span><span class="st">"efficient high mean portfolio"</span></span>
<span id="cb8-238"><a href="#cb8-238" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb8-239"><a href="#cb8-239" aria-hidden="true" tabindex="-1"></a>            fig.add_trace(trace)</span>
<span id="cb8-240"><a href="#cb8-240" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-241"><a href="#cb8-241" aria-hidden="true" tabindex="-1"></a>            <span class="co">#Plot CAL (with leverage)            </span></span>
<span id="cb8-242"><a href="#cb8-242" aria-hidden="true" tabindex="-1"></a>            grid, mns_cal, sds_cal <span class="op">=</span> rf_plus_risky_nokink(mnTang<span class="op">*</span><span class="dv">100</span>, sdTang<span class="op">*</span><span class="dv">100</span>, rb<span class="op">*</span><span class="dv">100</span>, <span class="fl">1.0</span>, <span class="fl">1.5</span>)</span>
<span id="cb8-243"><a href="#cb8-243" aria-hidden="true" tabindex="-1"></a>            string <span class="op">=</span> <span class="st">"wealth in efficient high mean portfolio = %</span><span class="sc">{text:.0f}</span><span class="st">%&lt;br&gt;"</span> <span class="op">+</span> <span class="st">"Sharpe ratio (relative to borrowing rate): "</span> <span class="op">+</span> <span class="st">"</span><span class="sc">{:.4f}</span><span class="st">"</span>.<span class="bu">format</span>(srTang) <span class="op">+</span><span class="st">"&lt;extra&gt;&lt;/extra&gt;"</span></span>
<span id="cb8-244"><a href="#cb8-244" aria-hidden="true" tabindex="-1"></a>            trace6 <span class="op">=</span> go.Scatter(</span>
<span id="cb8-245"><a href="#cb8-245" aria-hidden="true" tabindex="-1"></a>                x<span class="op">=</span>sds_cal, </span>
<span id="cb8-246"><a href="#cb8-246" aria-hidden="true" tabindex="-1"></a>                y<span class="op">=</span>mns_cal, </span>
<span id="cb8-247"><a href="#cb8-247" aria-hidden="true" tabindex="-1"></a>                mode<span class="op">=</span><span class="st">"lines"</span>, </span>
<span id="cb8-248"><a href="#cb8-248" aria-hidden="true" tabindex="-1"></a>                text<span class="op">=</span><span class="dv">100</span> <span class="op">*</span> grid, </span>
<span id="cb8-249"><a href="#cb8-249" aria-hidden="true" tabindex="-1"></a>                hovertemplate<span class="op">=</span>string,</span>
<span id="cb8-250"><a href="#cb8-250" aria-hidden="true" tabindex="-1"></a>                line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">"blue"</span>),</span>
<span id="cb8-251"><a href="#cb8-251" aria-hidden="true" tabindex="-1"></a>                name <span class="op">=</span> <span class="st">"CAL: efficient high mean"</span></span>
<span id="cb8-252"><a href="#cb8-252" aria-hidden="true" tabindex="-1"></a>            )           </span>
<span id="cb8-253"><a href="#cb8-253" aria-hidden="true" tabindex="-1"></a>            fig.add_trace(trace6)   </span>
<span id="cb8-254"><a href="#cb8-254" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-255"><a href="#cb8-255" aria-hidden="true" tabindex="-1"></a>            <span class="co">#Plot CAL (without leverage) </span></span>
<span id="cb8-256"><a href="#cb8-256" aria-hidden="true" tabindex="-1"></a>            grid, mns_cal, sds_cal <span class="op">=</span> rf_plus_risky_nokink(mnTang<span class="op">*</span><span class="dv">100</span>, sdTang<span class="op">*</span><span class="dv">100</span>, rb<span class="op">*</span><span class="dv">100</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb8-257"><a href="#cb8-257" aria-hidden="true" tabindex="-1"></a>            trace6a <span class="op">=</span> go.Scatter(</span>
<span id="cb8-258"><a href="#cb8-258" aria-hidden="true" tabindex="-1"></a>                x<span class="op">=</span>sds_cal, </span>
<span id="cb8-259"><a href="#cb8-259" aria-hidden="true" tabindex="-1"></a>                y<span class="op">=</span>mns_cal, </span>
<span id="cb8-260"><a href="#cb8-260" aria-hidden="true" tabindex="-1"></a>                mode<span class="op">=</span><span class="st">"lines"</span>, </span>
<span id="cb8-261"><a href="#cb8-261" aria-hidden="true" tabindex="-1"></a>                text<span class="op">=</span><span class="dv">100</span> <span class="op">*</span> grid, </span>
<span id="cb8-262"><a href="#cb8-262" aria-hidden="true" tabindex="-1"></a>                hovertemplate<span class="op">=</span>string, </span>
<span id="cb8-263"><a href="#cb8-263" aria-hidden="true" tabindex="-1"></a>                line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">"blue"</span>, dash<span class="op">=</span><span class="st">'dot'</span>),</span>
<span id="cb8-264"><a href="#cb8-264" aria-hidden="true" tabindex="-1"></a>                name <span class="op">=</span> <span class="st">"CAL: efficient high mean (unlevered)"</span></span>
<span id="cb8-265"><a href="#cb8-265" aria-hidden="true" tabindex="-1"></a>            )           </span>
<span id="cb8-266"><a href="#cb8-266" aria-hidden="true" tabindex="-1"></a>            fig.add_trace(trace6a)      </span>
<span id="cb8-267"><a href="#cb8-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-268"><a href="#cb8-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-269"><a href="#cb8-269" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb8-270"><a href="#cb8-270" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-271"><a href="#cb8-271" aria-hidden="true" tabindex="-1"></a>    fig.layout.xaxis[<span class="st">"title"</span>] <span class="op">=</span> <span class="st">"Standard Deviation"</span></span>
<span id="cb8-272"><a href="#cb8-272" aria-hidden="true" tabindex="-1"></a>    fig.layout.yaxis[<span class="st">"title"</span>] <span class="op">=</span> <span class="st">"Expected Return"</span></span>
<span id="cb8-273"><a href="#cb8-273" aria-hidden="true" tabindex="-1"></a>    fig.update_xaxes(<span class="bu">range</span><span class="op">=</span>[<span class="dv">0</span>, <span class="fl">1.25</span> <span class="op">*</span> df[<span class="st">"stdev"</span>].<span class="bu">max</span>()])</span>
<span id="cb8-274"><a href="#cb8-274" aria-hidden="true" tabindex="-1"></a>    fig.update_yaxes(<span class="bu">range</span><span class="op">=</span>[<span class="dv">0</span>, <span class="fl">1.25</span> <span class="op">*</span> df[<span class="st">"mean"</span>].<span class="bu">max</span>()])</span>
<span id="cb8-275"><a href="#cb8-275" aria-hidden="true" tabindex="-1"></a>    fig.update_yaxes(tickformat<span class="op">=</span><span class="st">".0%"</span>)</span>
<span id="cb8-276"><a href="#cb8-276" aria-hidden="true" tabindex="-1"></a>    fig.update_xaxes(tickformat<span class="op">=</span><span class="st">".0%"</span>)</span>
<span id="cb8-277"><a href="#cb8-277" aria-hidden="true" tabindex="-1"></a>    fig.show()</span>
<span id="cb8-278"><a href="#cb8-278" aria-hidden="true" tabindex="-1"></a>figtbl(mn_stock,mn_bond,sd_stock,sd_bond,corr,rs,extra,<span class="st">"Stock"</span>,<span class="st">"Bond"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-two-asset-plus_rf_saveborrow" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">

<div>                            <div id="fc99cf23-6dde-4244-93a2-fba24dcab0a5" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("fc99cf23-6dde-4244-93a2-fba24dcab0a5")) {                    Plotly.newPlot(                        "fc99cf23-6dde-4244-93a2-fba24dcab0a5",                        [{"hovertemplate":"%{text}<extra></extra>","marker":{"color":"orange","size":10},"mode":"markers","name":"Stock","text":["Stock"],"x":[0.2],"y":[0.08],"type":"scatter"},{"hovertemplate":"%{text}<extra></extra>","marker":{"color":"red","size":10},"mode":"markers","name":"Bond","text":["Bond"],"x":[0.035],"y":[0.035],"type":"scatter"},{"customdata":[100.0,99.0,98.0,97.0,96.0,95.0,94.0,93.0,92.0,91.0,90.0,89.0,88.0,87.0,86.0,85.0,84.0,83.0,82.0,81.0,80.0,79.0,78.0,77.0,76.0,75.0,74.0,73.0,72.0,71.0,70.0,69.0,68.0,67.0,65.99999999999999,64.99999999999999,64.0,63.0,62.0,61.0,60.0,59.0,58.00000000000001,57.00000000000001,56.00000000000001,55.00000000000001,54.0,53.0,52.0,51.0,50.0,49.0,48.0,47.0,46.0,44.99999999999999,43.99999999999999,42.99999999999999,42.00000000000001,41.0,40.0,39.0,38.0,37.0,36.0,35.0,34.0,32.99999999999999,31.999999999999996,30.999999999999993,29.999999999999993,29.000000000000004,28.000000000000004,27.0,26.0,25.0,24.0,23.0,21.999999999999996,20.999999999999996,19.999999999999996,18.999999999999993,17.999999999999993,16.999999999999993,16.000000000000004,15.000000000000002,14.000000000000002,13.0,12.0,10.999999999999998,9.999999999999998,8.999999999999996,7.9999999999999964,6.999999999999995,5.999999999999995,4.999999999999993,4.0000000000000036,3.0000000000000027,2.0000000000000018,1.0000000000000009,0.0],"hovertemplate":"Stock: %{text:.0f}%<br>Bond: %{customdata:.0f}%<extra></extra>","line":{"color":"black"},"mode":"lines","name":"Stock & Bond Frontier","text":[0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.000000000000001,8.0,9.0,10.0,11.0,12.0,13.0,14.000000000000002,15.0,16.0,17.0,18.0,19.0,20.0,21.0,22.0,23.0,24.0,25.0,26.0,27.0,28.000000000000004,28.999999999999996,30.0,31.0,32.0,33.0,34.0,35.0,36.0,37.0,38.0,39.0,40.0,41.0,42.0,43.0,44.0,45.0,46.0,47.0,48.0,49.0,50.0,51.0,52.0,53.0,54.0,55.00000000000001,56.00000000000001,57.00000000000001,57.99999999999999,59.0,60.0,61.0,62.0,63.0,64.0,65.0,66.0,67.0,68.0,69.0,70.0,71.0,72.0,73.0,74.0,75.0,76.0,77.0,78.0,79.0,80.0,81.0,82.0,83.0,84.0,85.0,86.0,87.0,88.0,89.0,90.0,91.0,92.0,93.0,94.0,95.0,96.0,97.0,98.0,99.0,100.0],"x":[0.035,0.034607694231196626,0.034333220064538074,0.03417941632035281,0.03414791355266087,0.034239049344279404,0.03445185045828453,0.0347840840040384,0.0352323714785139,0.03579235253514359,0.03645888094826829,0.03722623402924341,0.03808831841916889,0.03903885884602674,0.040071560987812796,0.041180244049786784,0.04235894238528625,0.043601978166133704,0.04490400872973369,0.046260052961491514,0.04766550115125194,0.04911611242759346,0.05060800331963315,0.052137630364258024,0.05370176905838392,0.05529749090148666,0.056922139805175985,0.0585733087677314,0.06024881741578004,0.06194669079135704,0.06366513959774218,0.06540254199952782,0.06715742699061661,0.06892845928932402,0.07071442568528716,0.07251422274285231,0.07432684575575638,0.0761513788450347,0.07798698609383492,0.07983290361749346,0.0816884324736373,0.0835529323243655,0.0854258157701757,0.08730654328284908,0.08919461867175621,0.09108958502485341,0.09299102107192932,0.09489853792340533,0.09681177614319449,0.09873040311879619,0.10065411069598698,0.10258261304919075,0.1045156447619207,0.10645295909461605,0.10839432641979008,0.11033953280669627,0.11228837873974315,0.11424067795667181,0.11619625639408525,0.11815495122930735,0.12011661000877438,0.12208108985424401,0.12404825673906103,0.1260179848275634,0.12799015587145757,0.129964658657652,0.13194138850262263,0.13392024678890047,0.13590114053973204,0.13788398202837052,0.1398686884188166,0.14185518143515238,0.143843387056896,0.14583323523806224,0.14782465964784086,0.14981759743100942,0.15181198898637752,0.1538077777617244,0.15580491006383593,0.15780333488237822,0.15980300372646317,0.161803870472866,0.16380589122494954,0.16580902418143592,0.16781322951424302,0.1698184692546721,0.17182470718729598,0.173831908750954,0.17584004094631006,0.17784907224947788,0.1798589725312585,0.1818697129815737,0.18388126603871316,0.18589360532304494,0.18790670557486766,0.18992054259610783,0.1919350931955905,0.1939503351376326,0.19596624709372787,0.19798280859711023,0.2],"y":[0.035,0.03545,0.0359,0.03635,0.0368,0.03725,0.0377,0.038149999999999996,0.0386,0.03905,0.0395,0.03995,0.0404,0.04085,0.041299999999999996,0.041749999999999995,0.042199999999999994,0.042649999999999993,0.043100000000000006,0.043550000000000005,0.044000000000000004,0.04445,0.0449,0.04535,0.0458,0.04625,0.0467,0.04715,0.047599999999999996,0.048049999999999995,0.048499999999999995,0.048949999999999994,0.04939999999999999,0.04984999999999999,0.050300000000000004,0.05075,0.0512,0.05165,0.0521,0.05255,0.053,0.05345,0.0539,0.05435,0.0548,0.05525,0.0557,0.056150000000000005,0.056600000000000004,0.057050000000000003,0.0575,0.05795,0.0584,0.05885,0.0593,0.059750000000000004,0.060200000000000004,0.06065,0.061099999999999995,0.06155,0.062,0.06245,0.0629,0.06335,0.0638,0.06425,0.0647,0.06515,0.0656,0.06605,0.0665,0.06695000000000001,0.0674,0.06785000000000001,0.0683,0.06875,0.0692,0.06965,0.0701,0.07055,0.07100000000000001,0.07145,0.0719,0.07235,0.0728,0.07325,0.0737,0.07415,0.0746,0.07505,0.0755,0.07595,0.07640000000000001,0.07685,0.07730000000000001,0.07775,0.0782,0.07865,0.0791,0.07955,0.08],"type":"scatter"},{"hovertemplate":"wealth in Stock= %{text:.0f}%<br>Sharpe ratio: 0.3000<extra></extra>","line":{"color":"orange"},"mode":"lines","name":"CAL: Stock","text":[0.0,0.5,1.0,1.5,2.0,2.5,3.0,3.5000000000000004,4.0,4.5,5.0,5.5,6.0,6.5,7.000000000000001,7.5,8.0,8.5,9.0,9.5,10.0,10.5,11.0,11.5,12.0,12.5,13.0,13.5,14.000000000000002,14.499999999999998,15.0,15.5,16.0,16.5,17.0,17.5,18.0,18.5,19.0,19.5,20.0,20.5,21.0,21.5,22.0,22.5,23.0,23.5,24.0,24.5,25.0,25.5,26.0,26.5,27.0,27.500000000000004,28.000000000000004,28.500000000000004,28.999999999999996,29.5,30.0,30.5,31.0,31.5,32.0,32.5,33.0,33.5,34.0,34.5,35.0,35.5,36.0,36.5,37.0,37.5,38.0,38.5,39.0,39.5,40.0,40.5,41.0,41.5,42.0,42.5,43.0,43.5,44.0,44.5,45.0,45.5,46.0,46.5,47.0,47.5,48.0,48.5,49.0,49.5,50.0,50.5,51.0,51.5,52.0,52.5,53.0,53.5,54.0,54.50000000000001,55.00000000000001,55.50000000000001,56.00000000000001,56.50000000000001,57.00000000000001,57.50000000000001,57.99999999999999,58.5,59.0,59.5,60.0,60.5,61.0,61.5,62.0,62.5,63.0,63.5,64.0,64.5,65.0,65.5,66.0,66.5,67.0,67.5,68.0,68.5,69.0,69.5,70.0,70.5,71.0,71.5,72.0,72.5,73.0,73.5,74.0,74.5,75.0,75.5,76.0,76.5,77.0,77.5,78.0,78.5,79.0,79.5,80.0,80.5,81.0,81.5,82.0,82.5,83.0,83.5,84.0,84.5,85.0,85.5,86.0,86.5,87.0,87.5,88.0,88.5,89.0,89.5,90.0,90.5,91.0,91.5,92.0,92.5,93.0,93.5,94.0,94.5,95.0,95.5,96.0,96.5,97.0,97.5,98.0,98.5,99.0,99.5,100.0],"x":[0.0,0.001,0.002,0.003,0.004,0.005000000000000001,0.006,0.007000000000000001,0.008,0.009,0.010000000000000002,0.011000000000000001,0.012,0.013000000000000001,0.014000000000000002,0.015,0.016,0.017,0.018,0.019000000000000003,0.020000000000000004,0.021,0.022000000000000002,0.023000000000000003,0.024,0.025,0.026000000000000002,0.027000000000000003,0.028000000000000004,0.028999999999999998,0.03,0.031,0.032,0.033,0.034,0.035,0.036,0.037,0.038000000000000006,0.03900000000000001,0.04000000000000001,0.04100000000000001,0.042,0.043000000000000003,0.044000000000000004,0.045000000000000005,0.046000000000000006,0.04700000000000001,0.048,0.049,0.05,0.051000000000000004,0.052000000000000005,0.053000000000000005,0.054000000000000006,0.05500000000000001,0.05600000000000001,0.05700000000000001,0.057999999999999996,0.059,0.06,0.061,0.062,0.063,0.064,0.065,0.066,0.067,0.068,0.069,0.07,0.071,0.072,0.073,0.074,0.07500000000000001,0.07600000000000001,0.07700000000000001,0.07800000000000001,0.07900000000000001,0.08000000000000002,0.08100000000000002,0.08200000000000002,0.08300000000000002,0.084,0.085,0.08600000000000001,0.08700000000000001,0.08800000000000001,0.08900000000000001,0.09000000000000001,0.09100000000000001,0.09200000000000001,0.09300000000000001,0.09400000000000001,0.09500000000000001,0.096,0.097,0.098,0.099,0.1,0.101,0.10200000000000001,0.10300000000000001,0.10400000000000001,0.10500000000000001,0.10600000000000001,0.10700000000000001,0.10800000000000001,0.10900000000000001,0.11000000000000001,0.11100000000000002,0.11200000000000002,0.11300000000000002,0.11400000000000002,0.11500000000000002,0.11599999999999999,0.11699999999999999,0.118,0.119,0.12,0.121,0.122,0.123,0.124,0.125,0.126,0.127,0.128,0.129,0.13,0.131,0.132,0.133,0.134,0.135,0.136,0.137,0.138,0.139,0.14,0.141,0.142,0.143,0.144,0.145,0.146,0.147,0.148,0.149,0.15000000000000002,0.15100000000000002,0.15200000000000002,0.15300000000000002,0.15400000000000003,0.15500000000000003,0.15600000000000003,0.15700000000000003,0.15800000000000003,0.15900000000000003,0.16000000000000003,0.16100000000000003,0.16200000000000003,0.16300000000000003,0.16400000000000003,0.16500000000000004,0.16600000000000004,0.167,0.168,0.169,0.17,0.171,0.17200000000000001,0.17300000000000001,0.17400000000000002,0.17500000000000002,0.17600000000000002,0.17700000000000002,0.17800000000000002,0.17900000000000002,0.18000000000000002,0.18100000000000002,0.18200000000000002,0.18300000000000002,0.18400000000000002,0.18500000000000003,0.18600000000000003,0.18700000000000003,0.18800000000000003,0.18900000000000003,0.19000000000000003,0.19100000000000003,0.192,0.193,0.194,0.195,0.196,0.197,0.198,0.199,0.2],"y":[0.02,0.020300000000000002,0.0206,0.020900000000000002,0.0212,0.021500000000000002,0.0218,0.0221,0.0224,0.0227,0.023,0.0233,0.0236,0.0239,0.0242,0.0245,0.0248,0.0251,0.0254,0.0257,0.026000000000000002,0.0263,0.0266,0.0269,0.027200000000000002,0.0275,0.0278,0.0281,0.0284,0.0287,0.028999999999999998,0.0293,0.0296,0.029900000000000003,0.0302,0.0305,0.0308,0.0311,0.0314,0.0317,0.032,0.0323,0.0326,0.0329,0.0332,0.0335,0.0338,0.0341,0.0344,0.0347,0.035,0.0353,0.0356,0.0359,0.036199999999999996,0.036500000000000005,0.0368,0.0371,0.0374,0.0377,0.038,0.0383,0.038599999999999995,0.038900000000000004,0.0392,0.0395,0.0398,0.0401,0.040400000000000005,0.0407,0.041,0.0413,0.0416,0.0419,0.0422,0.042499999999999996,0.042800000000000005,0.0431,0.0434,0.0437,0.044,0.044300000000000006,0.0446,0.0449,0.0452,0.0455,0.0458,0.0461,0.0464,0.0467,0.047,0.0473,0.0476,0.0479,0.0482,0.0485,0.048799999999999996,0.0491,0.0494,0.049699999999999994,0.05,0.0503,0.0506,0.0509,0.051199999999999996,0.051500000000000004,0.0518,0.05210000000000001,0.0524,0.0527,0.053000000000000005,0.0533,0.05360000000000001,0.0539,0.0542,0.05450000000000001,0.0548,0.055099999999999996,0.05539999999999999,0.0557,0.055999999999999994,0.0563,0.0566,0.05689999999999999,0.0572,0.057499999999999996,0.057800000000000004,0.0581,0.058399999999999994,0.0587,0.059,0.059300000000000005,0.0596,0.059899999999999995,0.060200000000000004,0.0605,0.06080000000000001,0.0611,0.061399999999999996,0.061700000000000005,0.062,0.062299999999999994,0.0626,0.0629,0.06319999999999999,0.0635,0.0638,0.0641,0.0644,0.0647,0.065,0.0653,0.0656,0.0659,0.0662,0.0665,0.0668,0.0671,0.0674,0.0677,0.068,0.0683,0.06860000000000001,0.0689,0.0692,0.0695,0.0698,0.0701,0.07039999999999999,0.0707,0.071,0.0713,0.0716,0.07189999999999999,0.0722,0.0725,0.0728,0.0731,0.07339999999999999,0.0737,0.074,0.0743,0.0746,0.0749,0.0752,0.0755,0.0758,0.0761,0.0764,0.0767,0.077,0.07730000000000001,0.0776,0.0779,0.07819999999999999,0.0785,0.0788,0.0791,0.0794,0.0797,0.08],"type":"scatter"},{"hovertemplate":"wealth in Bond= %{text:.0f}%<br>Sharpe ratio : 0.4286<extra></extra>","line":{"color":"red"},"mode":"lines","name":"CAL: Bond","text":[0.0,0.5,1.0,1.5,2.0,2.5,3.0,3.5000000000000004,4.0,4.5,5.0,5.5,6.0,6.5,7.000000000000001,7.5,8.0,8.5,9.0,9.5,10.0,10.5,11.0,11.5,12.0,12.5,13.0,13.5,14.000000000000002,14.499999999999998,15.0,15.5,16.0,16.5,17.0,17.5,18.0,18.5,19.0,19.5,20.0,20.5,21.0,21.5,22.0,22.5,23.0,23.5,24.0,24.5,25.0,25.5,26.0,26.5,27.0,27.500000000000004,28.000000000000004,28.500000000000004,28.999999999999996,29.5,30.0,30.5,31.0,31.5,32.0,32.5,33.0,33.5,34.0,34.5,35.0,35.5,36.0,36.5,37.0,37.5,38.0,38.5,39.0,39.5,40.0,40.5,41.0,41.5,42.0,42.5,43.0,43.5,44.0,44.5,45.0,45.5,46.0,46.5,47.0,47.5,48.0,48.5,49.0,49.5,50.0,50.5,51.0,51.5,52.0,52.5,53.0,53.5,54.0,54.50000000000001,55.00000000000001,55.50000000000001,56.00000000000001,56.50000000000001,57.00000000000001,57.50000000000001,57.99999999999999,58.5,59.0,59.5,60.0,60.5,61.0,61.5,62.0,62.5,63.0,63.5,64.0,64.5,65.0,65.5,66.0,66.5,67.0,67.5,68.0,68.5,69.0,69.5,70.0,70.5,71.0,71.5,72.0,72.5,73.0,73.5,74.0,74.5,75.0,75.5,76.0,76.5,77.0,77.5,78.0,78.5,79.0,79.5,80.0,80.5,81.0,81.5,82.0,82.5,83.0,83.5,84.0,84.5,85.0,85.5,86.0,86.5,87.0,87.5,88.0,88.5,89.0,89.5,90.0,90.5,91.0,91.5,92.0,92.5,93.0,93.5,94.0,94.5,95.0,95.5,96.0,96.5,97.0,97.5,98.0,98.5,99.0,99.5,100.0],"x":[0.0,0.00017500000000000003,0.00035000000000000005,0.0005250000000000001,0.0007000000000000001,0.0008750000000000001,0.0010500000000000002,0.0012250000000000002,0.0014000000000000002,0.001575,0.0017500000000000003,0.0019250000000000003,0.0021000000000000003,0.002275,0.0024500000000000004,0.002625,0.0028000000000000004,0.0029750000000000006,0.00315,0.0033250000000000003,0.0035000000000000005,0.0036750000000000003,0.0038500000000000006,0.004025000000000001,0.004200000000000001,0.004375,0.00455,0.004725000000000001,0.004900000000000001,0.0050750000000000005,0.00525,0.005425,0.005600000000000001,0.005775000000000001,0.005950000000000001,0.006125000000000001,0.0063,0.006475000000000001,0.0066500000000000005,0.006825000000000001,0.007000000000000001,0.007175000000000001,0.007350000000000001,0.0075250000000000004,0.007700000000000001,0.007875000000000002,0.008050000000000002,0.008225000000000001,0.008400000000000001,0.008575000000000001,0.00875,0.008925,0.0091,0.009275000000000002,0.009450000000000002,0.009625000000000002,0.009800000000000001,0.009975000000000001,0.010150000000000001,0.010325,0.0105,0.010675,0.01085,0.011025000000000002,0.011200000000000002,0.011375000000000001,0.011550000000000001,0.011725000000000001,0.011900000000000003,0.012075000000000002,0.012250000000000002,0.012425,0.0126,0.012775000000000002,0.012950000000000001,0.013125000000000001,0.013300000000000001,0.013475,0.013650000000000002,0.013825000000000002,0.014000000000000002,0.014175000000000002,0.014350000000000002,0.014525000000000003,0.014700000000000001,0.014875000000000001,0.015050000000000001,0.015225,0.015400000000000002,0.015575000000000002,0.015750000000000004,0.015925,0.016100000000000003,0.016275,0.016450000000000003,0.016625000000000004,0.016800000000000002,0.016975,0.017150000000000002,0.017325,0.0175,0.017675000000000003,0.01785,0.018025000000000003,0.0182,0.018375000000000002,0.018550000000000004,0.018725000000000002,0.018900000000000004,0.019075,0.019250000000000003,0.019425000000000005,0.019600000000000003,0.019775000000000004,0.019950000000000002,0.020125000000000004,0.020300000000000002,0.020475,0.02065,0.020825,0.021,0.021175000000000003,0.02135,0.021525000000000002,0.0217,0.021875000000000002,0.022050000000000004,0.022225,0.022400000000000003,0.022575,0.022750000000000003,0.022925000000000004,0.023100000000000002,0.023275000000000004,0.023450000000000002,0.023625000000000004,0.023800000000000005,0.023975000000000003,0.024150000000000005,0.024325000000000003,0.024500000000000004,0.024675000000000002,0.02485,0.025025000000000002,0.0252,0.025375,0.025550000000000003,0.025725,0.025900000000000003,0.026075,0.026250000000000002,0.026425000000000004,0.026600000000000002,0.026775000000000004,0.02695,0.027125000000000003,0.027300000000000005,0.027475000000000003,0.027650000000000004,0.027825000000000003,0.028000000000000004,0.028175000000000006,0.028350000000000004,0.028525000000000005,0.028700000000000003,0.028875000000000005,0.029050000000000006,0.029225,0.029400000000000003,0.029575,0.029750000000000002,0.029925000000000004,0.030100000000000002,0.030275000000000003,0.03045,0.030625000000000003,0.030800000000000004,0.030975000000000003,0.031150000000000004,0.031325000000000006,0.03150000000000001,0.031675,0.03185,0.032025000000000005,0.032200000000000006,0.03237500000000001,0.03255,0.032725000000000004,0.032900000000000006,0.03307500000000001,0.03325000000000001,0.033425,0.033600000000000005,0.033775,0.03395,0.034125,0.034300000000000004,0.034475000000000006,0.03465,0.034825,0.035],"y":[0.02,0.020075,0.02015,0.020225,0.020300000000000002,0.020375,0.02045,0.020525,0.0206,0.020675,0.02075,0.020825,0.020900000000000002,0.020975,0.02105,0.021125,0.0212,0.021275000000000002,0.02135,0.021425,0.021500000000000002,0.021575,0.021650000000000003,0.021725,0.0218,0.021875000000000002,0.02195,0.022025,0.0221,0.022175,0.02225,0.022325,0.0224,0.022475000000000002,0.02255,0.022625,0.0227,0.022775,0.022850000000000002,0.022925,0.023,0.023075000000000002,0.02315,0.023225000000000003,0.0233,0.023375,0.023450000000000002,0.023525,0.023600000000000003,0.023675,0.02375,0.023825000000000002,0.0239,0.023975000000000003,0.024050000000000002,0.024125,0.024200000000000003,0.024275,0.02435,0.024425000000000002,0.0245,0.024575,0.024650000000000002,0.024725,0.024800000000000003,0.024875,0.02495,0.025025000000000002,0.0251,0.025175000000000003,0.02525,0.025325,0.025400000000000002,0.025475,0.025550000000000003,0.025625000000000002,0.0257,0.025775000000000003,0.02585,0.025925000000000004,0.026000000000000002,0.026075,0.026150000000000003,0.026225000000000002,0.0263,0.026375000000000003,0.02645,0.026525,0.026600000000000002,0.026675,0.026750000000000003,0.026825,0.0269,0.026975000000000002,0.02705,0.027125000000000003,0.027200000000000002,0.027275,0.027350000000000003,0.027425,0.027500000000000004,0.027575000000000002,0.02765,0.027725000000000003,0.027800000000000002,0.027875000000000004,0.027950000000000003,0.028025,0.0281,0.028175000000000002,0.028250000000000004,0.028325000000000003,0.0284,0.028475000000000004,0.028550000000000002,0.028625000000000005,0.028700000000000003,0.028775000000000002,0.02885,0.028925,0.029,0.029075000000000004,0.029150000000000002,0.029225,0.0293,0.029375000000000002,0.029450000000000004,0.029525000000000003,0.0296,0.029675,0.029750000000000002,0.029825000000000004,0.029900000000000003,0.029975,0.030050000000000004,0.030125000000000002,0.030200000000000005,0.030275000000000003,0.030350000000000002,0.030425000000000004,0.030500000000000003,0.030575,0.030650000000000004,0.030725000000000002,0.0308,0.030875,0.030950000000000002,0.031025000000000004,0.031100000000000003,0.031175,0.03125,0.031325000000000006,0.031400000000000004,0.031475,0.03155,0.031625,0.031700000000000006,0.031775000000000005,0.03185,0.031925,0.032,0.032075000000000006,0.032150000000000005,0.032225000000000004,0.0323,0.032375,0.03245000000000001,0.032525,0.032600000000000004,0.032675,0.03275,0.03282500000000001,0.0329,0.032975000000000004,0.03305,0.033125,0.03320000000000001,0.033275,0.033350000000000005,0.033425,0.0335,0.03357500000000001,0.03365,0.033725000000000005,0.033800000000000004,0.033875,0.03395000000000001,0.034025,0.034100000000000005,0.034175000000000004,0.03425,0.03432500000000001,0.0344,0.034475000000000006,0.034550000000000004,0.034625,0.0347,0.034775,0.034850000000000006,0.034925000000000005,0.035],"type":"scatter"},{"customdata":[[[0.11254401505577158],[0.8874559849442285],[0.536]]],"hovertemplate":"efficient low risk portfolio<br>asset 1: %{customdata[0]:.1%}<br>asset 2: %{customdata[1]:.1%}<br>Sharpe ratio: %{customdata[2]:.4f}<br><extra></extra>","marker":{"color":"blue","size":10},"mode":"markers","name":"efficient low risk portfolio","x":[0.03743681229177574],"y":[0.04006448067750973],"type":"scatter"},{"hovertemplate":"wealth in efficient low risk portfolio = %{text:.0f}%<br>Sharpe ratio: 0.5360<extra></extra>","line":{"color":"blue"},"mode":"lines","name":"CAL: efficient low risk portfolio","text":[0.0,0.5,1.0,1.5,2.0,2.5,3.0,3.5000000000000004,4.0,4.5,5.0,5.5,6.0,6.5,7.000000000000001,7.5,8.0,8.5,9.0,9.5,10.0,10.5,11.0,11.5,12.0,12.5,13.0,13.5,14.000000000000002,14.499999999999998,15.0,15.5,16.0,16.5,17.0,17.5,18.0,18.5,19.0,19.5,20.0,20.5,21.0,21.5,22.0,22.5,23.0,23.5,24.0,24.5,25.0,25.5,26.0,26.5,27.0,27.500000000000004,28.000000000000004,28.500000000000004,28.999999999999996,29.5,30.0,30.5,31.0,31.5,32.0,32.5,33.0,33.5,34.0,34.5,35.0,35.5,36.0,36.5,37.0,37.5,38.0,38.5,39.0,39.5,40.0,40.5,41.0,41.5,42.0,42.5,43.0,43.5,44.0,44.5,45.0,45.5,46.0,46.5,47.0,47.5,48.0,48.5,49.0,49.5,50.0,50.5,51.0,51.5,52.0,52.5,53.0,53.5,54.0,54.50000000000001,55.00000000000001,55.50000000000001,56.00000000000001,56.50000000000001,57.00000000000001,57.50000000000001,57.99999999999999,58.5,59.0,59.5,60.0,60.5,61.0,61.5,62.0,62.5,63.0,63.5,64.0,64.5,65.0,65.5,66.0,66.5,67.0,67.5,68.0,68.5,69.0,69.5,70.0,70.5,71.0,71.5,72.0,72.5,73.0,73.5,74.0,74.5,75.0,75.5,76.0,76.5,77.0,77.5,78.0,78.5,79.0,79.5,80.0,80.5,81.0,81.5,82.0,82.5,83.0,83.5,84.0,84.5,85.0,85.5,86.0,86.5,87.0,87.5,88.0,88.5,89.0,89.5,90.0,90.5,91.0,91.5,92.0,92.5,93.0,93.5,94.0,94.5,95.0,95.5,96.0,96.5,97.0,97.5,98.0,98.5,99.0,99.5,100.0],"x":[0.0,0.00018718406145887872,0.00037436812291775744,0.0005615521843766361,0.0007487362458355149,0.0009359203072943936,0.0011231043687532723,0.001310288430212151,0.0014974724916710298,0.0016846565531299083,0.0018718406145887872,0.0020590246760476658,0.0022462087375065445,0.0024333927989654233,0.002620576860424302,0.0028077609218831808,0.0029949449833420595,0.0031821290448009383,0.0033693131062598166,0.0035564971677186957,0.0037436812291775745,0.003930865290636453,0.0041180493520953316,0.00430523341355421,0.004492417475013089,0.004679601536471968,0.0048667855979308465,0.005053969659389725,0.005241153720848604,0.005428337782307482,0.0056155218437663615,0.00580270590522524,0.005989889966684119,0.006177074028142998,0.0063642580896018765,0.006551442151060755,0.006738626212519633,0.006925810273978512,0.0071129943354373915,0.00730017839689627,0.007487362458355149,0.007674546519814028,0.007861730581272906,0.008048914642731785,0.008236098704190663,0.008423282765649543,0.00861046682710842,0.0087976508885673,0.008984834950026178,0.009172019011485056,0.009359203072943936,0.009546387134402815,0.009733571195861693,0.009920755257320573,0.01010793931877945,0.01029512338023833,0.010482307441697208,0.010669491503156088,0.010856675564614964,0.011043859626073843,0.011231043687532723,0.011418227748991601,0.01160541181045048,0.011792595871909358,0.011979779933368238,0.012166963994827116,0.012354148056285996,0.012541332117744875,0.012728516179203753,0.012915700240662633,0.01310288430212151,0.013290068363580388,0.013477252425039266,0.013664436486498146,0.013851620547957024,0.014038804609415903,0.014225988670874783,0.01441317273233366,0.01460035679379254,0.014787540855251418,0.014974724916710298,0.015161908978169176,0.015349093039628055,0.015536277101086935,0.01572346116254581,0.01591064522400469,0.01609782928546357,0.016285013346922447,0.016472197408381326,0.016659381469840206,0.016846565531299085,0.017033749592757965,0.01722093365421684,0.01740811771567572,0.0175953017771346,0.01778248583859348,0.017969669900052356,0.018156853961511236,0.018344038022970112,0.01853122208442899,0.01871840614588787,0.01890559020734675,0.01909277426880563,0.019279958330264507,0.019467142391723386,0.019654326453182266,0.019841510514641145,0.020028694576100025,0.0202158786375589,0.02040306269901778,0.02059024676047666,0.02077743082193554,0.020964614883394416,0.021151798944853296,0.021338983006312175,0.021526167067771055,0.021713351129229928,0.021900535190688807,0.022087719252147687,0.022274903313606566,0.022462087375065446,0.022649271436524322,0.022836455497983202,0.02302363955944208,0.02321082362090096,0.02339800768235984,0.023585191743818717,0.023772375805277596,0.023959559866736476,0.024146743928195356,0.024333927989654232,0.02452111205111311,0.02470829611257199,0.02489548017403087,0.02508266423548975,0.025269848296948626,0.025457032358407506,0.025644216419866386,0.025831400481325265,0.026018584542784145,0.02620576860424302,0.026392952665701897,0.026580136727160777,0.026767320788619653,0.026954504850078533,0.027141688911537412,0.027328872972996292,0.02751605703445517,0.027703241095914048,0.027890425157372927,0.028077609218831807,0.028264793280290686,0.028451977341749566,0.028639161403208442,0.02882634546466732,0.0290135295261262,0.02920071358758508,0.02938789764904396,0.029575081710502837,0.029762265771961716,0.029949449833420596,0.030136633894879476,0.03032381795633835,0.03051100201779723,0.03069818607925611,0.03088537014071499,0.03107255420217387,0.03125973826363274,0.03144692232509162,0.0316341063865505,0.03182129044800938,0.03200847450946826,0.03219565857092714,0.032382842632386014,0.03257002669384489,0.03275721075530377,0.03294439481676265,0.03313157887822153,0.03331876293968041,0.03350594700113929,0.03369313106259817,0.03388031512405705,0.03406749918551593,0.0342546832469748,0.03444186730843368,0.03462905136989256,0.03481623543135144,0.03500341949281032,0.0351906035542692,0.03537778761572808,0.03556497167718696,0.03575215573864584,0.03593933980010471,0.03612652386156359,0.03631370792302247,0.03650089198448135,0.036688076045940224,0.036875260107399103,0.03706244416885798,0.03724962823031686,0.03743681229177574],"y":[0.02,0.02010032240338755,0.0202006448067751,0.020300967210162647,0.020401289613550196,0.020501612016937745,0.02060193442032529,0.02070225682371284,0.02080257922710039,0.020902901630487938,0.021003224033875487,0.021103546437263036,0.021203868840650585,0.021304191244038134,0.021404513647425683,0.02150483605081323,0.02160515845420078,0.021705480857588326,0.021805803260975875,0.021906125664363424,0.022006448067750973,0.022106770471138522,0.02220709287452607,0.02230741527791362,0.02240773768130117,0.022508060084688718,0.022608382488076263,0.022708704891463816,0.02280902729485136,0.02290934969823891,0.02300967210162646,0.023109994505014008,0.023210316908401557,0.023310639311789106,0.023410961715176655,0.023511284118564204,0.023611606521951753,0.0237119289253393,0.023812251328726847,0.023912573732114396,0.024012896135501945,0.024113218538889494,0.024213540942277043,0.024313863345664592,0.02441418574905214,0.02451450815243969,0.02461483055582724,0.024715152959214788,0.024815475362602334,0.024915797765989883,0.02501612016937743,0.02511644257276498,0.02521676497615253,0.02531708737954008,0.025417409782927627,0.025517732186315176,0.025618054589702725,0.025718376993090274,0.02581869939647782,0.02591902179986537,0.026019344203252918,0.026119666606640467,0.026219989010028016,0.026320311413415565,0.026420633816803114,0.026520956220190663,0.02662127862357821,0.02672160102696576,0.02682192343035331,0.02692224583374086,0.027022568237128404,0.027122890640515953,0.027223213043903502,0.02732353544729105,0.0274238578506786,0.02752418025406615,0.027624502657453698,0.027724825060841247,0.027825147464228796,0.02792546986761634,0.028025792271003894,0.02812611467439144,0.02822643707777899,0.028326759481166537,0.028427081884554086,0.028527404287941635,0.028627726691329184,0.028728049094716733,0.02882837149810428,0.02892869390149183,0.029029016304879376,0.02912933870826693,0.029229661111654474,0.029329983515042027,0.029430305918429572,0.02953062832181712,0.02963095072520467,0.029731273128592216,0.029831595531979768,0.029931917935367314,0.030032240338754866,0.03013256274214241,0.030232885145529964,0.03033320754891751,0.03043352995230506,0.030533852355692608,0.030634174759080156,0.030734497162467705,0.030834819565855254,0.030935141969242803,0.031035464372630352,0.0311357867760179,0.031236109179405447,0.031336431582793,0.031436753986180545,0.0315370763895681,0.03163739879295564,0.03173772119634319,0.03183804359973074,0.031938366003118286,0.03203868840650584,0.032139010809893384,0.03223933321328094,0.03233965561666848,0.032439978020056034,0.03254030042344358,0.032640622826831125,0.03274094523021868,0.03284126763360623,0.032941590036993776,0.03304191244038132,0.033142234843768874,0.03324255724715642,0.03334287965054397,0.03344320205393152,0.03354352445731907,0.033643846860706615,0.03374416926409417,0.03384449166748171,0.03394481407086926,0.03404513647425681,0.03414545887764436,0.03424578128103191,0.034346103684419454,0.034446426087807,0.03454674849119455,0.034647070894582105,0.03474739329796965,0.034847715701357196,0.03494803810474475,0.0350483605081323,0.035148682911519846,0.03524900531490739,0.035349327718294944,0.03544965012168249,0.03554997252507004,0.03565029492845759,0.03575061733184513,0.035850939735232686,0.03595126213862024,0.036051584542007784,0.03615190694539533,0.03625222934878288,0.036352551752170434,0.03645287415555798,0.036553196558945525,0.03665351896233308,0.03675384136572062,0.036854163769108175,0.03695448617249572,0.037054808575883266,0.03715513097927082,0.03725545338265837,0.03735577578604592,0.03745609818943346,0.03755642059282101,0.03765674299620856,0.03775706539959611,0.03785738780298366,0.037957710206371204,0.038058032609758756,0.03815835501314631,0.038258677416533854,0.0383589998199214,0.03845932222330895,0.038559644626696504,0.03865996703008405,0.038760289433471595,0.03886061183685914,0.03896093424024669,0.039061256643634246,0.03916157904702179,0.03926190145040934,0.03936222385379688,0.039462546257184435,0.03956286866057199,0.03966319106395953,0.03976351346734708,0.03986383587073463,0.03996415827412218,0.04006448067750973],"type":"scatter"},{"hovertemplate":"wealth in efficient low risk portfolio = %{text:.0f}%<br>Sharpe ratio: 0.5360<extra></extra>","line":{"color":"blue","dash":"dot"},"mode":"lines","name":"CAL: efficient low risk portfolio (levered)","text":[100.0,100.25,100.49999999999999,100.75,101.0,101.25,101.49999999999999,101.75,102.0,102.25,102.49999999999999,102.75000000000001,103.0,103.25,103.49999999999999,103.75000000000001,104.0,104.25,104.5,104.75000000000001,105.0,105.25,105.5,105.75000000000001,106.0,106.25,106.5,106.74999999999999,107.0,107.25,107.5,107.74999999999999,108.0,108.25,108.5,108.74999999999999,109.00000000000001,109.25,109.5,109.74999999999999,110.00000000000001,110.25,110.5,110.75,111.00000000000001,111.25,111.5,111.75,112.00000000000001,112.25,112.5,112.75,112.99999999999999,113.25,113.5,113.75,114.00000000000001,114.25,114.5,114.75,114.99999999999999,115.25000000000001,115.5,115.75,115.99999999999999,116.25000000000001,116.5,116.75,117.0,117.25000000000001,117.5,117.75,118.0,118.25000000000001,118.5,118.75,119.0,119.24999999999999,119.5,119.75,120.0,120.25000000000001,120.5,120.75,121.0,121.24999999999999,121.50000000000001,121.75,122.0,122.24999999999999,122.50000000000001,122.75,123.0,123.25,123.50000000000001,123.75,124.0,124.25,124.50000000000001,124.75,125.0,125.25,125.49999999999999,125.75,126.0,126.25,126.50000000000001,126.75,127.0,127.25,127.49999999999999,127.75000000000001,128.0,128.25,128.5,128.75,129.0,129.25,129.5,129.75,130.0,130.25,130.5,130.75,131.0,131.25,131.5,131.75,132.0,132.25,132.5,132.75,133.0,133.25,133.5,133.75,134.0,134.25,134.5,134.75,135.0,135.25,135.5,135.75,136.0,136.25,136.5,136.75,137.0,137.25,137.5,137.75,138.0,138.25,138.5,138.75,139.0,139.25,139.5,139.75,140.0,140.25,140.5,140.75,141.0,141.25,141.5,141.75,142.0,142.25,142.5,142.75,143.0,143.25,143.5,143.75,144.0,144.25,144.5,144.75,145.0,145.25,145.5,145.75,146.0,146.25,146.5,146.75,147.0,147.25,147.5,147.75,148.0,148.25,148.5,148.75,149.0,149.25,149.5,149.75,150.0],"x":[0.03743681229177574,0.03753040432250518,0.037623996353234615,0.037717588383964065,0.0378111804146935,0.03790477244542294,0.037998364476152374,0.03809195650688182,0.03818554853761126,0.0382791405683407,0.03837273259907013,0.03846632462979958,0.03855991666052901,0.038653508691258456,0.03874710072198789,0.038840692752717336,0.03893428478344677,0.03902787681417621,0.039121468844905645,0.039215060875635095,0.03930865290636453,0.03940224493709397,0.039495836967823404,0.039589428998552854,0.03968302102928229,0.03977661306001173,0.03987020509074116,0.0399637971214706,0.04005738915220005,0.040150981182929486,0.04024457321365892,0.04033816524438836,0.0404317572751178,0.04052534930584724,0.04061894133657668,0.04071253336730612,0.04080612539803556,0.040899717428765,0.040993309459494434,0.04108690149022388,0.04118049352095332,0.04127408555168276,0.04136767758241219,0.04146126961314163,0.04155486164387108,0.041648453674600516,0.04174204570532995,0.04183563773605939,0.04192922976678883,0.042022821797518276,0.04211641382824771,0.04221000585897715,0.042303597889706585,0.04239718992043603,0.04249078195116547,0.04258437398189491,0.04267796601262435,0.04277155804335379,0.04286515007408322,0.04295874210481266,0.0430523341355421,0.043145926166271546,0.04323951819700098,0.04333311022773042,0.043426702258459855,0.043520294289189305,0.04361388631991874,0.04370747835064818,0.043801070381377614,0.043894662412107065,0.0439882544428365,0.04408184647356594,0.044175438504295374,0.04426903053502482,0.04436262256575425,0.0444562145964837,0.04454980662721313,0.04464339865794257,0.04473699068867201,0.04483058271940145,0.04492417475013089,0.045017766780860335,0.04511135881158977,0.04520495084231921,0.045298542873048644,0.04539213490377808,0.04548572693450753,0.04557931896523697,0.045672910995966404,0.04576650302669584,0.04586009505742529,0.04595368708815473,0.04604727911888416,0.0461408711496136,0.04623446318034304,0.046328055211072486,0.04642164724180192,0.04651523927253136,0.0466088313032608,0.04670242333399024,0.04679601536471968,0.04688960739544912,0.046983199426178554,0.047076791456908,0.047170383487637434,0.04726397551836687,0.04735756754909632,0.04745115957982576,0.04754475161055519,0.04763834364128463,0.047731935672014066,0.047825527702743516,0.04791911973347295,0.04801271176420239,0.04810630379493183,0.048199895825661275,0.04829348785639071,0.04838707988712015,0.048480671917849584,0.04857426394857902,0.048667855979308464,0.04876144801003791,0.04885504004076734,0.048948632071496787,0.04904222410222622,0.04913581613295566,0.0492294081636851,0.04932300019441454,0.04941659222514398,0.04951018425587342,0.049603776286602855,0.049697368317332305,0.04979096034806174,0.04988455237879118,0.049978144409520614,0.05007173644025005,0.0501653284709795,0.05025892050170894,0.05035251253243837,0.050446104563167816,0.05053969659389725,0.050633288624626696,0.05072688065535613,0.05082047268608557,0.050914064716815005,0.05100765674754445,0.051101248778273885,0.05119484080900333,0.05128843283973277,0.05138202487046221,0.051475616901191644,0.05156920893192108,0.051662800962650524,0.05175639299337997,0.0518499850241094,0.05194357705483884,0.05203716908556829,0.052130761116297726,0.05222435314702716,0.0523179451777566,0.052411537208486035,0.05250512923921548,0.05259872126994492,0.05269231330067436,0.0527859053314038,0.05287949736213324,0.052973089392862674,0.05306668142359212,0.053160273454321554,0.05325386548505099,0.05334745751578043,0.05344104954650987,0.053534641577239306,0.053628233607968756,0.05372182563869819,0.05381541766942763,0.053909009700157065,0.0540026017308865,0.05409619376161595,0.05418978579234539,0.054283377823074824,0.05437696985380427,0.05447056188453371,0.05456415391526315,0.054657745945992584,0.05475133797672202,0.05484493000745146,0.0549385220381809,0.05503211406891034,0.055125706099639786,0.05521929813036922,0.05531289016109866,0.055406482191828095,0.05550007422255754,0.055593666253286975,0.05568725828401642,0.055780850314745854,0.05587444234547529,0.05596803437620474,0.05606162640693418,0.056155218437663613],"y":[0.04006448067750973,0.0401146418792035,0.040164803080897274,0.040214964282591054,0.040265125484284826,0.0403152866859786,0.04036544788767237,0.04041560908936615,0.040465770291059924,0.0405159314927537,0.04056609269444747,0.04061625389614125,0.04066641509783502,0.040716576299528795,0.04076673750122257,0.04081689870291634,0.04086705990461012,0.04091722110630389,0.040967382307997666,0.041017543509691445,0.04106770471138521,0.04111786591307899,0.041168027114772764,0.041218188316466536,0.041268349518160316,0.04131851071985408,0.04136867192154786,0.041418833123241634,0.04146899432493541,0.04151915552662919,0.04156931672832295,0.04161947793001673,0.04166963913171051,0.04171980033340428,0.04176996153509806,0.04182012273679182,0.0418702839384856,0.04192044514017938,0.04197060634187315,0.04202076754356693,0.04207092874526071,0.042121089946954474,0.04217125114864825,0.04222141235034202,0.0422715735520358,0.04232173475372958,0.042371895955423344,0.042422057157117124,0.0424722183588109,0.04252237956050467,0.04257254076219845,0.042622701963892215,0.042672863165585995,0.04272302436727977,0.04277318556897354,0.04282334677066732,0.04287350797236109,0.042923669174054865,0.04297383037574864,0.04302399157744241,0.04307415277913619,0.04312431398082996,0.043174475182523736,0.04322463638421751,0.04327479758591128,0.04332495878760506,0.043375119989298834,0.04342528119099261,0.04347544239268638,0.04352560359438016,0.04357576479607393,0.043625925997767705,0.04367608719946148,0.04372624840115526,0.04377640960284903,0.0438265708045428,0.043876732006236575,0.04392689320793035,0.04397705440962413,0.0440272156113179,0.04407737681301167,0.04412753801470545,0.044177699216399226,0.044227860418093,0.04427802161978677,0.044328182821480544,0.044378344023174324,0.044428505224868096,0.04447866642656187,0.04452882762825564,0.044578988829949415,0.044629150031643194,0.04467931123333697,0.04472947243503074,0.04477963363672452,0.044829794838418285,0.044879956040112065,0.04493011724180584,0.04498027844349961,0.04503043964519339,0.045080600846887156,0.045130762048580936,0.04518092325027471,0.04523108445196848,0.04528124565366226,0.04533140685535603,0.045381568057049806,0.045431729258743586,0.04548189046043735,0.04553205166213113,0.0455822128638249,0.04563237406551868,0.04568253526721246,0.04573269646890622,0.0457828576706,0.04583301887229378,0.04588318007398755,0.04593334127568133,0.04598350247737509,0.04603366367906887,0.04608382488076265,0.04613398608245642,0.0461841472841502,0.04623430848584397,0.046284469687537744,0.04633463088923152,0.04638479209092529,0.04643495329261907,0.04648511449431284,0.046535275696006614,0.046585436897700394,0.04663559809939417,0.04668575930108794,0.04673592050278171,0.046786081704475485,0.046836242906169265,0.04688640410786304,0.04693656530955681,0.04698672651125058,0.04703688771294436,0.047087048914638135,0.04713721011633191,0.04718737131802568,0.047237532519719454,0.047287693721413226,0.047337854923107006,0.04738801612480078,0.04743817732649455,0.04748833852818833,0.047538499729882104,0.04758866093157588,0.04763882213326965,0.04768898333496342,0.0477391445366572,0.047789305738350975,0.04783946694004475,0.04788962814173853,0.04793978934343229,0.04798995054512607,0.048040111746819845,0.04809027294851362,0.0481404341502074,0.048190595351901164,0.04824075655359494,0.04829091775528872,0.04834107895698249,0.04839124015867627,0.048441401360370034,0.048491562562063814,0.04854172376375759,0.04859188496545136,0.04864204616714514,0.048692207368838905,0.048742368570532685,0.048792529772226464,0.04884269097392023,0.04889285217561401,0.048943013377307776,0.048993174579001555,0.049043335780695335,0.0490934969823891,0.04914365818408288,0.04919381938577666,0.049243980587470426,0.049294141789164206,0.04934430299085797,0.04939446419255175,0.04944462539424553,0.0494947865959393,0.04954494779763308,0.04959510899932685,0.04964527020102062,0.0496954314027144,0.04974559260440817,0.04979575380610195,0.04984591500779572,0.04989607620948949,0.04994623741118327,0.049996398612877045,0.05004655981457082,0.0500967210162646],"type":"scatter"},{"customdata":[[[0.9999034043710491],[9.659562895092362e-05],[0.2]]],"hovertemplate":"efficient high mean portfolio<br>asset 1: %{customdata[0]:.1%}<br>asset 2: %{customdata[1]:.1%}<br>Sharpe ratio (relative to borrowing rate): %{customdata[2]:.4f}<br><extra></extra>","marker":{"color":"blue","size":10},"mode":"markers","name":"efficient high mean portfolio","x":[0.1999805118603658],"y":[0.0799956531966972],"type":"scatter"},{"hovertemplate":"wealth in efficient high mean portfolio = %{text:.0f}%<br>Sharpe ratio (relative to borrowing rate): 0.2000<extra></extra>","line":{"color":"blue"},"mode":"lines","name":"CAL: efficient high mean","text":[100.0,100.25,100.49999999999999,100.75,101.0,101.25,101.49999999999999,101.75,102.0,102.25,102.49999999999999,102.75000000000001,103.0,103.25,103.49999999999999,103.75000000000001,104.0,104.25,104.5,104.75000000000001,105.0,105.25,105.5,105.75000000000001,106.0,106.25,106.5,106.74999999999999,107.0,107.25,107.5,107.74999999999999,108.0,108.25,108.5,108.74999999999999,109.00000000000001,109.25,109.5,109.74999999999999,110.00000000000001,110.25,110.5,110.75,111.00000000000001,111.25,111.5,111.75,112.00000000000001,112.25,112.5,112.75,112.99999999999999,113.25,113.5,113.75,114.00000000000001,114.25,114.5,114.75,114.99999999999999,115.25000000000001,115.5,115.75,115.99999999999999,116.25000000000001,116.5,116.75,117.0,117.25000000000001,117.5,117.75,118.0,118.25000000000001,118.5,118.75,119.0,119.24999999999999,119.5,119.75,120.0,120.25000000000001,120.5,120.75,121.0,121.24999999999999,121.50000000000001,121.75,122.0,122.24999999999999,122.50000000000001,122.75,123.0,123.25,123.50000000000001,123.75,124.0,124.25,124.50000000000001,124.75,125.0,125.25,125.49999999999999,125.75,126.0,126.25,126.50000000000001,126.75,127.0,127.25,127.49999999999999,127.75000000000001,128.0,128.25,128.5,128.75,129.0,129.25,129.5,129.75,130.0,130.25,130.5,130.75,131.0,131.25,131.5,131.75,132.0,132.25,132.5,132.75,133.0,133.25,133.5,133.75,134.0,134.25,134.5,134.75,135.0,135.25,135.5,135.75,136.0,136.25,136.5,136.75,137.0,137.25,137.5,137.75,138.0,138.25,138.5,138.75,139.0,139.25,139.5,139.75,140.0,140.25,140.5,140.75,141.0,141.25,141.5,141.75,142.0,142.25,142.5,142.75,143.0,143.25,143.5,143.75,144.0,144.25,144.5,144.75,145.0,145.25,145.5,145.75,146.0,146.25,146.5,146.75,147.0,147.25,147.5,147.75,148.0,148.25,148.5,148.75,149.0,149.25,149.5,149.75,150.0],"x":[0.1999805118603658,0.20048046314001672,0.2009804144196676,0.20148036569931857,0.20198031697896945,0.20248026825862037,0.20298021953827128,0.20348017081792222,0.20398012209757313,0.20448007337722404,0.20498002465687493,0.2054799759365259,0.20597992721617678,0.2064798784958277,0.2069798297754786,0.20747978105512954,0.20797973233478045,0.20847968361443134,0.20897963489408225,0.2094795861737332,0.2099795374533841,0.21047948873303501,0.21097944001268593,0.21147939129233687,0.21197934257198778,0.21247929385163866,0.21297924513128957,0.21347919641094049,0.21397914769059143,0.21447909897024234,0.21497905024989322,0.21547900152954413,0.21597895280919507,0.21647890408884599,0.2169788553684969,0.2174788066481478,0.21797875792779875,0.21847870920744966,0.21897866048710055,0.21947861176675146,0.2199785630464024,0.2204785143260533,0.22097846560570422,0.2214784168853551,0.22197836816500607,0.22247831944465696,0.22297827072430787,0.22347822200395878,0.22397817328360972,0.22447812456326063,0.22497807584291152,0.22547802712256243,0.22597797840221334,0.22647792968186428,0.2269778809615152,0.2274778322411661,0.22797778352081705,0.22847773480046796,0.22897768608011884,0.22947763735976975,0.22997758863942067,0.2304775399190716,0.23097749119872252,0.2314774424783734,0.23197739375802431,0.23247734503767525,0.23297729631732617,0.23347724759697708,0.233977198876628,0.23447715015627893,0.23497710143592984,0.23547705271558073,0.23597700399523164,0.23647695527488258,0.2369769065545335,0.2374768578341844,0.23797680911383529,0.2384767603934862,0.23897671167313714,0.23947666295278805,0.23997661423243896,0.2404765655120899,0.2409765167917408,0.24147646807139173,0.2419764193510426,0.24247637063069352,0.24297632191034446,0.24347627318999537,0.24397622446964629,0.24447617574929717,0.24497612702894814,0.24547607830859902,0.24597602958824993,0.24647598086790085,0.24697593214755179,0.2474758834272027,0.2479758347068536,0.2484757859865045,0.24897573726615546,0.24947568854580635,0.24997563982545726,0.25047559110510814,0.25097554238475905,0.25147549366441,0.25197544494406093,0.25247539622371185,0.25297534750336276,0.25347529878301367,0.2539752500626646,0.2544752013423155,0.2549751526219664,0.2554751039016173,0.25597505518126823,0.25647500646091914,0.2569749577405701,0.25747490902022097,0.2579748602998719,0.2584748115795228,0.2589747628591737,0.2594747141388246,0.2599746654184756,0.26047461669812644,0.26097456797777735,0.2614745192574283,0.26197447053707923,0.26247442181673014,0.262974373096381,0.2634743243760319,0.2639742756556829,0.2644742269353338,0.2649741782149847,0.2654741294946356,0.2659740807742865,0.26647403205393744,0.26697398333358835,0.26747393461323926,0.2679738858928902,0.2684738371725411,0.268973788452192,0.26947373973184297,0.2699736910114939,0.27047364229114473,0.27097359357079565,0.27147354485044656,0.27197349613009747,0.27247344740974844,0.27297339868939935,0.2734733499690502,0.2739733012487012,0.2744732525283521,0.274973203808003,0.2754731550876539,0.27597310636730477,0.27647305764695573,0.27697300892660665,0.27747296020625756,0.27797291148590847,0.2784728627655594,0.2789728140452103,0.2794727653248612,0.2799727166045121,0.2804726678841631,0.28097261916381394,0.28147257044346485,0.2819725217231158,0.28247247300276673,0.28297242428241765,0.2834723755620685,0.2839723268417194,0.2844722781213703,0.2849722294010213,0.2854721806806722,0.2859721319603231,0.28647208323997403,0.28697203451962494,0.28747198579927585,0.28797193707892677,0.2884718883585777,0.2889718396382286,0.2894717909178795,0.2899717421975304,0.2904716934771814,0.29097164475683224,0.29147159603648315,0.29197154731613406,0.292471498595785,0.29297144987543594,0.29347140115508685,0.2939713524347377,0.2944713037143887,0.2949712549940396,0.2954712062736905,0.2959711575533414,0.29647110883299227,0.2969710601126432,0.29747101139229415,0.29797096267194506,0.298470913951596,0.2989708652312469,0.2994708165108978,0.2999707677905487],"y":[0.0799956531966972,0.08009564232968894,0.08019563146268069,0.08029562059567244,0.08039560972866416,0.08049559886165591,0.08059558799464765,0.0806955771276394,0.08079556626063114,0.08089555539362289,0.08099554452661463,0.08109553365960637,0.08119552279259812,0.08129551192558986,0.08139550105858159,0.08149549019157334,0.0815954793245651,0.08169546845755683,0.08179545759054857,0.08189544672354032,0.08199543585653206,0.0820954249895238,0.08219541412251555,0.0822954032555073,0.08239539238849904,0.08249538152149077,0.08259537065448253,0.08269535978747425,0.082795348920466,0.08289533805345775,0.08299532718644949,0.08309531631944123,0.08319530545243298,0.08329529458542473,0.08339528371841645,0.0834952728514082,0.08359526198439995,0.08369525111739169,0.08379524025038343,0.08389522938337518,0.08399521851636693,0.08409520764935866,0.0841951967823504,0.08429518591534214,0.0843951750483339,0.08449516418132563,0.08459515331431738,0.08469514244730912,0.08479513158030086,0.08489512071329261,0.08499510984628435,0.08509509897927608,0.08519508811226784,0.08529507724525959,0.08539506637825132,0.08549505551124306,0.08559504464423481,0.08569503377722655,0.08579502291021829,0.08589501204321004,0.08599500117620178,0.08609499030919353,0.08619497944218527,0.08629496857517702,0.08639495770816874,0.08649494684116049,0.08659493597415224,0.08669492510714398,0.08679491424013572,0.08689490337312747,0.08699489250611922,0.08709488163911094,0.0871948707721027,0.08729485990509445,0.08739484903808618,0.08749483817107792,0.08759482730406967,0.08769481643706141,0.08779480557005315,0.0878947947030449,0.08799478383603664,0.08809477296902839,0.08819476210202012,0.08829475123501188,0.08839474036800361,0.08849472950099535,0.0885947186339871,0.08869470776697884,0.08879469689997058,0.08889468603296233,0.08899467516595408,0.08909466429894582,0.08919465343193755,0.0892946425649293,0.08939463169792104,0.08949462083091278,0.08959460996390453,0.08969459909689627,0.08979458822988802,0.08989457736287976,0.08999456649587151,0.09009455562886323,0.09019454476185498,0.09029453389484673,0.09039452302783847,0.09049451216083021,0.09059450129382196,0.09069449042681371,0.09079447955980544,0.09089446869279719,0.09099445782578892,0.09109444695878068,0.09119443609177241,0.09129442522476416,0.09139441435775592,0.09149440349074764,0.09159439262373939,0.09169438175673113,0.09179437088972286,0.09189436002271462,0.09199434915570637,0.0920943382886981,0.09219432742168984,0.0922943165546816,0.09239430568767333,0.09249429482066507,0.09259428395365682,0.09269427308664856,0.09279426221964031,0.09289425135263205,0.0929942404856238,0.09309422961861553,0.09319421875160727,0.09329420788459902,0.09339419701759076,0.0934941861505825,0.09359417528357425,0.093694164416566,0.09379415354955772,0.09389414268254948,0.09399413181554123,0.09409412094853296,0.0941941100815247,0.09429409921451645,0.09439408834750819,0.09449407748049993,0.09459406661349168,0.09469405574648342,0.09479404487947517,0.0948940340124669,0.09499402314545866,0.0950940122784504,0.09519400141144213,0.09529399054443388,0.09539397967742562,0.09549396881041736,0.09559395794340911,0.09569394707640086,0.0957939362093926,0.09589392534238433,0.09599391447537609,0.09609390360836782,0.09619389274135956,0.09629388187435131,0.09639387100734306,0.0964938601403348,0.09659384927332654,0.09669383840631829,0.09679382753931001,0.09689381667230176,0.09699380580529351,0.09709379493828525,0.09719378407127699,0.09729377320426874,0.09739376233726049,0.09749375147025222,0.09759374060324397,0.0976937297362357,0.09779371886922746,0.09789370800221919,0.09799369713521094,0.0980936862682027,0.09819367540119442,0.09829366453418617,0.09839365366717791,0.09849364280016965,0.0985936319331614,0.09869362106615315,0.09879361019914489,0.09889359933213662,0.09899358846512837,0.09909357759812011,0.09919356673111185,0.0992935558641036,0.09939354499709534,0.09949353413008709,0.09959352326307883,0.09969351239607058,0.09979350152906231,0.09989349066205405,0.0999934797950458],"type":"scatter"},{"hovertemplate":"wealth in efficient high mean portfolio = %{text:.0f}%<br>Sharpe ratio (relative to borrowing rate): 0.2000<extra></extra>","line":{"color":"blue","dash":"dot"},"mode":"lines","name":"CAL: efficient high mean (unlevered)","text":[0.0,0.5,1.0,1.5,2.0,2.5,3.0,3.5000000000000004,4.0,4.5,5.0,5.5,6.0,6.5,7.000000000000001,7.5,8.0,8.5,9.0,9.5,10.0,10.5,11.0,11.5,12.0,12.5,13.0,13.5,14.000000000000002,14.499999999999998,15.0,15.5,16.0,16.5,17.0,17.5,18.0,18.5,19.0,19.5,20.0,20.5,21.0,21.5,22.0,22.5,23.0,23.5,24.0,24.5,25.0,25.5,26.0,26.5,27.0,27.500000000000004,28.000000000000004,28.500000000000004,28.999999999999996,29.5,30.0,30.5,31.0,31.5,32.0,32.5,33.0,33.5,34.0,34.5,35.0,35.5,36.0,36.5,37.0,37.5,38.0,38.5,39.0,39.5,40.0,40.5,41.0,41.5,42.0,42.5,43.0,43.5,44.0,44.5,45.0,45.5,46.0,46.5,47.0,47.5,48.0,48.5,49.0,49.5,50.0,50.5,51.0,51.5,52.0,52.5,53.0,53.5,54.0,54.50000000000001,55.00000000000001,55.50000000000001,56.00000000000001,56.50000000000001,57.00000000000001,57.50000000000001,57.99999999999999,58.5,59.0,59.5,60.0,60.5,61.0,61.5,62.0,62.5,63.0,63.5,64.0,64.5,65.0,65.5,66.0,66.5,67.0,67.5,68.0,68.5,69.0,69.5,70.0,70.5,71.0,71.5,72.0,72.5,73.0,73.5,74.0,74.5,75.0,75.5,76.0,76.5,77.0,77.5,78.0,78.5,79.0,79.5,80.0,80.5,81.0,81.5,82.0,82.5,83.0,83.5,84.0,84.5,85.0,85.5,86.0,86.5,87.0,87.5,88.0,88.5,89.0,89.5,90.0,90.5,91.0,91.5,92.0,92.5,93.0,93.5,94.0,94.5,95.0,95.5,96.0,96.5,97.0,97.5,98.0,98.5,99.0,99.5,100.0],"x":[0.0,0.000999902559301829,0.001999805118603658,0.002999707677905487,0.003999610237207316,0.004999512796509145,0.005999415355810974,0.006999317915112804,0.007999220474414632,0.008999123033716461,0.00999902559301829,0.01099892815232012,0.011998830711621947,0.012998733270923778,0.013998635830225608,0.014998538389527435,0.015998440948829264,0.016998343508131095,0.017998246067432923,0.01899814862673475,0.01999805118603658,0.02099795374533841,0.02199785630464024,0.022997758863942067,0.023997661423243895,0.024997563982545726,0.025997466541847557,0.026997369101149384,0.027997271660451215,0.02899717421975304,0.02999707677905487,0.0309969793383567,0.03199688189765853,0.03299678445696036,0.03399668701626219,0.03499658957556402,0.035996492134865846,0.03699639469416768,0.0379962972534695,0.03899619981277133,0.03999610237207316,0.040996004931374994,0.04199590749067682,0.04299581004997865,0.04399571260928048,0.04499561516858231,0.045995517727884135,0.046995420287185966,0.04799532284648779,0.04899522540578962,0.04999512796509145,0.05099503052439328,0.05199493308369511,0.052994835642996944,0.05399473820229877,0.0549946407616006,0.05599454332090243,0.05699444588020426,0.05799434843950608,0.05899425099880791,0.05999415355810974,0.06099405611741157,0.0619939586767134,0.06299386123601523,0.06399376379531706,0.0649936663546189,0.06599356891392072,0.06699347147322254,0.06799337403252438,0.0689932765918262,0.06999317915112804,0.07099308171042985,0.07199298426973169,0.07299288682903352,0.07399278938833535,0.07499269194763718,0.075992594506939,0.07699249706624084,0.07799239962554266,0.0789923021848445,0.07999220474414633,0.08099210730344816,0.08199200986274999,0.08299191242205181,0.08399181498135364,0.08499171754065546,0.0859916200999573,0.08699152265925912,0.08799142521856096,0.08899132777786278,0.08999123033716462,0.09099113289646645,0.09199103545576827,0.09299093801507011,0.09399084057437193,0.09499074313367377,0.09599064569297558,0.09699054825227742,0.09799045081157924,0.09899035337088108,0.0999902559301829,0.10099015848948473,0.10199006104878656,0.10298996360808839,0.10398986616739023,0.10498976872669205,0.10598967128599389,0.10698957384529571,0.10798947640459754,0.10898937896389937,0.1099892815232012,0.11098918408250304,0.11198908664180486,0.1129889892011067,0.11398889176040852,0.11498879431971035,0.11598869687901216,0.116988599438314,0.11798850199761582,0.11898840455691764,0.11998830711621948,0.1209882096755213,0.12198811223482314,0.12298801479412497,0.1239879173534268,0.12498781991272863,0.12598772247203047,0.1269876250313323,0.12798752759063411,0.12898743014993594,0.1299873327092378,0.13098723526853961,0.13198713782784144,0.13298704038714326,0.1339869429464451,0.13498684550574694,0.13598674806504876,0.1369866506243506,0.1379865531836524,0.13898645574295423,0.1399863583022561,0.14098626086155788,0.1419861634208597,0.14298606598016156,0.14398596853946338,0.1449858710987652,0.14598577365806703,0.14698567621736885,0.1479855787766707,0.14898548133597253,0.14998538389527435,0.15098528645457618,0.151985189013878,0.15298509157317985,0.15398499413248168,0.1549848966917835,0.15598479925108533,0.15698470181038715,0.157984604369689,0.15898450692899083,0.15998440948829265,0.16098431204759447,0.16198421460689633,0.16298411716619815,0.16398401972549997,0.1649839222848018,0.16598382484410362,0.16698372740340545,0.16798362996270727,0.1689835325220091,0.16998343508131092,0.17098333764061277,0.1719832401999146,0.17298314275921642,0.17398304531851824,0.1749829478778201,0.17598285043712192,0.17698275299642374,0.17798265555572557,0.1789825581150274,0.17998246067432924,0.18098236323363107,0.1819822657929329,0.18298216835223471,0.18398207091153654,0.1849819734708384,0.18598187603014021,0.18698177858944204,0.18798168114874386,0.1889815837080457,0.18998148626734754,0.19098138882664936,0.19198129138595116,0.192981193945253,0.19398109650455483,0.19498099906385666,0.19598090162315848,0.1969808041824603,0.19798070674176216,0.19898060930106398,0.1999805118603658],"y":[0.04,0.04019997826598349,0.04039995653196697,0.04059993479795046,0.04079991306393394,0.04099989132991743,0.04119986959590092,0.0413998478618844,0.04159982612786789,0.04179980439385138,0.04199978265983486,0.04219976092581835,0.04239973919180183,0.04259971745778532,0.04279969572376881,0.04299967398975229,0.04319965225573578,0.04339963052171926,0.04359960878770275,0.04379958705368624,0.04399956531966972,0.04419954358565321,0.04439952185163669,0.04459950011762018,0.044799478383603666,0.04499945664958715,0.04519943491557064,0.045399413181554125,0.04559939144753761,0.045799369713521096,0.04599934797950458,0.046199326245488066,0.046399304511471555,0.04659928277745504,0.046799261043438525,0.046999239309422014,0.047199217575405496,0.047399195841388984,0.047599174107372466,0.047799152373355955,0.04799913063933944,0.048199108905322925,0.048399087171306414,0.048599065437289896,0.048799043703273384,0.04899902196925687,0.049199000235240355,0.04939897850122384,0.049598956767207325,0.049798935033190814,0.0499989132991743,0.05019889156515779,0.05039886983114127,0.05059884809712476,0.05079882636310824,0.05099880462909173,0.05119878289507522,0.0513987611610587,0.051598739427042184,0.05179871769302567,0.05199869595900916,0.05219867422499265,0.05239865249097613,0.05259863075695962,0.0527986090229431,0.05299858728892659,0.05319856555491008,0.05339854382089356,0.05359852208687705,0.05379850035286053,0.05399847861884402,0.05419845688482751,0.05439843515081099,0.05459841341679448,0.05479839168277796,0.05499836994876145,0.05519834821474494,0.05539832648072843,0.05559830474671191,0.05579828301269539,0.05599826127867888,0.05619823954466237,0.056398217810645856,0.05659819607662934,0.05679817434261282,0.05699815260859631,0.0571981308745798,0.057398109140563286,0.05759808740654677,0.057798065672530256,0.05799804393851374,0.05819802220449723,0.058398000470480715,0.058597978736464204,0.058797957002447686,0.05899793526843117,0.059197913534414656,0.059397891800398145,0.05959787006638163,0.059797848332365115,0.0599978265983486,0.060197804864332086,0.060397783130315574,0.06059776139629906,0.060797739662282545,0.060997717928266026,0.061197696194249515,0.061397674460233004,0.06159765272621649,0.06179763099219998,0.06199760925818346,0.062197587524166945,0.06239756579015043,0.06259754405613392,0.06279752232211741,0.06299750058810089,0.06319747885408437,0.06339745712006786,0.06359743538605135,0.06379741365203484,0.06399739191801831,0.0641973701840018,0.06439734844998529,0.06459732671596878,0.06479730498195227,0.06499728324793574,0.06519726151391923,0.06539723977990272,0.06559721804588621,0.0657971963118697,0.06599717457785317,0.06619715284383666,0.06639713110982015,0.06659710937580364,0.06679708764178713,0.06699706590777062,0.0671970441737541,0.06739702243973758,0.06759700070572107,0.06779697897170456,0.06799695723768805,0.06819693550367152,0.06839691376965501,0.0685968920356385,0.06879687030162199,0.06899684856760546,0.06919682683358895,0.06939680509957244,0.06959678336555593,0.06979676163153942,0.06999673989752289,0.0701967181635064,0.07039669642948987,0.07059667469547336,0.07079665296145685,0.07099663122744033,0.07119660949342382,0.0713965877594073,0.07159656602539079,0.07179654429137428,0.07199652255735776,0.07219650082334125,0.07239647908932473,0.07259645735530823,0.0727964356212917,0.0729964138872752,0.07319639215325868,0.07339637041924216,0.07359634868522565,0.07379632695120913,0.07399630521719261,0.07419628348317611,0.07439626174915959,0.07459624001514308,0.07479621828112656,0.07499619654711005,0.07519617481309354,0.07539615307907702,0.07559613134506052,0.075796109611044,0.07599608787702748,0.07619606614301097,0.07639604440899445,0.07659602267497795,0.07679600094096142,0.07699597920694491,0.0771959574729284,0.07739593573891188,0.07759591400489538,0.07779589227087885,0.07799587053686234,0.07819584880284583,0.0783958270688293,0.07859580533481281,0.07879578360079628,0.07899576186677977,0.07919574013276326,0.07939571839874673,0.07959569666473024,0.07979567493071371,0.0799956531966972],"type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"title":{"text":"Standard Deviation"},"range":[0,0.25],"tickformat":".0%"},"yaxis":{"title":{"text":"Expected Return"},"range":[0,0.1],"tickformat":".0%"}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('fc99cf23-6dde-4244-93a2-fba24dcab0a5');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
<p></p><figcaption class="figure-caption">Figure 4.8: Portfolios of two risky assets and risk-free saving and borrowing</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell" data-execution_count="10">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.graph_objects <span class="im">as</span> go</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>mn_stock <span class="op">=</span> <span class="dv">8</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>mn_bond  <span class="op">=</span> <span class="fl">3.5</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>sd_stock <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>sd_bond  <span class="op">=</span> <span class="fl">3.5</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>corr <span class="op">=</span> <span class="op">-</span><span class="dv">5</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>rs <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>extra <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>raver1 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>raver2 <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> data(mn1, mn2, sd1, sd2, c, rs, extra):</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>    c <span class="op">=</span> c <span class="op">/</span> <span class="dv">100</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>    rb <span class="op">=</span> rs <span class="op">+</span> extra   </span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>    rs <span class="op">=</span> rs<span class="op">/</span><span class="dv">100</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>    rb <span class="op">=</span> rb<span class="op">/</span><span class="dv">100</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>    mns <span class="op">=</span> [mn1, mn2]</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>    sds <span class="op">=</span> [sd1, sd2]</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>    grid <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">101</span>)</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>    ports <span class="op">=</span> [np.array([w, <span class="dv">1</span> <span class="op">-</span> w]) <span class="cf">for</span> w <span class="kw">in</span> grid]</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>    means <span class="op">=</span> [p.T <span class="op">@</span> np.array(mns) <span class="cf">for</span> p <span class="kw">in</span> ports]</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> pd.DataFrame(means)</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>    df.columns <span class="op">=</span> [<span class="st">"mean"</span>]</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>    cov <span class="op">=</span> np.array(</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>        [[sds[<span class="dv">0</span>] <span class="op">**</span> <span class="dv">2</span>, sds[<span class="dv">0</span>] <span class="op">*</span> sds[<span class="dv">1</span>] <span class="op">*</span> c], [sds[<span class="dv">0</span>] <span class="op">*</span> sds[<span class="dv">1</span>] <span class="op">*</span> c, sds[<span class="dv">1</span>] <span class="op">**</span> <span class="dv">2</span>]]</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>    ).reshape(<span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">"stdev"</span>] <span class="op">=</span> [np.sqrt(p.T <span class="op">@</span> cov <span class="op">@</span> p) <span class="cf">for</span> p <span class="kw">in</span> ports]</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">"wt1"</span>] <span class="op">=</span> grid</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">"wt2"</span>] <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> df.wt1</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col <span class="kw">in</span> [<span class="st">"mean"</span>, <span class="st">"stdev"</span>]:</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>        df[col] <span class="op">=</span> df[col] <span class="op">/</span> <span class="dv">100</span></span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">"sr_s"</span>]<span class="op">=</span> (df[<span class="st">"mean"</span>] <span class="op">-</span> rs)<span class="op">/</span>df[<span class="st">"stdev"</span>]</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">"sr_b"</span>]<span class="op">=</span> (df[<span class="st">"mean"</span>] <span class="op">-</span> rb)<span class="op">/</span>df[<span class="st">"stdev"</span>]</span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> rf_plus_risky(mn, sd, rs, rb, w_min, w_max):</span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>    mn <span class="op">/=</span> <span class="dv">100</span></span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a>    sd <span class="op">/=</span> <span class="dv">100</span></span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>    rs <span class="op">/=</span> <span class="dv">100</span></span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a>    rb <span class="op">/=</span> <span class="dv">100</span></span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>    grid <span class="op">=</span> np.linspace(w_min, w_max, <span class="dv">201</span>)</span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a>    mns <span class="op">=</span> [(rs <span class="op">+</span> w <span class="op">*</span> (mn <span class="op">-</span> rs) <span class="cf">if</span> w <span class="op">&lt;=</span> <span class="dv">1</span> <span class="cf">else</span> rb <span class="op">+</span> w <span class="op">*</span> (mn <span class="op">-</span> rb)) <span class="cf">for</span> w <span class="kw">in</span> grid]</span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a>    sds <span class="op">=</span> [w <span class="op">*</span> sd <span class="cf">for</span> w <span class="kw">in</span> grid]</span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a>    srs <span class="op">=</span> (mn <span class="op">-</span> rs)<span class="op">/</span>sd</span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a>    srb <span class="op">=</span> (mn <span class="op">-</span> rb)<span class="op">/</span>sd</span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> grid, mns, sds, srs, srb</span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> opt_utility(mns, cov, Shorts, s, b, A):</span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true" tabindex="-1"></a>    <span class="co"># P is a portfolio object based on expected returns, covariance matrix, and shorts</span></span>
<span id="cb9-56"><a href="#cb9-56" aria-hidden="true" tabindex="-1"></a>    P <span class="op">=</span> portfolio(mns, cov, Shorts) </span>
<span id="cb9-57"><a href="#cb9-57" aria-hidden="true" tabindex="-1"></a>    gmv <span class="op">=</span> P.GMV <span class="op">@</span> mns</span>
<span id="cb9-58"><a href="#cb9-58" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> s<span class="op">==</span>b:</span>
<span id="cb9-59"><a href="#cb9-59" aria-hidden="true" tabindex="-1"></a>        <span class="co">#tangency exp ret and sd</span></span>
<span id="cb9-60"><a href="#cb9-60" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (s <span class="op">&lt;</span> gmv) <span class="kw">or</span> (<span class="kw">not</span> Shorts):</span>
<span id="cb9-61"><a href="#cb9-61" aria-hidden="true" tabindex="-1"></a>            portTang <span class="op">=</span> P.tangency(s)</span>
<span id="cb9-62"><a href="#cb9-62" aria-hidden="true" tabindex="-1"></a>            mnTang <span class="op">=</span> portTang <span class="op">@</span> mns</span>
<span id="cb9-63"><a href="#cb9-63" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> mnTang <span class="op">&lt;</span> np.<span class="bu">max</span>(mns):</span>
<span id="cb9-64"><a href="#cb9-64" aria-hidden="true" tabindex="-1"></a>                sdTang <span class="op">=</span> np.sqrt(portTang <span class="op">@</span> cov <span class="op">@</span> portTang)</span>
<span id="cb9-65"><a href="#cb9-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-66"><a href="#cb9-66" aria-hidden="true" tabindex="-1"></a>                <span class="co">#optimal weight in tangency based on risk-aversion</span></span>
<span id="cb9-67"><a href="#cb9-67" aria-hidden="true" tabindex="-1"></a>                wgt <span class="op">=</span> (mnTang <span class="op">-</span> s) <span class="op">/</span> (A <span class="op">*</span> (sdTang<span class="op">**</span><span class="dv">2</span>))</span>
<span id="cb9-68"><a href="#cb9-68" aria-hidden="true" tabindex="-1"></a>                expret<span class="op">=</span> wgt<span class="op">*</span>mnTang <span class="op">+</span> (<span class="dv">1</span><span class="op">-</span>wgt)<span class="op">*</span>s</span>
<span id="cb9-69"><a href="#cb9-69" aria-hidden="true" tabindex="-1"></a>                sdret <span class="op">=</span> wgt<span class="op">*</span>sdTang </span>
<span id="cb9-70"><a href="#cb9-70" aria-hidden="true" tabindex="-1"></a>                wgt_rf <span class="op">=</span> <span class="dv">1</span><span class="op">-</span>wgt</span>
<span id="cb9-71"><a href="#cb9-71" aria-hidden="true" tabindex="-1"></a>                wgt_lo <span class="op">=</span> wgt</span>
<span id="cb9-72"><a href="#cb9-72" aria-hidden="true" tabindex="-1"></a>                wgt_hi <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb9-73"><a href="#cb9-73" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb9-74"><a href="#cb9-74" aria-hidden="true" tabindex="-1"></a>        <span class="co">#efficient low-risk portfolio</span></span>
<span id="cb9-75"><a href="#cb9-75" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (s <span class="op">&lt;</span> gmv) <span class="kw">or</span> (<span class="kw">not</span> Shorts):</span>
<span id="cb9-76"><a href="#cb9-76" aria-hidden="true" tabindex="-1"></a>            portTangLowRisk <span class="op">=</span> P.tangency(s)</span>
<span id="cb9-77"><a href="#cb9-77" aria-hidden="true" tabindex="-1"></a>            mnTangLowRisk <span class="op">=</span> portTangLowRisk <span class="op">@</span> mns</span>
<span id="cb9-78"><a href="#cb9-78" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> mnTangLowRisk <span class="op">&lt;</span> np.<span class="bu">max</span>(mns):</span>
<span id="cb9-79"><a href="#cb9-79" aria-hidden="true" tabindex="-1"></a>                sdTangLowRisk <span class="op">=</span> np.sqrt(portTangLowRisk <span class="op">@</span> cov <span class="op">@</span> portTangLowRisk)</span>
<span id="cb9-80"><a href="#cb9-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-81"><a href="#cb9-81" aria-hidden="true" tabindex="-1"></a>        <span class="co">#efficient high-risk portfolio</span></span>
<span id="cb9-82"><a href="#cb9-82" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> ((b<span class="op">&lt;</span>gmv) <span class="kw">or</span> (<span class="kw">not</span> Shorts)):</span>
<span id="cb9-83"><a href="#cb9-83" aria-hidden="true" tabindex="-1"></a>            portTangHighRisk <span class="op">=</span> P.tangency(b)</span>
<span id="cb9-84"><a href="#cb9-84" aria-hidden="true" tabindex="-1"></a>            mnTangHighRisk <span class="op">=</span> portTangHighRisk <span class="op">@</span> mns</span>
<span id="cb9-85"><a href="#cb9-85" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> mnTangHighRisk <span class="op">&lt;</span> np.<span class="bu">max</span>(mns):</span>
<span id="cb9-86"><a href="#cb9-86" aria-hidden="true" tabindex="-1"></a>                sdTangHighRisk <span class="op">=</span> np.sqrt(portTangHighRisk <span class="op">@</span> cov <span class="op">@</span> portTangHighRisk)</span>
<span id="cb9-87"><a href="#cb9-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-88"><a href="#cb9-88" aria-hidden="true" tabindex="-1"></a>        <span class="co">#1st: efficient low risk CAL</span></span>
<span id="cb9-89"><a href="#cb9-89" aria-hidden="true" tabindex="-1"></a>        wgt <span class="op">=</span> (mnTangLowRisk <span class="op">-</span> s) <span class="op">/</span> (A <span class="op">*</span> (sdTangLowRisk<span class="op">**</span><span class="dv">2</span>))</span>
<span id="cb9-90"><a href="#cb9-90" aria-hidden="true" tabindex="-1"></a>        expret<span class="op">=</span> wgt<span class="op">*</span>mnTangLowRisk <span class="op">+</span> (<span class="dv">1</span><span class="op">-</span>wgt)<span class="op">*</span>s</span>
<span id="cb9-91"><a href="#cb9-91" aria-hidden="true" tabindex="-1"></a>        sdret <span class="op">=</span> wgt<span class="op">*</span>sdTangLowRisk </span>
<span id="cb9-92"><a href="#cb9-92" aria-hidden="true" tabindex="-1"></a>        wgt_rf <span class="op">=</span> <span class="dv">1</span><span class="op">-</span>wgt</span>
<span id="cb9-93"><a href="#cb9-93" aria-hidden="true" tabindex="-1"></a>        wgt_lo <span class="op">=</span> wgt</span>
<span id="cb9-94"><a href="#cb9-94" aria-hidden="true" tabindex="-1"></a>        wgt_hi <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb9-95"><a href="#cb9-95" aria-hidden="true" tabindex="-1"></a>        <span class="co"># print('Weight low risk CAL: ', wgt)</span></span>
<span id="cb9-96"><a href="#cb9-96" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> wgt <span class="op">&gt;</span> <span class="fl">1.0</span>:</span>
<span id="cb9-97"><a href="#cb9-97" aria-hidden="true" tabindex="-1"></a>            <span class="co">#2nd: efficient high risk CAL</span></span>
<span id="cb9-98"><a href="#cb9-98" aria-hidden="true" tabindex="-1"></a>            wgt <span class="op">=</span> (mnTangHighRisk <span class="op">-</span> b) <span class="op">/</span> (A <span class="op">*</span> (sdTangHighRisk<span class="op">**</span><span class="dv">2</span>))</span>
<span id="cb9-99"><a href="#cb9-99" aria-hidden="true" tabindex="-1"></a>            expret<span class="op">=</span> wgt<span class="op">*</span>mnTangHighRisk <span class="op">+</span> (<span class="dv">1</span><span class="op">-</span>wgt)<span class="op">*</span>b</span>
<span id="cb9-100"><a href="#cb9-100" aria-hidden="true" tabindex="-1"></a>            sdret <span class="op">=</span> wgt<span class="op">*</span>sdTangHighRisk </span>
<span id="cb9-101"><a href="#cb9-101" aria-hidden="true" tabindex="-1"></a>            wgt_rf <span class="op">=</span> <span class="dv">1</span><span class="op">-</span>wgt</span>
<span id="cb9-102"><a href="#cb9-102" aria-hidden="true" tabindex="-1"></a>            wgt_lo <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb9-103"><a href="#cb9-103" aria-hidden="true" tabindex="-1"></a>            wgt_hi <span class="op">=</span> wgt</span>
<span id="cb9-104"><a href="#cb9-104" aria-hidden="true" tabindex="-1"></a>            <span class="co"># print('Weight high risk CAL: ', wgt)</span></span>
<span id="cb9-105"><a href="#cb9-105" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> wgt <span class="op">&lt;</span> <span class="fl">1.0</span>:</span>
<span id="cb9-106"><a href="#cb9-106" aria-hidden="true" tabindex="-1"></a>                <span class="co">#3rd: risky asset frontier</span></span>
<span id="cb9-107"><a href="#cb9-107" aria-hidden="true" tabindex="-1"></a>                wgt <span class="op">=</span> <span class="dv">1</span> <span class="co">#This is should be interpreted as total weight in risky assets.</span></span>
<span id="cb9-108"><a href="#cb9-108" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Method 1: solve analytically for utility-maximizing mix of efficient low and high risk portfolios</span></span>
<span id="cb9-109"><a href="#cb9-109" aria-hidden="true" tabindex="-1"></a>                cov_hilo <span class="op">=</span> portTangLowRisk.T <span class="op">@</span>cov <span class="op">@</span> portTangHighRisk</span>
<span id="cb9-110"><a href="#cb9-110" aria-hidden="true" tabindex="-1"></a>                wgt_lo <span class="op">=</span> (mnTangLowRisk <span class="op">-</span> mnTangHighRisk <span class="op">-</span> A <span class="op">*</span>(cov_hilo  <span class="op">-</span> sdTangHighRisk<span class="op">**</span><span class="dv">2</span>))<span class="op">/</span>(A<span class="op">*</span>(sdTangLowRisk<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> sdTangHighRisk<span class="op">**</span><span class="dv">2</span> <span class="op">-</span> <span class="dv">2</span><span class="op">*</span>cov_hilo))</span>
<span id="cb9-111"><a href="#cb9-111" aria-hidden="true" tabindex="-1"></a>                expret <span class="op">=</span> wgt_lo<span class="op">*</span>mnTangLowRisk <span class="op">+</span> (<span class="dv">1</span><span class="op">-</span>wgt_lo)<span class="op">*</span> mnTangHighRisk</span>
<span id="cb9-112"><a href="#cb9-112" aria-hidden="true" tabindex="-1"></a>                sdret <span class="op">=</span> np.sqrt((wgt_lo<span class="op">**</span><span class="dv">2</span>) <span class="op">*</span>sdTangLowRisk<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> ((<span class="dv">1</span><span class="op">-</span>wgt_lo)<span class="op">**</span><span class="dv">2</span>) <span class="op">*</span> sdTangHighRisk<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> <span class="dv">2</span><span class="op">*</span>wgt_lo<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>wgt_lo)<span class="op">*</span>portTangLowRisk.T <span class="op">@</span>cov <span class="op">@</span> portTangHighRisk)</span>
<span id="cb9-113"><a href="#cb9-113" aria-hidden="true" tabindex="-1"></a>                wgt_hi <span class="op">=</span> <span class="dv">1</span><span class="op">-</span>wgt_lo</span>
<span id="cb9-114"><a href="#cb9-114" aria-hidden="true" tabindex="-1"></a>                wgt_rf <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb9-115"><a href="#cb9-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-116"><a href="#cb9-116" aria-hidden="true" tabindex="-1"></a>                <span class="co"># #Method 2: calculate frontier manually and choose max utility</span></span>
<span id="cb9-117"><a href="#cb9-117" aria-hidden="true" tabindex="-1"></a>                <span class="co"># eret_grid = np.linspace(mnTangLowRisk, mnTangHighRisk, 100)</span></span>
<span id="cb9-118"><a href="#cb9-118" aria-hidden="true" tabindex="-1"></a>                <span class="co"># df = pd.DataFrame(dtype='float', columns=['mn','sd','u'],index=np.arange(0,100))</span></span>
<span id="cb9-119"><a href="#cb9-119" aria-hidden="true" tabindex="-1"></a>                <span class="co"># for i,m in enumerate(eret_grid):</span></span>
<span id="cb9-120"><a href="#cb9-120" aria-hidden="true" tabindex="-1"></a>                <span class="co">#     portFrontier = P.frontier(m)</span></span>
<span id="cb9-121"><a href="#cb9-121" aria-hidden="true" tabindex="-1"></a>                <span class="co">#     df.loc[i,'mn'] = portFrontier @ mns</span></span>
<span id="cb9-122"><a href="#cb9-122" aria-hidden="true" tabindex="-1"></a>                <span class="co">#     df.loc[i,'sd'] = np.sqrt(portFrontier @ cov @ portFrontier)</span></span>
<span id="cb9-123"><a href="#cb9-123" aria-hidden="true" tabindex="-1"></a>                <span class="co"># df['u']  = df['mn'] - 0.5*A* df['sd']**2</span></span>
<span id="cb9-124"><a href="#cb9-124" aria-hidden="true" tabindex="-1"></a>                <span class="co"># opt_mn = df.loc[df['u'].idxmax(),'mn']</span></span>
<span id="cb9-125"><a href="#cb9-125" aria-hidden="true" tabindex="-1"></a>                <span class="co"># portFrontier = P.frontier(opt_mn)</span></span>
<span id="cb9-126"><a href="#cb9-126" aria-hidden="true" tabindex="-1"></a>                <span class="co"># expret = portFrontier @ mns</span></span>
<span id="cb9-127"><a href="#cb9-127" aria-hidden="true" tabindex="-1"></a>                <span class="co"># sdret  = np.sqrt(portFrontier @ cov @ portFrontier)</span></span>
<span id="cb9-128"><a href="#cb9-128" aria-hidden="true" tabindex="-1"></a>                <span class="co"># print('Weight frontier: ', wgt)</span></span>
<span id="cb9-129"><a href="#cb9-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-130"><a href="#cb9-130" aria-hidden="true" tabindex="-1"></a>    u <span class="op">=</span> expret <span class="op">-</span> <span class="fl">0.5</span><span class="op">*</span>A<span class="op">*</span>sdret<span class="op">**</span><span class="dv">2</span></span>
<span id="cb9-131"><a href="#cb9-131" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> u, wgt, wgt_rf, wgt_lo, wgt_hi</span>
<span id="cb9-132"><a href="#cb9-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-133"><a href="#cb9-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-134"><a href="#cb9-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-135"><a href="#cb9-135" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> figtbl(mn1, mn2, sd1, sd2, c, rs, extra, raver1, raver2, asset1_name, asset2_name):</span>
<span id="cb9-136"><a href="#cb9-136" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> data(mn1, mn2, sd1, sd2, c, rs, extra)</span>
<span id="cb9-137"><a href="#cb9-137" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-138"><a href="#cb9-138" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Plot the portfolios of the two assets</span></span>
<span id="cb9-139"><a href="#cb9-139" aria-hidden="true" tabindex="-1"></a>    trace1 <span class="op">=</span> go.Scatter(</span>
<span id="cb9-140"><a href="#cb9-140" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span>df[<span class="st">"stdev"</span>],</span>
<span id="cb9-141"><a href="#cb9-141" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span>df[<span class="st">"mean"</span>],</span>
<span id="cb9-142"><a href="#cb9-142" aria-hidden="true" tabindex="-1"></a>        mode<span class="op">=</span><span class="st">"lines"</span>,</span>
<span id="cb9-143"><a href="#cb9-143" aria-hidden="true" tabindex="-1"></a>        <span class="co"># line={'color': green},</span></span>
<span id="cb9-144"><a href="#cb9-144" aria-hidden="true" tabindex="-1"></a>        text<span class="op">=</span><span class="dv">100</span> <span class="op">*</span> df[<span class="st">"wt1"</span>],</span>
<span id="cb9-145"><a href="#cb9-145" aria-hidden="true" tabindex="-1"></a>        customdata<span class="op">=</span><span class="dv">100</span> <span class="op">*</span> df[<span class="st">"wt2"</span>],</span>
<span id="cb9-146"><a href="#cb9-146" aria-hidden="true" tabindex="-1"></a>        hovertemplate<span class="op">=</span>asset1_name<span class="op">+</span><span class="st">": %</span><span class="sc">{text:.0f}</span><span class="st">%&lt;br&gt;"</span><span class="op">+</span>asset2_name<span class="op">+</span><span class="st">": %</span><span class="sc">{customdata:.0f}</span><span class="st">%&lt;extra&gt;&lt;/extra&gt;"</span>,</span>
<span id="cb9-147"><a href="#cb9-147" aria-hidden="true" tabindex="-1"></a>        line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">"black"</span>),</span>
<span id="cb9-148"><a href="#cb9-148" aria-hidden="true" tabindex="-1"></a>        name<span class="op">=</span><span class="st">"Stock &amp; Bond Frontier"</span></span>
<span id="cb9-149"><a href="#cb9-149" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb9-150"><a href="#cb9-150" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-151"><a href="#cb9-151" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot the two assets</span></span>
<span id="cb9-152"><a href="#cb9-152" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> df[df.wt1.isin([<span class="dv">0</span>, <span class="dv">1</span>])]</span>
<span id="cb9-153"><a href="#cb9-153" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">"text"</span>] <span class="op">=</span> np.where(df.wt1 <span class="op">==</span> <span class="dv">1</span>, asset1_name, asset2_name)</span>
<span id="cb9-154"><a href="#cb9-154" aria-hidden="true" tabindex="-1"></a>    trace2a <span class="op">=</span> go.Scatter(</span>
<span id="cb9-155"><a href="#cb9-155" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span>df[df.wt1<span class="op">==</span><span class="dv">1</span>][<span class="st">"stdev"</span>],</span>
<span id="cb9-156"><a href="#cb9-156" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span>df[df.wt1<span class="op">==</span><span class="dv">1</span>][<span class="st">"mean"</span>],</span>
<span id="cb9-157"><a href="#cb9-157" aria-hidden="true" tabindex="-1"></a>        mode<span class="op">=</span><span class="st">"markers"</span>,</span>
<span id="cb9-158"><a href="#cb9-158" aria-hidden="true" tabindex="-1"></a>        text<span class="op">=</span>df[df.wt1<span class="op">==</span><span class="dv">1</span>][<span class="st">"text"</span>],</span>
<span id="cb9-159"><a href="#cb9-159" aria-hidden="true" tabindex="-1"></a>        hovertemplate<span class="op">=</span><span class="st">"%</span><span class="sc">{text}</span><span class="st">&lt;extra&gt;&lt;/extra&gt;"</span>,</span>
<span id="cb9-160"><a href="#cb9-160" aria-hidden="true" tabindex="-1"></a>        marker<span class="op">=</span><span class="bu">dict</span>(size<span class="op">=</span><span class="dv">10</span>, color<span class="op">=</span><span class="st">"orange"</span>),</span>
<span id="cb9-161"><a href="#cb9-161" aria-hidden="true" tabindex="-1"></a>        name<span class="op">=</span>asset1_name</span>
<span id="cb9-162"><a href="#cb9-162" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb9-163"><a href="#cb9-163" aria-hidden="true" tabindex="-1"></a>    trace2b <span class="op">=</span> go.Scatter(</span>
<span id="cb9-164"><a href="#cb9-164" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span>df[df.wt1<span class="op">==</span><span class="dv">0</span>][<span class="st">"stdev"</span>],</span>
<span id="cb9-165"><a href="#cb9-165" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span>df[df.wt1<span class="op">==</span><span class="dv">0</span>][<span class="st">"mean"</span>],</span>
<span id="cb9-166"><a href="#cb9-166" aria-hidden="true" tabindex="-1"></a>        mode<span class="op">=</span><span class="st">"markers"</span>,</span>
<span id="cb9-167"><a href="#cb9-167" aria-hidden="true" tabindex="-1"></a>        text<span class="op">=</span>df[df.wt1<span class="op">==</span><span class="dv">0</span>][<span class="st">"text"</span>],</span>
<span id="cb9-168"><a href="#cb9-168" aria-hidden="true" tabindex="-1"></a>        hovertemplate<span class="op">=</span><span class="st">"%</span><span class="sc">{text}</span><span class="st">&lt;extra&gt;&lt;/extra&gt;"</span>,</span>
<span id="cb9-169"><a href="#cb9-169" aria-hidden="true" tabindex="-1"></a>        marker<span class="op">=</span><span class="bu">dict</span>(size<span class="op">=</span><span class="dv">10</span>, color<span class="op">=</span><span class="st">"red"</span>),</span>
<span id="cb9-170"><a href="#cb9-170" aria-hidden="true" tabindex="-1"></a>        name<span class="op">=</span>asset2_name</span>
<span id="cb9-171"><a href="#cb9-171" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb9-172"><a href="#cb9-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-173"><a href="#cb9-173" aria-hidden="true" tabindex="-1"></a>    fig <span class="op">=</span> go.Figure()</span>
<span id="cb9-174"><a href="#cb9-174" aria-hidden="true" tabindex="-1"></a>    fig.add_trace(trace2a)</span>
<span id="cb9-175"><a href="#cb9-175" aria-hidden="true" tabindex="-1"></a>    fig.add_trace(trace2b)</span>
<span id="cb9-176"><a href="#cb9-176" aria-hidden="true" tabindex="-1"></a>    fig.add_trace(trace1)</span>
<span id="cb9-177"><a href="#cb9-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-178"><a href="#cb9-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-179"><a href="#cb9-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-180"><a href="#cb9-180" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> custom(string, ports,srTang,borrow_flag):</span>
<span id="cb9-181"><a href="#cb9-181" aria-hidden="true" tabindex="-1"></a>        <span class="co"># borrow_flag=1 adds statement about "relative to borrowing rate"</span></span>
<span id="cb9-182"><a href="#cb9-182" aria-hidden="true" tabindex="-1"></a>        cd <span class="op">=</span> np.empty(shape<span class="op">=</span>(<span class="bu">len</span>(ports), N<span class="op">+</span><span class="dv">1</span>, <span class="dv">1</span>), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb9-183"><a href="#cb9-183" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(N):</span>
<span id="cb9-184"><a href="#cb9-184" aria-hidden="true" tabindex="-1"></a>            cd[:, i] <span class="op">=</span> np.array([w[i] <span class="cf">for</span> w <span class="kw">in</span> ports]).reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb9-185"><a href="#cb9-185" aria-hidden="true" tabindex="-1"></a>        cd[:,N] <span class="op">=</span> np.<span class="bu">round</span>(srTang,<span class="dv">4</span>)</span>
<span id="cb9-186"><a href="#cb9-186" aria-hidden="true" tabindex="-1"></a>        <span class="co"># print(cd)</span></span>
<span id="cb9-187"><a href="#cb9-187" aria-hidden="true" tabindex="-1"></a>        string <span class="op">+=</span> <span class="st">"&lt;br&gt;"</span></span>
<span id="cb9-188"><a href="#cb9-188" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(N):</span>
<span id="cb9-189"><a href="#cb9-189" aria-hidden="true" tabindex="-1"></a>            string <span class="op">+=</span> <span class="st">"asset "</span> <span class="op">+</span> <span class="bu">str</span>(i <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb9-190"><a href="#cb9-190" aria-hidden="true" tabindex="-1"></a>            string <span class="op">+=</span> <span class="st">": %{customdata["</span></span>
<span id="cb9-191"><a href="#cb9-191" aria-hidden="true" tabindex="-1"></a>            string <span class="op">+=</span> <span class="bu">str</span>(i)</span>
<span id="cb9-192"><a href="#cb9-192" aria-hidden="true" tabindex="-1"></a>            string <span class="op">+=</span> <span class="st">"]:.1%}&lt;br&gt;"</span></span>
<span id="cb9-193"><a href="#cb9-193" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> borrow_flag<span class="op">==</span><span class="dv">1</span>:</span>
<span id="cb9-194"><a href="#cb9-194" aria-hidden="true" tabindex="-1"></a>            string <span class="op">+=</span> <span class="st">"Sharpe ratio (relative to borrowing rate): %{customdata["</span> <span class="op">+</span>  <span class="bu">str</span>(N) <span class="op">+</span> <span class="st">"]:.4f}&lt;br&gt;"</span>    </span>
<span id="cb9-195"><a href="#cb9-195" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb9-196"><a href="#cb9-196" aria-hidden="true" tabindex="-1"></a>            string <span class="op">+=</span> <span class="st">"Sharpe ratio: %{customdata["</span> <span class="op">+</span>  <span class="bu">str</span>(N) <span class="op">+</span> <span class="st">"]:.4f}&lt;br&gt;"</span></span>
<span id="cb9-197"><a href="#cb9-197" aria-hidden="true" tabindex="-1"></a>        string <span class="op">+=</span> <span class="st">"&lt;extra&gt;&lt;/extra&gt;"</span></span>
<span id="cb9-198"><a href="#cb9-198" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> string, cd  </span>
<span id="cb9-199"><a href="#cb9-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-200"><a href="#cb9-200" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot the tangency portfolios</span></span>
<span id="cb9-201"><a href="#cb9-201" aria-hidden="true" tabindex="-1"></a>    c <span class="op">=</span> c <span class="op">/</span> <span class="dv">100</span></span>
<span id="cb9-202"><a href="#cb9-202" aria-hidden="true" tabindex="-1"></a>    rb <span class="op">=</span> rs <span class="op">+</span> extra     </span>
<span id="cb9-203"><a href="#cb9-203" aria-hidden="true" tabindex="-1"></a>    rs <span class="op">=</span> rs<span class="op">/</span><span class="dv">100</span></span>
<span id="cb9-204"><a href="#cb9-204" aria-hidden="true" tabindex="-1"></a>    rb <span class="op">=</span> rb<span class="op">/</span><span class="dv">100</span></span>
<span id="cb9-205"><a href="#cb9-205" aria-hidden="true" tabindex="-1"></a>    mns <span class="op">=</span> [mn1, mn2]</span>
<span id="cb9-206"><a href="#cb9-206" aria-hidden="true" tabindex="-1"></a>    mns <span class="op">=</span> np.array(mns) <span class="op">/</span> <span class="dv">100</span></span>
<span id="cb9-207"><a href="#cb9-207" aria-hidden="true" tabindex="-1"></a>    sds <span class="op">=</span> [sd1, sd2]</span>
<span id="cb9-208"><a href="#cb9-208" aria-hidden="true" tabindex="-1"></a>    sds <span class="op">=</span> np.array(sds) <span class="op">/</span> <span class="dv">100</span></span>
<span id="cb9-209"><a href="#cb9-209" aria-hidden="true" tabindex="-1"></a>    cov <span class="op">=</span> np.array(</span>
<span id="cb9-210"><a href="#cb9-210" aria-hidden="true" tabindex="-1"></a>        [[sds[<span class="dv">0</span>] <span class="op">**</span> <span class="dv">2</span>, sds[<span class="dv">0</span>] <span class="op">*</span> sds[<span class="dv">1</span>] <span class="op">*</span> c], [sds[<span class="dv">0</span>] <span class="op">*</span> sds[<span class="dv">1</span>] <span class="op">*</span> c, sds[<span class="dv">1</span>] <span class="op">**</span> <span class="dv">2</span>]]</span>
<span id="cb9-211"><a href="#cb9-211" aria-hidden="true" tabindex="-1"></a>    ).reshape(<span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb9-212"><a href="#cb9-212" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-213"><a href="#cb9-213" aria-hidden="true" tabindex="-1"></a>    Shorts <span class="op">=</span> <span class="fl">0.0</span>     </span>
<span id="cb9-214"><a href="#cb9-214" aria-hidden="true" tabindex="-1"></a>    N <span class="op">=</span> <span class="bu">len</span>(mns)</span>
<span id="cb9-215"><a href="#cb9-215" aria-hidden="true" tabindex="-1"></a>    P <span class="op">=</span> portfolio(mns, cov, Shorts)    </span>
<span id="cb9-216"><a href="#cb9-216" aria-hidden="true" tabindex="-1"></a>    gmv <span class="op">=</span> P.GMV <span class="op">@</span> mns</span>
<span id="cb9-217"><a href="#cb9-217" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print('GMV return is: ',gmv)</span></span>
<span id="cb9-218"><a href="#cb9-218" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (rs <span class="op">&lt;</span> gmv) <span class="kw">or</span> (<span class="kw">not</span> Shorts):</span>
<span id="cb9-219"><a href="#cb9-219" aria-hidden="true" tabindex="-1"></a>        portTang <span class="op">=</span> P.tangency(rs)</span>
<span id="cb9-220"><a href="#cb9-220" aria-hidden="true" tabindex="-1"></a>        mnTang <span class="op">=</span> portTang <span class="op">@</span> mns</span>
<span id="cb9-221"><a href="#cb9-221" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> mnTang <span class="op">&lt;</span> np.<span class="bu">max</span>(mns):</span>
<span id="cb9-222"><a href="#cb9-222" aria-hidden="true" tabindex="-1"></a>            sdTang <span class="op">=</span> np.sqrt(portTang <span class="op">@</span> cov <span class="op">@</span> portTang)</span>
<span id="cb9-223"><a href="#cb9-223" aria-hidden="true" tabindex="-1"></a>            srTang <span class="op">=</span> (mnTang <span class="op">-</span> rs)<span class="op">/</span>sdTang</span>
<span id="cb9-224"><a href="#cb9-224" aria-hidden="true" tabindex="-1"></a>            string0 <span class="op">=</span> <span class="st">'tangency portfolio'</span> <span class="cf">if</span> rb <span class="op">==</span> rs <span class="cf">else</span> <span class="st">'efficient low risk portfolio'</span> <span class="cf">if</span> rb <span class="op">!=</span> rs <span class="cf">else</span> <span class="st">'tangency portfolio'</span></span>
<span id="cb9-225"><a href="#cb9-225" aria-hidden="true" tabindex="-1"></a>            string, cd <span class="op">=</span> custom(string0, [portTang], srTang,<span class="dv">0</span>)</span>
<span id="cb9-226"><a href="#cb9-226" aria-hidden="true" tabindex="-1"></a>            trace <span class="op">=</span> go.Scatter(</span>
<span id="cb9-227"><a href="#cb9-227" aria-hidden="true" tabindex="-1"></a>                x<span class="op">=</span>[sdTang],</span>
<span id="cb9-228"><a href="#cb9-228" aria-hidden="true" tabindex="-1"></a>                y<span class="op">=</span>[mnTang],</span>
<span id="cb9-229"><a href="#cb9-229" aria-hidden="true" tabindex="-1"></a>                mode<span class="op">=</span><span class="st">"markers"</span>,</span>
<span id="cb9-230"><a href="#cb9-230" aria-hidden="true" tabindex="-1"></a>                customdata<span class="op">=</span>cd,</span>
<span id="cb9-231"><a href="#cb9-231" aria-hidden="true" tabindex="-1"></a>                hovertemplate<span class="op">=</span>string,</span>
<span id="cb9-232"><a href="#cb9-232" aria-hidden="true" tabindex="-1"></a>                marker<span class="op">=</span><span class="bu">dict</span>(size<span class="op">=</span><span class="dv">10</span>, color<span class="op">=</span><span class="st">"blue"</span>),</span>
<span id="cb9-233"><a href="#cb9-233" aria-hidden="true" tabindex="-1"></a>                name<span class="op">=</span>string0</span>
<span id="cb9-234"><a href="#cb9-234" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb9-235"><a href="#cb9-235" aria-hidden="true" tabindex="-1"></a>            fig.add_trace(trace)</span>
<span id="cb9-236"><a href="#cb9-236" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb9-237"><a href="#cb9-237" aria-hidden="true" tabindex="-1"></a>            <span class="co">#Plot CAL (no leverage)</span></span>
<span id="cb9-238"><a href="#cb9-238" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> rb<span class="op">==</span>rs:</span>
<span id="cb9-239"><a href="#cb9-239" aria-hidden="true" tabindex="-1"></a>                max_wgt <span class="op">=</span> <span class="fl">4.0</span></span>
<span id="cb9-240"><a href="#cb9-240" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb9-241"><a href="#cb9-241" aria-hidden="true" tabindex="-1"></a>                max_wgt <span class="op">=</span> <span class="fl">1.0</span></span>
<span id="cb9-242"><a href="#cb9-242" aria-hidden="true" tabindex="-1"></a>            grid, mns_cal, sds_cal, srs_cal, srb_cal <span class="op">=</span> rf_plus_risky(mnTang<span class="op">*</span><span class="dv">100</span>, sdTang<span class="op">*</span><span class="dv">100</span>, rs<span class="op">*</span><span class="dv">100</span>,rb<span class="op">*</span><span class="dv">100</span>,<span class="dv">0</span>, max_wgt)</span>
<span id="cb9-243"><a href="#cb9-243" aria-hidden="true" tabindex="-1"></a>            portlabel <span class="op">=</span> <span class="st">'tangency portfolio'</span> <span class="cf">if</span> rb <span class="op">==</span> rs <span class="cf">else</span> <span class="st">'efficient low risk portfolio'</span> <span class="cf">if</span> rb <span class="op">!=</span> rs <span class="cf">else</span> <span class="st">'tangency portfolio'</span></span>
<span id="cb9-244"><a href="#cb9-244" aria-hidden="true" tabindex="-1"></a>            string <span class="op">=</span> <span class="st">"wealth in "</span><span class="op">+</span>portlabel <span class="op">+</span> <span class="st">" = %</span><span class="sc">{text:.0f}</span><span class="st">%&lt;br&gt;"</span> <span class="op">+</span> <span class="st">"Sharpe ratio: "</span> <span class="op">+</span>  <span class="st">"</span><span class="sc">{:.4f}</span><span class="st">"</span>.<span class="bu">format</span>(srTang) <span class="op">+</span><span class="st">"&lt;extra&gt;&lt;/extra&gt;"</span></span>
<span id="cb9-245"><a href="#cb9-245" aria-hidden="true" tabindex="-1"></a>            trace5 <span class="op">=</span> go.Scatter(</span>
<span id="cb9-246"><a href="#cb9-246" aria-hidden="true" tabindex="-1"></a>                x<span class="op">=</span>sds_cal, </span>
<span id="cb9-247"><a href="#cb9-247" aria-hidden="true" tabindex="-1"></a>                y<span class="op">=</span>mns_cal, </span>
<span id="cb9-248"><a href="#cb9-248" aria-hidden="true" tabindex="-1"></a>                mode<span class="op">=</span><span class="st">"lines"</span>, </span>
<span id="cb9-249"><a href="#cb9-249" aria-hidden="true" tabindex="-1"></a>                text<span class="op">=</span><span class="dv">100</span> <span class="op">*</span> grid, </span>
<span id="cb9-250"><a href="#cb9-250" aria-hidden="true" tabindex="-1"></a>                hovertemplate<span class="op">=</span>string, </span>
<span id="cb9-251"><a href="#cb9-251" aria-hidden="true" tabindex="-1"></a>                line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">"blue"</span>),</span>
<span id="cb9-252"><a href="#cb9-252" aria-hidden="true" tabindex="-1"></a>                name<span class="op">=</span><span class="st">"CAL: "</span> <span class="op">+</span> portlabel</span>
<span id="cb9-253"><a href="#cb9-253" aria-hidden="true" tabindex="-1"></a>            )           </span>
<span id="cb9-254"><a href="#cb9-254" aria-hidden="true" tabindex="-1"></a>            fig.add_trace(trace5)</span>
<span id="cb9-255"><a href="#cb9-255" aria-hidden="true" tabindex="-1"></a>              </span>
<span id="cb9-256"><a href="#cb9-256" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb9-257"><a href="#cb9-257" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb9-258"><a href="#cb9-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-259"><a href="#cb9-259" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (rb <span class="op">!=</span> rs) <span class="kw">and</span> ((gmv <span class="op">&gt;</span> rb) <span class="kw">or</span> (<span class="kw">not</span> Shorts)):</span>
<span id="cb9-260"><a href="#cb9-260" aria-hidden="true" tabindex="-1"></a>        portTang <span class="op">=</span> P.tangency(rb)</span>
<span id="cb9-261"><a href="#cb9-261" aria-hidden="true" tabindex="-1"></a>        mnTang <span class="op">=</span> portTang <span class="op">@</span> mns</span>
<span id="cb9-262"><a href="#cb9-262" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> mnTang <span class="op">&lt;</span> np.<span class="bu">max</span>(mns):</span>
<span id="cb9-263"><a href="#cb9-263" aria-hidden="true" tabindex="-1"></a>            sdTang <span class="op">=</span> np.sqrt(portTang <span class="op">@</span> cov <span class="op">@</span> portTang)</span>
<span id="cb9-264"><a href="#cb9-264" aria-hidden="true" tabindex="-1"></a>            srTang <span class="op">=</span> (mnTang <span class="op">-</span> rb)<span class="op">/</span>sdTang</span>
<span id="cb9-265"><a href="#cb9-265" aria-hidden="true" tabindex="-1"></a>            string <span class="op">=</span> <span class="st">'efficient high mean portfolio'</span></span>
<span id="cb9-266"><a href="#cb9-266" aria-hidden="true" tabindex="-1"></a>            string, cd <span class="op">=</span> custom(string, [portTang], srTang,<span class="dv">1</span>)</span>
<span id="cb9-267"><a href="#cb9-267" aria-hidden="true" tabindex="-1"></a>            trace <span class="op">=</span> go.Scatter(</span>
<span id="cb9-268"><a href="#cb9-268" aria-hidden="true" tabindex="-1"></a>                x<span class="op">=</span>[sdTang],</span>
<span id="cb9-269"><a href="#cb9-269" aria-hidden="true" tabindex="-1"></a>                y<span class="op">=</span>[mnTang],</span>
<span id="cb9-270"><a href="#cb9-270" aria-hidden="true" tabindex="-1"></a>                mode<span class="op">=</span><span class="st">"markers"</span>,</span>
<span id="cb9-271"><a href="#cb9-271" aria-hidden="true" tabindex="-1"></a>                customdata<span class="op">=</span>cd,</span>
<span id="cb9-272"><a href="#cb9-272" aria-hidden="true" tabindex="-1"></a>                hovertemplate<span class="op">=</span>string,</span>
<span id="cb9-273"><a href="#cb9-273" aria-hidden="true" tabindex="-1"></a>                marker<span class="op">=</span><span class="bu">dict</span>(size<span class="op">=</span><span class="dv">10</span>, color<span class="op">=</span><span class="st">"blue"</span>),</span>
<span id="cb9-274"><a href="#cb9-274" aria-hidden="true" tabindex="-1"></a>                name<span class="op">=</span><span class="st">"efficient high mean portfolio"</span></span>
<span id="cb9-275"><a href="#cb9-275" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb9-276"><a href="#cb9-276" aria-hidden="true" tabindex="-1"></a>            fig.add_trace(trace)</span>
<span id="cb9-277"><a href="#cb9-277" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb9-278"><a href="#cb9-278" aria-hidden="true" tabindex="-1"></a>            <span class="co">#Plot CAL (with leverage)            </span></span>
<span id="cb9-279"><a href="#cb9-279" aria-hidden="true" tabindex="-1"></a>            grid, mns_cal, sds_cal, srs_cal, srb_cal <span class="op">=</span> rf_plus_risky(mnTang<span class="op">*</span><span class="dv">100</span>, sdTang<span class="op">*</span><span class="dv">100</span>, rs<span class="op">*</span><span class="dv">100</span>,rb<span class="op">*</span><span class="dv">100</span>, <span class="fl">1.0</span>, <span class="fl">1.5</span>)</span>
<span id="cb9-280"><a href="#cb9-280" aria-hidden="true" tabindex="-1"></a>            string <span class="op">=</span> <span class="st">"wealth in efficient high mean portfolio = %</span><span class="sc">{text:.0f}</span><span class="st">%&lt;br&gt;"</span> <span class="op">+</span> <span class="st">"Sharpe ratio (relative to borrowing rate): "</span> <span class="op">+</span> <span class="st">"</span><span class="sc">{:.4f}</span><span class="st">"</span>.<span class="bu">format</span>(srTang) <span class="op">+</span><span class="st">"&lt;extra&gt;&lt;/extra&gt;"</span></span>
<span id="cb9-281"><a href="#cb9-281" aria-hidden="true" tabindex="-1"></a>            trace6 <span class="op">=</span> go.Scatter(</span>
<span id="cb9-282"><a href="#cb9-282" aria-hidden="true" tabindex="-1"></a>                x<span class="op">=</span>sds_cal, </span>
<span id="cb9-283"><a href="#cb9-283" aria-hidden="true" tabindex="-1"></a>                y<span class="op">=</span>mns_cal, </span>
<span id="cb9-284"><a href="#cb9-284" aria-hidden="true" tabindex="-1"></a>                mode<span class="op">=</span><span class="st">"lines"</span>, </span>
<span id="cb9-285"><a href="#cb9-285" aria-hidden="true" tabindex="-1"></a>                text<span class="op">=</span><span class="dv">100</span> <span class="op">*</span> grid, </span>
<span id="cb9-286"><a href="#cb9-286" aria-hidden="true" tabindex="-1"></a>                hovertemplate<span class="op">=</span>string,</span>
<span id="cb9-287"><a href="#cb9-287" aria-hidden="true" tabindex="-1"></a>                line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">"blue"</span>),</span>
<span id="cb9-288"><a href="#cb9-288" aria-hidden="true" tabindex="-1"></a>                name <span class="op">=</span> <span class="st">"CAL: efficient high mean"</span></span>
<span id="cb9-289"><a href="#cb9-289" aria-hidden="true" tabindex="-1"></a>            )           </span>
<span id="cb9-290"><a href="#cb9-290" aria-hidden="true" tabindex="-1"></a>            fig.add_trace(trace6)   </span>
<span id="cb9-291"><a href="#cb9-291" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb9-292"><a href="#cb9-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-293"><a href="#cb9-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-294"><a href="#cb9-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-295"><a href="#cb9-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-296"><a href="#cb9-296" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Utility plot info</span></span>
<span id="cb9-297"><a href="#cb9-297" aria-hidden="true" tabindex="-1"></a>    u1, wgt1, wgt_rf1, wgt_lo1, wgt_hi1 <span class="op">=</span> opt_utility(mns, cov, Shorts, rs, rb, raver1)</span>
<span id="cb9-298"><a href="#cb9-298" aria-hidden="true" tabindex="-1"></a>    u2, wgt2, wgt_rf2, wgt_lo2, wgt_hi2 <span class="op">=</span> opt_utility(mns, cov, Shorts, rs, rb, raver2)</span>
<span id="cb9-299"><a href="#cb9-299" aria-hidden="true" tabindex="-1"></a>    string1<span class="op">=</span><span class="st">'Risk Aversion='</span><span class="op">+</span><span class="bu">str</span>(raver1)</span>
<span id="cb9-300"><a href="#cb9-300" aria-hidden="true" tabindex="-1"></a>    string2<span class="op">=</span><span class="st">'Risk Aversion='</span><span class="op">+</span><span class="bu">str</span>(raver2)</span>
<span id="cb9-301"><a href="#cb9-301" aria-hidden="true" tabindex="-1"></a>    grid <span class="op">=</span> np.linspace(<span class="dv">0</span>,<span class="fl">1.4</span>,<span class="dv">100</span>)</span>
<span id="cb9-302"><a href="#cb9-302" aria-hidden="true" tabindex="-1"></a>    sds <span class="op">=</span> [w<span class="op">*</span>np.<span class="bu">max</span>(sds) <span class="cf">for</span> w <span class="kw">in</span> grid]</span>
<span id="cb9-303"><a href="#cb9-303" aria-hidden="true" tabindex="-1"></a>    eret1 <span class="op">=</span> [u1 <span class="op">+</span> <span class="fl">0.5</span><span class="op">*</span>raver1<span class="op">*</span> (sd<span class="op">**</span><span class="dv">2</span>) <span class="cf">for</span> sd <span class="kw">in</span> sds]</span>
<span id="cb9-304"><a href="#cb9-304" aria-hidden="true" tabindex="-1"></a>    eret2 <span class="op">=</span> [u2 <span class="op">+</span> <span class="fl">0.5</span><span class="op">*</span>raver2<span class="op">*</span> (sd<span class="op">**</span><span class="dv">2</span>) <span class="cf">for</span> sd <span class="kw">in</span> sds] </span>
<span id="cb9-305"><a href="#cb9-305" aria-hidden="true" tabindex="-1"></a>    <span class="co"># df = pd.DataFrame(data={'Standard Deviation': sds, string1: U1, string2: U2})</span></span>
<span id="cb9-306"><a href="#cb9-306" aria-hidden="true" tabindex="-1"></a>    string <span class="op">=</span> <span class="st">"indifference curve for &lt;br&gt; optimal utility for risk aversion of "</span><span class="op">+</span><span class="bu">str</span>(np.<span class="bu">round</span>(raver1,<span class="dv">1</span>))<span class="op">+</span><span class="st">"&lt;extra&gt;&lt;/extra&gt;"</span></span>
<span id="cb9-307"><a href="#cb9-307" aria-hidden="true" tabindex="-1"></a>    trace7 <span class="op">=</span> go.Scatter(</span>
<span id="cb9-308"><a href="#cb9-308" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span>sds, y<span class="op">=</span>eret1, mode<span class="op">=</span><span class="st">"lines"</span>, hovertemplate<span class="op">=</span>string, name<span class="op">=</span>string1, line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">"purple"</span>,dash<span class="op">=</span><span class="st">'dot'</span>),</span>
<span id="cb9-309"><a href="#cb9-309" aria-hidden="true" tabindex="-1"></a>    )  </span>
<span id="cb9-310"><a href="#cb9-310" aria-hidden="true" tabindex="-1"></a>    string <span class="op">=</span> <span class="st">"indifference curve for &lt;br&gt; optimal utility for risk aversion of "</span><span class="op">+</span><span class="bu">str</span>(np.<span class="bu">round</span>(raver2,<span class="dv">1</span>))<span class="op">+</span><span class="st">"&lt;extra&gt;&lt;/extra&gt;"</span></span>
<span id="cb9-311"><a href="#cb9-311" aria-hidden="true" tabindex="-1"></a>    trace8 <span class="op">=</span> go.Scatter(</span>
<span id="cb9-312"><a href="#cb9-312" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span>sds, y<span class="op">=</span>eret2, mode<span class="op">=</span><span class="st">"lines"</span>, hovertemplate<span class="op">=</span>string, name<span class="op">=</span>string2, line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">"purple"</span>),</span>
<span id="cb9-313"><a href="#cb9-313" aria-hidden="true" tabindex="-1"></a>    )  </span>
<span id="cb9-314"><a href="#cb9-314" aria-hidden="true" tabindex="-1"></a>    fig.add_trace(trace7) </span>
<span id="cb9-315"><a href="#cb9-315" aria-hidden="true" tabindex="-1"></a>    fig.add_trace(trace8) </span>
<span id="cb9-316"><a href="#cb9-316" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb9-317"><a href="#cb9-317" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-318"><a href="#cb9-318" aria-hidden="true" tabindex="-1"></a>    fig.layout.xaxis[<span class="st">"title"</span>] <span class="op">=</span> <span class="st">"Standard Deviation"</span></span>
<span id="cb9-319"><a href="#cb9-319" aria-hidden="true" tabindex="-1"></a>    fig.layout.yaxis[<span class="st">"title"</span>] <span class="op">=</span> <span class="st">"Expected Return"</span></span>
<span id="cb9-320"><a href="#cb9-320" aria-hidden="true" tabindex="-1"></a>    fig.update_xaxes(<span class="bu">range</span><span class="op">=</span>[<span class="dv">0</span>, <span class="fl">1.25</span> <span class="op">*</span> df[<span class="st">"stdev"</span>].<span class="bu">max</span>()])</span>
<span id="cb9-321"><a href="#cb9-321" aria-hidden="true" tabindex="-1"></a>    fig.update_yaxes(<span class="bu">range</span><span class="op">=</span>[<span class="dv">0</span>, <span class="fl">1.25</span> <span class="op">*</span> df[<span class="st">"mean"</span>].<span class="bu">max</span>()])</span>
<span id="cb9-322"><a href="#cb9-322" aria-hidden="true" tabindex="-1"></a>    fig.update_yaxes(tickformat<span class="op">=</span><span class="st">".0%"</span>)</span>
<span id="cb9-323"><a href="#cb9-323" aria-hidden="true" tabindex="-1"></a>    fig.update_xaxes(tickformat<span class="op">=</span><span class="st">".0%"</span>)</span>
<span id="cb9-324"><a href="#cb9-324" aria-hidden="true" tabindex="-1"></a>    fig.show()</span>
<span id="cb9-325"><a href="#cb9-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-326"><a href="#cb9-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-327"><a href="#cb9-327" aria-hidden="true" tabindex="-1"></a>    <span class="co">#2nd plot of risky asset share as function of risk aversion:</span></span>
<span id="cb9-328"><a href="#cb9-328" aria-hidden="true" tabindex="-1"></a>    ravers <span class="op">=</span> np.arange(<span class="fl">0.2</span>,<span class="dv">20</span>,<span class="fl">0.1</span>)</span>
<span id="cb9-329"><a href="#cb9-329" aria-hidden="true" tabindex="-1"></a>    cd <span class="op">=</span> np.empty(shape<span class="op">=</span>(<span class="bu">len</span>(ravers),<span class="dv">5</span>,<span class="dv">1</span>),dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb9-330"><a href="#cb9-330" aria-hidden="true" tabindex="-1"></a>    wgts <span class="op">=</span> [opt_utility(mns, cov, Shorts, rs, rb, A) <span class="cf">for</span> A <span class="kw">in</span> ravers]</span>
<span id="cb9-331"><a href="#cb9-331" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> pd.DataFrame(wgts, columns<span class="op">=</span>[<span class="st">'u'</span>,<span class="st">'wgt_risky'</span>,<span class="st">'wgt_rf'</span>,<span class="st">'wgt_lowrisk'</span>,<span class="st">'wgt_highrisk'</span>])</span>
<span id="cb9-332"><a href="#cb9-332" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (rb <span class="op">!=</span> rs):</span>
<span id="cb9-333"><a href="#cb9-333" aria-hidden="true" tabindex="-1"></a>        custdat <span class="op">=</span> np.empty(shape<span class="op">=</span>(df.shape[<span class="dv">0</span>],<span class="dv">3</span>,<span class="dv">1</span>), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb9-334"><a href="#cb9-334" aria-hidden="true" tabindex="-1"></a>        custdat[:,<span class="dv">0</span>] <span class="op">=</span> np.array(<span class="dv">100</span><span class="op">*</span>df.wgt_rf).reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb9-335"><a href="#cb9-335" aria-hidden="true" tabindex="-1"></a>        custdat[:,<span class="dv">1</span>] <span class="op">=</span> np.array(<span class="dv">100</span><span class="op">*</span>df.wgt_lowrisk).reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb9-336"><a href="#cb9-336" aria-hidden="true" tabindex="-1"></a>        custdat[:,<span class="dv">2</span>] <span class="op">=</span> np.array(<span class="dv">100</span><span class="op">*</span>df.wgt_highrisk).reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb9-337"><a href="#cb9-337" aria-hidden="true" tabindex="-1"></a>        string <span class="op">=</span> <span class="st">'risk-free: %</span><span class="sc">{customdata[0]:.0f}</span><span class="st">%&lt;br&gt;'</span></span>
<span id="cb9-338"><a href="#cb9-338" aria-hidden="true" tabindex="-1"></a>        string<span class="op">+=</span> <span class="st">'efficient low-risk: %</span><span class="sc">{customdata[1]:.0f}</span><span class="st">%&lt;br&gt;'</span></span>
<span id="cb9-339"><a href="#cb9-339" aria-hidden="true" tabindex="-1"></a>        string<span class="op">+=</span> <span class="st">'efficient high-risk: %</span><span class="sc">{customdata[2]:.0f}</span><span class="st">%&lt;br&gt;'</span></span>
<span id="cb9-340"><a href="#cb9-340" aria-hidden="true" tabindex="-1"></a>        string<span class="op">+=</span> <span class="st">'&lt;extra&gt;&lt;/extra&gt;'</span></span>
<span id="cb9-341"><a href="#cb9-341" aria-hidden="true" tabindex="-1"></a>        trace1 <span class="op">=</span> go.Scatter(x<span class="op">=</span>ravers,y<span class="op">=</span>df[<span class="st">'wgt_risky'</span>],mode<span class="op">=</span><span class="st">'lines'</span>,customdata<span class="op">=</span>custdat,hovertemplate<span class="op">=</span>string, line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">"orange"</span>))</span>
<span id="cb9-342"><a href="#cb9-342" aria-hidden="true" tabindex="-1"></a>        fig <span class="op">=</span> go.Figure()</span>
<span id="cb9-343"><a href="#cb9-343" aria-hidden="true" tabindex="-1"></a>        fig.add_trace(trace1)</span>
<span id="cb9-344"><a href="#cb9-344" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb9-345"><a href="#cb9-345" aria-hidden="true" tabindex="-1"></a>        custdat <span class="op">=</span> np.empty(shape<span class="op">=</span>(df.shape[<span class="dv">0</span>],<span class="dv">2</span>,<span class="dv">1</span>), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb9-346"><a href="#cb9-346" aria-hidden="true" tabindex="-1"></a>        custdat[:,<span class="dv">0</span>] <span class="op">=</span> np.array(<span class="dv">100</span><span class="op">*</span>df.wgt_rf).reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb9-347"><a href="#cb9-347" aria-hidden="true" tabindex="-1"></a>        custdat[:,<span class="dv">1</span>] <span class="op">=</span> np.array(<span class="dv">100</span><span class="op">*</span>df.wgt_lowrisk).reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb9-348"><a href="#cb9-348" aria-hidden="true" tabindex="-1"></a>        string <span class="op">=</span> <span class="st">'risk-free: %</span><span class="sc">{customdata[0]:.0f}</span><span class="st">%&lt;br&gt;'</span></span>
<span id="cb9-349"><a href="#cb9-349" aria-hidden="true" tabindex="-1"></a>        string<span class="op">+=</span> <span class="st">'tangency: %</span><span class="sc">{customdata[1]:.0f}</span><span class="st">%&lt;br&gt;'</span></span>
<span id="cb9-350"><a href="#cb9-350" aria-hidden="true" tabindex="-1"></a>        string<span class="op">+=</span> <span class="st">'&lt;extra&gt;&lt;/extra&gt;'</span></span>
<span id="cb9-351"><a href="#cb9-351" aria-hidden="true" tabindex="-1"></a>        trace1 <span class="op">=</span> go.Scatter(x<span class="op">=</span>ravers,y<span class="op">=</span>df[<span class="st">'wgt_risky'</span>],mode<span class="op">=</span><span class="st">'lines'</span>,customdata<span class="op">=</span>custdat,hovertemplate<span class="op">=</span>string, line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">"orange"</span>))</span>
<span id="cb9-352"><a href="#cb9-352" aria-hidden="true" tabindex="-1"></a>        fig <span class="op">=</span> go.Figure()</span>
<span id="cb9-353"><a href="#cb9-353" aria-hidden="true" tabindex="-1"></a>        fig.add_trace(trace1)       </span>
<span id="cb9-354"><a href="#cb9-354" aria-hidden="true" tabindex="-1"></a>    fig.layout.xaxis[<span class="st">"title"</span>] <span class="op">=</span> <span class="st">"Risk Aversion"</span></span>
<span id="cb9-355"><a href="#cb9-355" aria-hidden="true" tabindex="-1"></a>    fig.layout.yaxis[<span class="st">"title"</span>] <span class="op">=</span> <span class="st">"Weight in Risky Assets"</span></span>
<span id="cb9-356"><a href="#cb9-356" aria-hidden="true" tabindex="-1"></a>    fig.update_yaxes(tickformat<span class="op">=</span><span class="st">".1%"</span>)</span>
<span id="cb9-357"><a href="#cb9-357" aria-hidden="true" tabindex="-1"></a>    fig.update_xaxes(tickformat<span class="op">=</span><span class="st">".2"</span>)</span>
<span id="cb9-358"><a href="#cb9-358" aria-hidden="true" tabindex="-1"></a>    <span class="co"># fig.show()</span></span>
<span id="cb9-359"><a href="#cb9-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-360"><a href="#cb9-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-361"><a href="#cb9-361" aria-hidden="true" tabindex="-1"></a>figtbl(mn_stock,mn_bond,sd_stock,sd_bond,corr,rs,extra,raver1, raver2, <span class="st">"Stock"</span>,<span class="st">"Bond"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-tangency-and-preferences" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">

<div>                            <div id="ce4de2ff-1191-401d-be0d-ac69b210c12b" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("ce4de2ff-1191-401d-be0d-ac69b210c12b")) {                    Plotly.newPlot(                        "ce4de2ff-1191-401d-be0d-ac69b210c12b",                        [{"hovertemplate":"%{text}<extra></extra>","marker":{"color":"orange","size":10},"mode":"markers","name":"Stock","text":["Stock"],"x":[0.2],"y":[0.08],"type":"scatter"},{"hovertemplate":"%{text}<extra></extra>","marker":{"color":"red","size":10},"mode":"markers","name":"Bond","text":["Bond"],"x":[0.035],"y":[0.035],"type":"scatter"},{"customdata":[100.0,99.0,98.0,97.0,96.0,95.0,94.0,93.0,92.0,91.0,90.0,89.0,88.0,87.0,86.0,85.0,84.0,83.0,82.0,81.0,80.0,79.0,78.0,77.0,76.0,75.0,74.0,73.0,72.0,71.0,70.0,69.0,68.0,67.0,65.99999999999999,64.99999999999999,64.0,63.0,62.0,61.0,60.0,59.0,58.00000000000001,57.00000000000001,56.00000000000001,55.00000000000001,54.0,53.0,52.0,51.0,50.0,49.0,48.0,47.0,46.0,44.99999999999999,43.99999999999999,42.99999999999999,42.00000000000001,41.0,40.0,39.0,38.0,37.0,36.0,35.0,34.0,32.99999999999999,31.999999999999996,30.999999999999993,29.999999999999993,29.000000000000004,28.000000000000004,27.0,26.0,25.0,24.0,23.0,21.999999999999996,20.999999999999996,19.999999999999996,18.999999999999993,17.999999999999993,16.999999999999993,16.000000000000004,15.000000000000002,14.000000000000002,13.0,12.0,10.999999999999998,9.999999999999998,8.999999999999996,7.9999999999999964,6.999999999999995,5.999999999999995,4.999999999999993,4.0000000000000036,3.0000000000000027,2.0000000000000018,1.0000000000000009,0.0],"hovertemplate":"Stock: %{text:.0f}%<br>Bond: %{customdata:.0f}%<extra></extra>","line":{"color":"black"},"mode":"lines","name":"Stock & Bond Frontier","text":[0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.000000000000001,8.0,9.0,10.0,11.0,12.0,13.0,14.000000000000002,15.0,16.0,17.0,18.0,19.0,20.0,21.0,22.0,23.0,24.0,25.0,26.0,27.0,28.000000000000004,28.999999999999996,30.0,31.0,32.0,33.0,34.0,35.0,36.0,37.0,38.0,39.0,40.0,41.0,42.0,43.0,44.0,45.0,46.0,47.0,48.0,49.0,50.0,51.0,52.0,53.0,54.0,55.00000000000001,56.00000000000001,57.00000000000001,57.99999999999999,59.0,60.0,61.0,62.0,63.0,64.0,65.0,66.0,67.0,68.0,69.0,70.0,71.0,72.0,73.0,74.0,75.0,76.0,77.0,78.0,79.0,80.0,81.0,82.0,83.0,84.0,85.0,86.0,87.0,88.0,89.0,90.0,91.0,92.0,93.0,94.0,95.0,96.0,97.0,98.0,99.0,100.0],"x":[0.035,0.034607694231196626,0.034333220064538074,0.03417941632035281,0.03414791355266087,0.034239049344279404,0.03445185045828453,0.0347840840040384,0.0352323714785139,0.03579235253514359,0.03645888094826829,0.03722623402924341,0.03808831841916889,0.03903885884602674,0.040071560987812796,0.041180244049786784,0.04235894238528625,0.043601978166133704,0.04490400872973369,0.046260052961491514,0.04766550115125194,0.04911611242759346,0.05060800331963315,0.052137630364258024,0.05370176905838392,0.05529749090148666,0.056922139805175985,0.0585733087677314,0.06024881741578004,0.06194669079135704,0.06366513959774218,0.06540254199952782,0.06715742699061661,0.06892845928932402,0.07071442568528716,0.07251422274285231,0.07432684575575638,0.0761513788450347,0.07798698609383492,0.07983290361749346,0.0816884324736373,0.0835529323243655,0.0854258157701757,0.08730654328284908,0.08919461867175621,0.09108958502485341,0.09299102107192932,0.09489853792340533,0.09681177614319449,0.09873040311879619,0.10065411069598698,0.10258261304919075,0.1045156447619207,0.10645295909461605,0.10839432641979008,0.11033953280669627,0.11228837873974315,0.11424067795667181,0.11619625639408525,0.11815495122930735,0.12011661000877438,0.12208108985424401,0.12404825673906103,0.1260179848275634,0.12799015587145757,0.129964658657652,0.13194138850262263,0.13392024678890047,0.13590114053973204,0.13788398202837052,0.1398686884188166,0.14185518143515238,0.143843387056896,0.14583323523806224,0.14782465964784086,0.14981759743100942,0.15181198898637752,0.1538077777617244,0.15580491006383593,0.15780333488237822,0.15980300372646317,0.161803870472866,0.16380589122494954,0.16580902418143592,0.16781322951424302,0.1698184692546721,0.17182470718729598,0.173831908750954,0.17584004094631006,0.17784907224947788,0.1798589725312585,0.1818697129815737,0.18388126603871316,0.18589360532304494,0.18790670557486766,0.18992054259610783,0.1919350931955905,0.1939503351376326,0.19596624709372787,0.19798280859711023,0.2],"y":[0.035,0.03545,0.0359,0.03635,0.0368,0.03725,0.0377,0.038149999999999996,0.0386,0.03905,0.0395,0.03995,0.0404,0.04085,0.041299999999999996,0.041749999999999995,0.042199999999999994,0.042649999999999993,0.043100000000000006,0.043550000000000005,0.044000000000000004,0.04445,0.0449,0.04535,0.0458,0.04625,0.0467,0.04715,0.047599999999999996,0.048049999999999995,0.048499999999999995,0.048949999999999994,0.04939999999999999,0.04984999999999999,0.050300000000000004,0.05075,0.0512,0.05165,0.0521,0.05255,0.053,0.05345,0.0539,0.05435,0.0548,0.05525,0.0557,0.056150000000000005,0.056600000000000004,0.057050000000000003,0.0575,0.05795,0.0584,0.05885,0.0593,0.059750000000000004,0.060200000000000004,0.06065,0.061099999999999995,0.06155,0.062,0.06245,0.0629,0.06335,0.0638,0.06425,0.0647,0.06515,0.0656,0.06605,0.0665,0.06695000000000001,0.0674,0.06785000000000001,0.0683,0.06875,0.0692,0.06965,0.0701,0.07055,0.07100000000000001,0.07145,0.0719,0.07235,0.0728,0.07325,0.0737,0.07415,0.0746,0.07505,0.0755,0.07595,0.07640000000000001,0.07685,0.07730000000000001,0.07775,0.0782,0.07865,0.0791,0.07955,0.08],"type":"scatter"},{"customdata":[[[0.11254401505577158],[0.8874559849442285],[0.536]]],"hovertemplate":"efficient low risk portfolio<br>asset 1: %{customdata[0]:.1%}<br>asset 2: %{customdata[1]:.1%}<br>Sharpe ratio: %{customdata[2]:.4f}<br><extra></extra>","marker":{"color":"blue","size":10},"mode":"markers","name":"efficient low risk portfolio","x":[0.03743681229177574],"y":[0.04006448067750973],"type":"scatter"},{"hovertemplate":"wealth in efficient low risk portfolio = %{text:.0f}%<br>Sharpe ratio: 0.5360<extra></extra>","line":{"color":"blue"},"mode":"lines","name":"CAL: efficient low risk portfolio","text":[0.0,0.5,1.0,1.5,2.0,2.5,3.0,3.5000000000000004,4.0,4.5,5.0,5.5,6.0,6.5,7.000000000000001,7.5,8.0,8.5,9.0,9.5,10.0,10.5,11.0,11.5,12.0,12.5,13.0,13.5,14.000000000000002,14.499999999999998,15.0,15.5,16.0,16.5,17.0,17.5,18.0,18.5,19.0,19.5,20.0,20.5,21.0,21.5,22.0,22.5,23.0,23.5,24.0,24.5,25.0,25.5,26.0,26.5,27.0,27.500000000000004,28.000000000000004,28.500000000000004,28.999999999999996,29.5,30.0,30.5,31.0,31.5,32.0,32.5,33.0,33.5,34.0,34.5,35.0,35.5,36.0,36.5,37.0,37.5,38.0,38.5,39.0,39.5,40.0,40.5,41.0,41.5,42.0,42.5,43.0,43.5,44.0,44.5,45.0,45.5,46.0,46.5,47.0,47.5,48.0,48.5,49.0,49.5,50.0,50.5,51.0,51.5,52.0,52.5,53.0,53.5,54.0,54.50000000000001,55.00000000000001,55.50000000000001,56.00000000000001,56.50000000000001,57.00000000000001,57.50000000000001,57.99999999999999,58.5,59.0,59.5,60.0,60.5,61.0,61.5,62.0,62.5,63.0,63.5,64.0,64.5,65.0,65.5,66.0,66.5,67.0,67.5,68.0,68.5,69.0,69.5,70.0,70.5,71.0,71.5,72.0,72.5,73.0,73.5,74.0,74.5,75.0,75.5,76.0,76.5,77.0,77.5,78.0,78.5,79.0,79.5,80.0,80.5,81.0,81.5,82.0,82.5,83.0,83.5,84.0,84.5,85.0,85.5,86.0,86.5,87.0,87.5,88.0,88.5,89.0,89.5,90.0,90.5,91.0,91.5,92.0,92.5,93.0,93.5,94.0,94.5,95.0,95.5,96.0,96.5,97.0,97.5,98.0,98.5,99.0,99.5,100.0],"x":[0.0,0.00018718406145887872,0.00037436812291775744,0.0005615521843766361,0.0007487362458355149,0.0009359203072943936,0.0011231043687532723,0.001310288430212151,0.0014974724916710298,0.0016846565531299083,0.0018718406145887872,0.0020590246760476658,0.0022462087375065445,0.0024333927989654233,0.002620576860424302,0.0028077609218831808,0.0029949449833420595,0.0031821290448009383,0.0033693131062598166,0.0035564971677186957,0.0037436812291775745,0.003930865290636453,0.0041180493520953316,0.00430523341355421,0.004492417475013089,0.004679601536471968,0.0048667855979308465,0.005053969659389725,0.005241153720848604,0.005428337782307482,0.0056155218437663615,0.00580270590522524,0.005989889966684119,0.006177074028142998,0.0063642580896018765,0.006551442151060755,0.006738626212519633,0.006925810273978512,0.0071129943354373915,0.00730017839689627,0.007487362458355149,0.007674546519814028,0.007861730581272906,0.008048914642731785,0.008236098704190663,0.008423282765649543,0.00861046682710842,0.0087976508885673,0.008984834950026178,0.009172019011485056,0.009359203072943936,0.009546387134402815,0.009733571195861693,0.009920755257320573,0.01010793931877945,0.01029512338023833,0.010482307441697208,0.010669491503156088,0.010856675564614964,0.011043859626073843,0.011231043687532723,0.011418227748991601,0.01160541181045048,0.011792595871909358,0.011979779933368238,0.012166963994827116,0.012354148056285996,0.012541332117744875,0.012728516179203753,0.012915700240662633,0.01310288430212151,0.013290068363580388,0.013477252425039266,0.013664436486498146,0.013851620547957024,0.014038804609415903,0.014225988670874783,0.01441317273233366,0.01460035679379254,0.014787540855251418,0.014974724916710298,0.015161908978169176,0.015349093039628055,0.015536277101086935,0.01572346116254581,0.01591064522400469,0.01609782928546357,0.016285013346922447,0.016472197408381326,0.016659381469840206,0.016846565531299085,0.017033749592757965,0.01722093365421684,0.01740811771567572,0.0175953017771346,0.01778248583859348,0.017969669900052356,0.018156853961511236,0.018344038022970112,0.01853122208442899,0.01871840614588787,0.01890559020734675,0.01909277426880563,0.019279958330264507,0.019467142391723386,0.019654326453182266,0.019841510514641145,0.020028694576100025,0.0202158786375589,0.02040306269901778,0.02059024676047666,0.02077743082193554,0.020964614883394416,0.021151798944853296,0.021338983006312175,0.021526167067771055,0.021713351129229928,0.021900535190688807,0.022087719252147687,0.022274903313606566,0.022462087375065446,0.022649271436524322,0.022836455497983202,0.02302363955944208,0.02321082362090096,0.02339800768235984,0.023585191743818717,0.023772375805277596,0.023959559866736476,0.024146743928195356,0.024333927989654232,0.02452111205111311,0.02470829611257199,0.02489548017403087,0.02508266423548975,0.025269848296948626,0.025457032358407506,0.025644216419866386,0.025831400481325265,0.026018584542784145,0.02620576860424302,0.026392952665701897,0.026580136727160777,0.026767320788619653,0.026954504850078533,0.027141688911537412,0.027328872972996292,0.02751605703445517,0.027703241095914048,0.027890425157372927,0.028077609218831807,0.028264793280290686,0.028451977341749566,0.028639161403208442,0.02882634546466732,0.0290135295261262,0.02920071358758508,0.02938789764904396,0.029575081710502837,0.029762265771961716,0.029949449833420596,0.030136633894879476,0.03032381795633835,0.03051100201779723,0.03069818607925611,0.03088537014071499,0.03107255420217387,0.03125973826363274,0.03144692232509162,0.0316341063865505,0.03182129044800938,0.03200847450946826,0.03219565857092714,0.032382842632386014,0.03257002669384489,0.03275721075530377,0.03294439481676265,0.03313157887822153,0.03331876293968041,0.03350594700113929,0.03369313106259817,0.03388031512405705,0.03406749918551593,0.0342546832469748,0.03444186730843368,0.03462905136989256,0.03481623543135144,0.03500341949281032,0.0351906035542692,0.03537778761572808,0.03556497167718696,0.03575215573864584,0.03593933980010471,0.03612652386156359,0.03631370792302247,0.03650089198448135,0.036688076045940224,0.036875260107399103,0.03706244416885798,0.03724962823031686,0.03743681229177574],"y":[0.02,0.02010032240338755,0.0202006448067751,0.020300967210162647,0.020401289613550196,0.020501612016937745,0.02060193442032529,0.02070225682371284,0.02080257922710039,0.020902901630487938,0.021003224033875487,0.021103546437263036,0.021203868840650585,0.021304191244038134,0.021404513647425683,0.02150483605081323,0.02160515845420078,0.021705480857588326,0.021805803260975875,0.021906125664363424,0.022006448067750973,0.022106770471138522,0.02220709287452607,0.02230741527791362,0.02240773768130117,0.022508060084688718,0.022608382488076263,0.022708704891463816,0.02280902729485136,0.02290934969823891,0.02300967210162646,0.023109994505014008,0.023210316908401557,0.023310639311789106,0.023410961715176655,0.023511284118564204,0.023611606521951753,0.0237119289253393,0.023812251328726847,0.023912573732114396,0.024012896135501945,0.024113218538889494,0.024213540942277043,0.024313863345664592,0.02441418574905214,0.02451450815243969,0.02461483055582724,0.024715152959214788,0.024815475362602334,0.024915797765989883,0.02501612016937743,0.02511644257276498,0.02521676497615253,0.02531708737954008,0.025417409782927627,0.025517732186315176,0.025618054589702725,0.025718376993090274,0.02581869939647782,0.02591902179986537,0.026019344203252918,0.026119666606640467,0.026219989010028016,0.026320311413415565,0.026420633816803114,0.026520956220190663,0.02662127862357821,0.02672160102696576,0.02682192343035331,0.02692224583374086,0.027022568237128404,0.027122890640515953,0.027223213043903502,0.02732353544729105,0.0274238578506786,0.02752418025406615,0.027624502657453698,0.027724825060841247,0.027825147464228796,0.02792546986761634,0.028025792271003894,0.02812611467439144,0.02822643707777899,0.028326759481166537,0.028427081884554086,0.028527404287941635,0.028627726691329184,0.028728049094716733,0.02882837149810428,0.02892869390149183,0.029029016304879376,0.02912933870826693,0.029229661111654474,0.029329983515042027,0.029430305918429572,0.02953062832181712,0.02963095072520467,0.029731273128592216,0.029831595531979768,0.029931917935367314,0.030032240338754866,0.03013256274214241,0.030232885145529964,0.03033320754891751,0.03043352995230506,0.030533852355692608,0.030634174759080156,0.030734497162467705,0.030834819565855254,0.030935141969242803,0.031035464372630352,0.0311357867760179,0.031236109179405447,0.031336431582793,0.031436753986180545,0.0315370763895681,0.03163739879295564,0.03173772119634319,0.03183804359973074,0.031938366003118286,0.03203868840650584,0.032139010809893384,0.03223933321328094,0.03233965561666848,0.032439978020056034,0.03254030042344358,0.032640622826831125,0.03274094523021868,0.03284126763360623,0.032941590036993776,0.03304191244038132,0.033142234843768874,0.03324255724715642,0.03334287965054397,0.03344320205393152,0.03354352445731907,0.033643846860706615,0.03374416926409417,0.03384449166748171,0.03394481407086926,0.03404513647425681,0.03414545887764436,0.03424578128103191,0.034346103684419454,0.034446426087807,0.03454674849119455,0.034647070894582105,0.03474739329796965,0.034847715701357196,0.03494803810474475,0.0350483605081323,0.035148682911519846,0.03524900531490739,0.035349327718294944,0.03544965012168249,0.03554997252507004,0.03565029492845759,0.03575061733184513,0.035850939735232686,0.03595126213862024,0.036051584542007784,0.03615190694539533,0.03625222934878288,0.036352551752170434,0.03645287415555798,0.036553196558945525,0.03665351896233308,0.03675384136572062,0.036854163769108175,0.03695448617249572,0.037054808575883266,0.03715513097927082,0.03725545338265837,0.03735577578604592,0.03745609818943346,0.03755642059282101,0.03765674299620856,0.03775706539959611,0.03785738780298366,0.037957710206371204,0.038058032609758756,0.03815835501314631,0.038258677416533854,0.0383589998199214,0.03845932222330895,0.038559644626696504,0.03865996703008405,0.038760289433471595,0.03886061183685914,0.03896093424024669,0.039061256643634246,0.03916157904702179,0.03926190145040934,0.03936222385379688,0.039462546257184435,0.03956286866057199,0.03966319106395953,0.03976351346734708,0.03986383587073463,0.03996415827412218,0.04006448067750973],"type":"scatter"},{"customdata":[[[0.9999034043710491],[9.659562895092362e-05],[0.2]]],"hovertemplate":"efficient high mean portfolio<br>asset 1: %{customdata[0]:.1%}<br>asset 2: %{customdata[1]:.1%}<br>Sharpe ratio (relative to borrowing rate): %{customdata[2]:.4f}<br><extra></extra>","marker":{"color":"blue","size":10},"mode":"markers","name":"efficient high mean portfolio","x":[0.1999805118603658],"y":[0.0799956531966972],"type":"scatter"},{"hovertemplate":"wealth in efficient high mean portfolio = %{text:.0f}%<br>Sharpe ratio (relative to borrowing rate): 0.2000<extra></extra>","line":{"color":"blue"},"mode":"lines","name":"CAL: efficient high mean","text":[100.0,100.25,100.49999999999999,100.75,101.0,101.25,101.49999999999999,101.75,102.0,102.25,102.49999999999999,102.75000000000001,103.0,103.25,103.49999999999999,103.75000000000001,104.0,104.25,104.5,104.75000000000001,105.0,105.25,105.5,105.75000000000001,106.0,106.25,106.5,106.74999999999999,107.0,107.25,107.5,107.74999999999999,108.0,108.25,108.5,108.74999999999999,109.00000000000001,109.25,109.5,109.74999999999999,110.00000000000001,110.25,110.5,110.75,111.00000000000001,111.25,111.5,111.75,112.00000000000001,112.25,112.5,112.75,112.99999999999999,113.25,113.5,113.75,114.00000000000001,114.25,114.5,114.75,114.99999999999999,115.25000000000001,115.5,115.75,115.99999999999999,116.25000000000001,116.5,116.75,117.0,117.25000000000001,117.5,117.75,118.0,118.25000000000001,118.5,118.75,119.0,119.24999999999999,119.5,119.75,120.0,120.25000000000001,120.5,120.75,121.0,121.24999999999999,121.50000000000001,121.75,122.0,122.24999999999999,122.50000000000001,122.75,123.0,123.25,123.50000000000001,123.75,124.0,124.25,124.50000000000001,124.75,125.0,125.25,125.49999999999999,125.75,126.0,126.25,126.50000000000001,126.75,127.0,127.25,127.49999999999999,127.75000000000001,128.0,128.25,128.5,128.75,129.0,129.25,129.5,129.75,130.0,130.25,130.5,130.75,131.0,131.25,131.5,131.75,132.0,132.25,132.5,132.75,133.0,133.25,133.5,133.75,134.0,134.25,134.5,134.75,135.0,135.25,135.5,135.75,136.0,136.25,136.5,136.75,137.0,137.25,137.5,137.75,138.0,138.25,138.5,138.75,139.0,139.25,139.5,139.75,140.0,140.25,140.5,140.75,141.0,141.25,141.5,141.75,142.0,142.25,142.5,142.75,143.0,143.25,143.5,143.75,144.0,144.25,144.5,144.75,145.0,145.25,145.5,145.75,146.0,146.25,146.5,146.75,147.0,147.25,147.5,147.75,148.0,148.25,148.5,148.75,149.0,149.25,149.5,149.75,150.0],"x":[0.1999805118603658,0.20048046314001672,0.2009804144196676,0.20148036569931857,0.20198031697896945,0.20248026825862037,0.20298021953827128,0.20348017081792222,0.20398012209757313,0.20448007337722404,0.20498002465687493,0.2054799759365259,0.20597992721617678,0.2064798784958277,0.2069798297754786,0.20747978105512954,0.20797973233478045,0.20847968361443134,0.20897963489408225,0.2094795861737332,0.2099795374533841,0.21047948873303501,0.21097944001268593,0.21147939129233687,0.21197934257198778,0.21247929385163866,0.21297924513128957,0.21347919641094049,0.21397914769059143,0.21447909897024234,0.21497905024989322,0.21547900152954413,0.21597895280919507,0.21647890408884599,0.2169788553684969,0.2174788066481478,0.21797875792779875,0.21847870920744966,0.21897866048710055,0.21947861176675146,0.2199785630464024,0.2204785143260533,0.22097846560570422,0.2214784168853551,0.22197836816500607,0.22247831944465696,0.22297827072430787,0.22347822200395878,0.22397817328360972,0.22447812456326063,0.22497807584291152,0.22547802712256243,0.22597797840221334,0.22647792968186428,0.2269778809615152,0.2274778322411661,0.22797778352081705,0.22847773480046796,0.22897768608011884,0.22947763735976975,0.22997758863942067,0.2304775399190716,0.23097749119872252,0.2314774424783734,0.23197739375802431,0.23247734503767525,0.23297729631732617,0.23347724759697708,0.233977198876628,0.23447715015627893,0.23497710143592984,0.23547705271558073,0.23597700399523164,0.23647695527488258,0.2369769065545335,0.2374768578341844,0.23797680911383529,0.2384767603934862,0.23897671167313714,0.23947666295278805,0.23997661423243896,0.2404765655120899,0.2409765167917408,0.24147646807139173,0.2419764193510426,0.24247637063069352,0.24297632191034446,0.24347627318999537,0.24397622446964629,0.24447617574929717,0.24497612702894814,0.24547607830859902,0.24597602958824993,0.24647598086790085,0.24697593214755179,0.2474758834272027,0.2479758347068536,0.2484757859865045,0.24897573726615546,0.24947568854580635,0.24997563982545726,0.25047559110510814,0.25097554238475905,0.25147549366441,0.25197544494406093,0.25247539622371185,0.25297534750336276,0.25347529878301367,0.2539752500626646,0.2544752013423155,0.2549751526219664,0.2554751039016173,0.25597505518126823,0.25647500646091914,0.2569749577405701,0.25747490902022097,0.2579748602998719,0.2584748115795228,0.2589747628591737,0.2594747141388246,0.2599746654184756,0.26047461669812644,0.26097456797777735,0.2614745192574283,0.26197447053707923,0.26247442181673014,0.262974373096381,0.2634743243760319,0.2639742756556829,0.2644742269353338,0.2649741782149847,0.2654741294946356,0.2659740807742865,0.26647403205393744,0.26697398333358835,0.26747393461323926,0.2679738858928902,0.2684738371725411,0.268973788452192,0.26947373973184297,0.2699736910114939,0.27047364229114473,0.27097359357079565,0.27147354485044656,0.27197349613009747,0.27247344740974844,0.27297339868939935,0.2734733499690502,0.2739733012487012,0.2744732525283521,0.274973203808003,0.2754731550876539,0.27597310636730477,0.27647305764695573,0.27697300892660665,0.27747296020625756,0.27797291148590847,0.2784728627655594,0.2789728140452103,0.2794727653248612,0.2799727166045121,0.2804726678841631,0.28097261916381394,0.28147257044346485,0.2819725217231158,0.28247247300276673,0.28297242428241765,0.2834723755620685,0.2839723268417194,0.2844722781213703,0.2849722294010213,0.2854721806806722,0.2859721319603231,0.28647208323997403,0.28697203451962494,0.28747198579927585,0.28797193707892677,0.2884718883585777,0.2889718396382286,0.2894717909178795,0.2899717421975304,0.2904716934771814,0.29097164475683224,0.29147159603648315,0.29197154731613406,0.292471498595785,0.29297144987543594,0.29347140115508685,0.2939713524347377,0.2944713037143887,0.2949712549940396,0.2954712062736905,0.2959711575533414,0.29647110883299227,0.2969710601126432,0.29747101139229415,0.29797096267194506,0.298470913951596,0.2989708652312469,0.2994708165108978,0.2999707677905487],"y":[0.0799956531966972,0.08009564232968894,0.08019563146268069,0.08029562059567244,0.08039560972866416,0.08049559886165591,0.08059558799464765,0.0806955771276394,0.08079556626063114,0.08089555539362289,0.08099554452661463,0.08109553365960637,0.08119552279259812,0.08129551192558986,0.08139550105858159,0.08149549019157334,0.0815954793245651,0.08169546845755683,0.08179545759054857,0.08189544672354032,0.08199543585653206,0.0820954249895238,0.08219541412251555,0.0822954032555073,0.08239539238849904,0.08249538152149077,0.08259537065448253,0.08269535978747425,0.082795348920466,0.08289533805345775,0.08299532718644949,0.08309531631944123,0.08319530545243298,0.08329529458542473,0.08339528371841645,0.0834952728514082,0.08359526198439995,0.08369525111739169,0.08379524025038343,0.08389522938337518,0.08399521851636693,0.08409520764935866,0.0841951967823504,0.08429518591534214,0.0843951750483339,0.08449516418132563,0.08459515331431738,0.08469514244730912,0.08479513158030086,0.08489512071329261,0.08499510984628435,0.08509509897927608,0.08519508811226784,0.08529507724525959,0.08539506637825132,0.08549505551124306,0.08559504464423481,0.08569503377722655,0.08579502291021829,0.08589501204321004,0.08599500117620178,0.08609499030919353,0.08619497944218527,0.08629496857517702,0.08639495770816874,0.08649494684116049,0.08659493597415224,0.08669492510714398,0.08679491424013572,0.08689490337312747,0.08699489250611922,0.08709488163911094,0.0871948707721027,0.08729485990509445,0.08739484903808618,0.08749483817107792,0.08759482730406967,0.08769481643706141,0.08779480557005315,0.0878947947030449,0.08799478383603664,0.08809477296902839,0.08819476210202012,0.08829475123501188,0.08839474036800361,0.08849472950099535,0.0885947186339871,0.08869470776697884,0.08879469689997058,0.08889468603296233,0.08899467516595408,0.08909466429894582,0.08919465343193755,0.0892946425649293,0.08939463169792104,0.08949462083091278,0.08959460996390453,0.08969459909689627,0.08979458822988802,0.08989457736287976,0.08999456649587151,0.09009455562886323,0.09019454476185498,0.09029453389484673,0.09039452302783847,0.09049451216083021,0.09059450129382196,0.09069449042681371,0.09079447955980544,0.09089446869279719,0.09099445782578892,0.09109444695878068,0.09119443609177241,0.09129442522476416,0.09139441435775592,0.09149440349074764,0.09159439262373939,0.09169438175673113,0.09179437088972286,0.09189436002271462,0.09199434915570637,0.0920943382886981,0.09219432742168984,0.0922943165546816,0.09239430568767333,0.09249429482066507,0.09259428395365682,0.09269427308664856,0.09279426221964031,0.09289425135263205,0.0929942404856238,0.09309422961861553,0.09319421875160727,0.09329420788459902,0.09339419701759076,0.0934941861505825,0.09359417528357425,0.093694164416566,0.09379415354955772,0.09389414268254948,0.09399413181554123,0.09409412094853296,0.0941941100815247,0.09429409921451645,0.09439408834750819,0.09449407748049993,0.09459406661349168,0.09469405574648342,0.09479404487947517,0.0948940340124669,0.09499402314545866,0.0950940122784504,0.09519400141144213,0.09529399054443388,0.09539397967742562,0.09549396881041736,0.09559395794340911,0.09569394707640086,0.0957939362093926,0.09589392534238433,0.09599391447537609,0.09609390360836782,0.09619389274135956,0.09629388187435131,0.09639387100734306,0.0964938601403348,0.09659384927332654,0.09669383840631829,0.09679382753931001,0.09689381667230176,0.09699380580529351,0.09709379493828525,0.09719378407127699,0.09729377320426874,0.09739376233726049,0.09749375147025222,0.09759374060324397,0.0976937297362357,0.09779371886922746,0.09789370800221919,0.09799369713521094,0.0980936862682027,0.09819367540119442,0.09829366453418617,0.09839365366717791,0.09849364280016965,0.0985936319331614,0.09869362106615315,0.09879361019914489,0.09889359933213662,0.09899358846512837,0.09909357759812011,0.09919356673111185,0.0992935558641036,0.09939354499709534,0.09949353413008709,0.09959352326307883,0.09969351239607058,0.09979350152906231,0.09989349066205405,0.0999934797950458],"type":"scatter"},{"hovertemplate":"indifference curve for <br> optimal utility for risk aversion of 2<extra></extra>","line":{"color":"purple","dash":"dot"},"mode":"lines","name":"Risk Aversion=2","x":[0.0,0.0028282828282828283,0.0056565656565656566,0.008484848484848484,0.011313131313131313,0.014141414141414142,0.016969696969696968,0.0197979797979798,0.022626262626262626,0.025454545454545452,0.028282828282828285,0.031111111111111114,0.033939393939393936,0.03676767676767677,0.0395959595959596,0.04242424242424242,0.04525252525252525,0.048080808080808085,0.050909090909090904,0.05373737373737374,0.05656565656565657,0.05939393939393939,0.06222222222222223,0.06505050505050505,0.06787878787878787,0.0707070707070707,0.07353535353535354,0.07636363636363636,0.0791919191919192,0.08202020202020202,0.08484848484848484,0.08767676767676769,0.0905050505050505,0.09333333333333332,0.09616161616161617,0.09898989898989899,0.10181818181818181,0.10464646464646464,0.10747474747474749,0.1103030303030303,0.11313131313131314,0.11595959595959596,0.11878787878787878,0.12161616161616161,0.12444444444444445,0.1272727272727273,0.1301010101010101,0.13292929292929292,0.13575757575757574,0.13858585858585856,0.1414141414141414,0.14424242424242426,0.14707070707070707,0.1498989898989899,0.1527272727272727,0.15555555555555556,0.1583838383838384,0.16121212121212122,0.16404040404040404,0.16686868686868686,0.16969696969696968,0.17252525252525253,0.17535353535353537,0.1781818181818182,0.181010101010101,0.18383838383838383,0.18666666666666665,0.1894949494949495,0.19232323232323234,0.19515151515151516,0.19797979797979798,0.20080808080808082,0.20363636363636362,0.20646464646464646,0.20929292929292928,0.21212121212121213,0.21494949494949497,0.21777777777777776,0.2206060606060606,0.22343434343434343,0.22626262626262628,0.22909090909090907,0.2319191919191919,0.23474747474747476,0.23757575757575755,0.2404040404040404,0.24323232323232322,0.24606060606060606,0.2488888888888889,0.25171717171717173,0.2545454545454546,0.25737373737373737,0.2602020202020202,0.263030303030303,0.26585858585858585,0.2686868686868687,0.2715151515151515,0.27434343434343433,0.2771717171717171,0.27999999999999997],"y":[0.04759982110912344,0.0476078202928802,0.04763181784415048,0.04767181376293428,0.047727808049231595,0.047799800703042426,0.04788779172436678,0.04799178111320466,0.04811176886955605,0.04824775499342096,0.04839973948479939,0.04856772234369134,0.04875170357009681,0.0489516831640158,0.049167661125448306,0.04939963745439433,0.04964761215085388,0.04991158521482694,0.05019155664631352,0.050487526445313624,0.05079949461182725,0.05112746114585438,0.05147142604739505,0.05183138931644922,0.05220735095301692,0.05259931095709813,0.053007269328692874,0.053431226067801124,0.053871181174422904,0.05432713464855819,0.054799086490207004,0.05528703669936934,0.05579098527604518,0.05631093222023455,0.05684687753193744,0.05739882121115385,0.05796676325788377,0.05855070367212721,0.059150642453884184,0.059766579603154665,0.06039851511993866,0.061046449004236183,0.06171038125604722,0.06239031187537178,0.06308624086220986,0.06379816821656145,0.06452609393842657,0.0652700180278052,0.06602994048469736,0.06680586130910303,0.06759778050102222,0.06840569806045493,0.06922961398740117,0.07006952828186092,0.07092544094383418,0.07179735197332097,0.07268526137032129,0.0735891691348351,0.07450907526686244,0.07544497976640331,0.07639688263345769,0.07736478386802559,0.07834868347010701,0.07934858143970196,0.08036447777681041,0.08139637248143239,0.08244426555356787,0.0835081569932169,0.08458804680037944,0.0856839349750555,0.08679582151724506,0.08792370642694816,0.08906758970416476,0.09022747134889489,0.09140335136113853,0.09259522974089571,0.09380310648816641,0.09502698160295059,0.09626685508524832,0.09752272693505956,0.09879459715238434,0.1000824657372226,0.10138633268957442,0.10270619800943974,0.10404206169681857,0.10539392375171093,0.1067617841741168,0.1081456429640362,0.10954550012146913,0.11096135564641557,0.11239320953887552,0.11384106179884898,0.11530491242633598,0.11678476142133645,0.1182806087838505,0.11979245451387807,0.1213202986114191,0.1228641410764737,0.1244239819090418,0.12599982110912342],"type":"scatter"},{"hovertemplate":"indifference curve for <br> optimal utility for risk aversion of 5<extra></extra>","line":{"color":"purple"},"mode":"lines","name":"Risk Aversion=5","x":[0.0,0.0028282828282828283,0.0056565656565656566,0.008484848484848484,0.011313131313131313,0.014141414141414142,0.016969696969696968,0.0197979797979798,0.022626262626262626,0.025454545454545452,0.028282828282828285,0.031111111111111114,0.033939393939393936,0.03676767676767677,0.0395959595959596,0.04242424242424242,0.04525252525252525,0.048080808080808085,0.050909090909090904,0.05373737373737374,0.05656565656565657,0.05939393939393939,0.06222222222222223,0.06505050505050505,0.06787878787878787,0.0707070707070707,0.07353535353535354,0.07636363636363636,0.0791919191919192,0.08202020202020202,0.08484848484848484,0.08767676767676769,0.0905050505050505,0.09333333333333332,0.09616161616161617,0.09898989898989899,0.10181818181818181,0.10464646464646464,0.10747474747474749,0.1103030303030303,0.11313131313131314,0.11595959595959596,0.11878787878787878,0.12161616161616161,0.12444444444444445,0.1272727272727273,0.1301010101010101,0.13292929292929292,0.13575757575757574,0.13858585858585856,0.1414141414141414,0.14424242424242426,0.14707070707070707,0.1498989898989899,0.1527272727272727,0.15555555555555556,0.1583838383838384,0.16121212121212122,0.16404040404040404,0.16686868686868686,0.16969696969696968,0.17252525252525253,0.17535353535353537,0.1781818181818182,0.181010101010101,0.18383838383838383,0.18666666666666665,0.1894949494949495,0.19232323232323234,0.19515151515151516,0.19797979797979798,0.20080808080808082,0.20363636363636362,0.20646464646464646,0.20929292929292928,0.21212121212121213,0.21494949494949497,0.21777777777777776,0.2206060606060606,0.22343434343434343,0.22626262626262628,0.22909090909090907,0.2319191919191919,0.23474747474747476,0.23757575757575755,0.2404040404040404,0.24323232323232322,0.24606060606060606,0.2488888888888889,0.25171717171717173,0.2545454545454546,0.25737373737373737,0.2602020202020202,0.263030303030303,0.26585858585858585,0.2686868686868687,0.2715151515151515,0.27434343434343433,0.2771717171717171,0.27999999999999997],"y":[0.03860599284436494,0.03862599080375684,0.03868598468193253,0.038785974478892024,0.03892596019463532,0.03910594182916241,0.0393259193824733,0.039585892854567976,0.03988586224544646,0.04022582755510874,0.040605788783554815,0.04102574593078469,0.04148569899679836,0.04198564798159583,0.0425255928851771,0.043105533707542165,0.043725470448691024,0.04438540310862369,0.04508533168734014,0.0458252561848404,0.046605176601124454,0.0474250929361923,0.04828500519004395,0.0491849133626794,0.050124817454098636,0.051104717464301674,0.05212461339328851,0.05318450524105915,0.05428439300761359,0.055424276692951815,0.05660415629707384,0.05782403181997967,0.05908390326166929,0.06038377062214271,0.06172363390139994,0.06310349309944095,0.06452334821626576,0.06598319925187437,0.0674830462062668,0.06902288907944298,0.07060272787140301,0.0722225625821468,0.07388239321167439,0.07558221975998579,0.077322042227081,0.07910186061295998,0.08092167491762277,0.08278148514106935,0.08468129128329974,0.08662109334431392,0.08860089132411189,0.09062068522269369,0.09268047504005925,0.09478026077620863,0.09692004243114179,0.09909982000485876,0.10131959349735956,0.10357936290864411,0.10587912823871246,0.10821888948756461,0.11059864665520056,0.11301839974162031,0.11547814874682388,0.11797789367081124,0.12051763451358236,0.12309737127513729,0.12571710395547603,0.12837683255459859,0.13107655707250496,0.13381627750919506,0.136595993864669,0.13941570613892673,0.14227541433196822,0.14517511844379355,0.1481148184744027,0.15109451442379562,0.15411420629197237,0.15717389407893284,0.16027357778467716,0.16341325740920526,0.1665929329525172,0.16981260441461285,0.1730722717954924,0.1763719350951557,0.17971159431360273,0.18309124945083366,0.18651090050684835,0.18997054748164685,0.19347019037522917,0.19700982918759524,0.20058946391874513,0.20420909456867878,0.20786872113739627,0.2115683436248975,0.2153079620311826,0.2190875763562515,0.2229071866001041,0.22676679276274062,0.23066639484416085,0.2346059928443649],"type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"title":{"text":"Standard Deviation"},"range":[0,0.25],"tickformat":".0%"},"yaxis":{"title":{"text":"Expected Return"},"range":[0,0.1],"tickformat":".0%"}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('ce4de2ff-1191-401d-be0d-ac69b210c12b');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
<p></p><figcaption class="figure-caption">Figure 4.9: Preferences and Efficient Portfolios</figcaption><p></p>
</figure>
</div>
</div>


</section>
<section class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1" role="doc-endnote"><p>If interest rates are set higher than expected returns, then the efficient portfolios may not exist.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./returns.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Asset Returns</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./fixed-income.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Fixed Income</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>